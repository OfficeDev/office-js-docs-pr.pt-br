---
title: Opções de autenticação em suplementos do Outlook
description: Os suplementos do Outlook oferecem diversos métodos de autenticação, dependendo do cenário específico.
ms.date: 04/28/2020
localization_priority: Priority
ms.openlocfilehash: 0a8c61a3e722cf1bcbfd1d9706c2dc41a7271345
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/08/2020
ms.locfileid: "44606487"
---
# <a name="authentication-options-in-outlook-add-ins"></a><span data-ttu-id="c29ae-103">Opções de autenticação em suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="c29ae-103">Authentication options in Outlook add-ins</span></span>

<span data-ttu-id="c29ae-104">O suplemento do Outlook pode acessar informações de qualquer lugar na Internet, seja do servidor que hospeda o suplemento, da sua rede interna ou de outro lugar na nuvem.</span><span class="sxs-lookup"><span data-stu-id="c29ae-104">Your Outlook add-in can access information from anywhere on the Internet, whether from the server that hosts the add-in, from your internal network, or from somewhere else in the cloud.</span></span> <span data-ttu-id="c29ae-105">Se essas informações estiverem protegidas, o suplemento precisará de uma forma de autenticar o usuário.</span><span class="sxs-lookup"><span data-stu-id="c29ae-105">If that information is protected, your add-in needs a way to authenticate your user.</span></span> <span data-ttu-id="c29ae-106">Os suplementos do Outlook oferecem diversos métodos de autenticação, dependendo do cenário específico.</span><span class="sxs-lookup"><span data-stu-id="c29ae-106">Outlook add-ins provide a number of different methods to authenticate, depending on your specific scenario.</span></span>

## <a name="single-sign-on-access-token-preview"></a><span data-ttu-id="c29ae-107">Token de acesso de logon único (visualização)</span><span class="sxs-lookup"><span data-stu-id="c29ae-107">Single sign-on access token (preview)</span></span>

<span data-ttu-id="c29ae-108">Os tokens de acesso de logon único oferecem uma maneira simples de o suplemento autenticar e obter tokens de acesso para fazer uma chamada para a [API do Microsoft Graph](/graph/overview).</span><span class="sxs-lookup"><span data-stu-id="c29ae-108">Single sign-on access tokens provide a seamless way for your add-in to authenticate and obtain access tokens to call the [Microsoft Graph API](/graph/overview).</span></span> <span data-ttu-id="c29ae-109">Esse recurso reduz conflitos porque o usuário não precisa inserir credenciais.</span><span class="sxs-lookup"><span data-stu-id="c29ae-109">This capability reduces friction since the user is not required to enter their credentials.</span></span>

> [!NOTE]
> <span data-ttu-id="c29ae-110">No momento, há suporte para a API de logon único na visualização do Word, do Excel, do Outlook e do PowerPoint, e **não** deveria ser usada em suplementos de produção. Para obter mais informações sobre o local em que a API de logon único tem suporte no momento, consulte [IdentityAPI conjuntos de requisitos](../reference/requirement-sets/identity-api-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="c29ae-110">The Single Sign-on API is currently supported in preview for Word, Excel, Outlook, and PowerPoint, and should **not** be used in production add-ins. For more information about where the Single Sign-on API is currently supported, see [IdentityAPI requirement sets](../reference/requirement-sets/identity-api-requirement-sets.md).</span></span>
>
> <span data-ttu-id="c29ae-111">Para usar o SSO, você deve carregar a versão beta da biblioteca de JavaScript do Office de https://appsforoffice.microsoft.com/lib/beta/hosted/office.js na página de inicialização HTML do suplemento.</span><span class="sxs-lookup"><span data-stu-id="c29ae-111">To use SSO, you must load the beta version of the Office JavaScript Library from https://appsforoffice.microsoft.com/lib/beta/hosted/office.js in the startup HTML page of the add-in.</span></span>
>
> <span data-ttu-id="c29ae-112">Se você estiver trabalhando com um suplemento do Outlook, certifique-se de habilitar a Autenticação Moderna para a locação do Office 365.</span><span class="sxs-lookup"><span data-stu-id="c29ae-112">If you are working with an Outlook add-in, be sure to enable Modern Authentication for the Office 365 tenancy.</span></span> <span data-ttu-id="c29ae-113">Confira mais informações sobre como fazer isso em [Exchange Online: como habilitar seu locatário para autenticação moderna](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span><span class="sxs-lookup"><span data-stu-id="c29ae-113">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>

<span data-ttu-id="c29ae-114">Considere usar tokens de acesso SSO se o suplemento:</span><span class="sxs-lookup"><span data-stu-id="c29ae-114">Consider using SSO access tokens if your add-in:</span></span>

- <span data-ttu-id="c29ae-115">For usado principalmente por usuários do Office 365</span><span class="sxs-lookup"><span data-stu-id="c29ae-115">Is used primarily by Office 365 users</span></span>
- <span data-ttu-id="c29ae-116">Precisa de acesso para:</span><span class="sxs-lookup"><span data-stu-id="c29ae-116">Needs access to:</span></span>
  - <span data-ttu-id="c29ae-117">Os serviços Microsoft que são expostos como parte do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="c29ae-117">Microsoft services that are exposed as part of Microsoft Graph</span></span>
  - <span data-ttu-id="c29ae-118">Um serviço que não seja da Microsoft que você controle</span><span class="sxs-lookup"><span data-stu-id="c29ae-118">A non-Microsoft service that you control</span></span>

<span data-ttu-id="c29ae-119">O método de autenticação SSO usa o [Fluxo Em Nome De do OAuth2 fornecido pelo Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of).</span><span class="sxs-lookup"><span data-stu-id="c29ae-119">The SSO authentication method uses the [OAuth2 On-Behalf-Of flow provided by Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of).</span></span> <span data-ttu-id="c29ae-120">Ele exige o registro do suplemento no [Portal de Registro do Aplicativo](https://apps.dev.microsoft.com/) e a especificação dos escopos necessários do Microsoft Graph no manifesto.</span><span class="sxs-lookup"><span data-stu-id="c29ae-120">It requires that the add-in register in the [Application Registration Portal](https://apps.dev.microsoft.com/) and specify any required Microsoft Graph scopes in its manifest.</span></span>

<span data-ttu-id="c29ae-121">Usando este método, o suplemento pode obter um token de acesso com escopo para a API de back-end do servidor.</span><span class="sxs-lookup"><span data-stu-id="c29ae-121">Using this method, your add-in can obtain an access token scoped to your server back-end API.</span></span> <span data-ttu-id="c29ae-122">O suplemento usa isso como um token de portador no cabeçalho `Authorization` para autenticar um retorno de chamada para sua API.</span><span class="sxs-lookup"><span data-stu-id="c29ae-122">The add-in uses this as a bearer token in the `Authorization` header to authenticate a call back to your API.</span></span> <span data-ttu-id="c29ae-123">Nesse ponto, o servidor pode:</span><span class="sxs-lookup"><span data-stu-id="c29ae-123">At that point your server can:</span></span>

- <span data-ttu-id="c29ae-124">concluir o fluxo Em Nome De para obter um token de acesso com escopo para a API do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="c29ae-124">Complete the On-Behalf-Of flow to obtain an access token scoped to the Microsoft Graph API</span></span>
- <span data-ttu-id="c29ae-125">Usar as informações de identidade no token para estabelecer a identidade do usuário e autenticar seus serviços de back-end</span><span class="sxs-lookup"><span data-stu-id="c29ae-125">Use the identity information in the token to establish the user's identity and authenticate to your own back-end services</span></span>

<span data-ttu-id="c29ae-126">Para obter uma visão geral mais detalhada, confira a [visão geral completa do método de autenticação SSO](../develop/sso-in-office-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="c29ae-126">For a more detailed overview, see the [full overview of the SSO authentication method](../develop/sso-in-office-add-ins.md).</span></span>

<span data-ttu-id="c29ae-127">Para obter detalhes sobre como usar o token SSO em um suplemento do Outlook, confira [Autenticar o usuário com um token de logon único em um suplemento do Outlook](authenticate-a-user-with-an-sso-token.md).</span><span class="sxs-lookup"><span data-stu-id="c29ae-127">For details on using the SSO token in an Outlook add-in, see [Authenticate a user with an single-sign-on token in an Outlook add-in](authenticate-a-user-with-an-sso-token.md).</span></span>

<span data-ttu-id="c29ae-128">Confira um exemplo de suplemento que usa o token SSO em [Suplemento de Exemplo AttachmentsDemo](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span><span class="sxs-lookup"><span data-stu-id="c29ae-128">For a sample add-in that uses the SSO token, see [AttachmentsDemo Sample Add-in](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span></span>

## <a name="exchange-user-identity-token"></a><span data-ttu-id="c29ae-129">Token de identidade do usuário do Exchange</span><span class="sxs-lookup"><span data-stu-id="c29ae-129">Exchange user identity token</span></span>

<span data-ttu-id="c29ae-130">Os tokens de identidade do usuário do Exchange fornecem uma maneira de o suplemento estabelecer a identidade do usuário.</span><span class="sxs-lookup"><span data-stu-id="c29ae-130">Exchange user identity tokens provide a way for your add-in to establish the identity of the user.</span></span> <span data-ttu-id="c29ae-131">Ao verificar a identidade do usuário, em seguida, você pode executar uma única autenticação no seu sistema de back-end e aceitar o token de identidade de usuário como uma autorização solicitações futuras.</span><span class="sxs-lookup"><span data-stu-id="c29ae-131">By verifying the user's identity, you can then perform a one-time authentication into your back-end system, then accept the user identity token as an authorization for future requests.</span></span> <span data-ttu-id="c29ae-132">Use o token de identidade do usuário do Exchange:</span><span class="sxs-lookup"><span data-stu-id="c29ae-132">Use the Exchange user identity token:</span></span>

- <span data-ttu-id="c29ae-133">Quando o suplemento for usado principalmente por usuários locais do Exchange.</span><span class="sxs-lookup"><span data-stu-id="c29ae-133">When the add-in is used primarily by Exchange on-premises users.</span></span>
- <span data-ttu-id="c29ae-134">Quando o suplemento precisar acessar um serviço que não seja da Microsoft que você controle.</span><span class="sxs-lookup"><span data-stu-id="c29ae-134">When the add-in needs access to a non-Microsoft service that you control.</span></span>
- <span data-ttu-id="c29ae-135">Como uma autenticação de fallback (e autorização para o Microsoft Graph) quando o suplemento estiver sendo executado em uma versão do Office que não é compatível com o SSO.</span><span class="sxs-lookup"><span data-stu-id="c29ae-135">As a fallback authentication (and authorization to Microsoft Graph) when the add-in is running on a version of Office that doesn't support SSO.</span></span>

<span data-ttu-id="c29ae-136">Seu suplemento pode chamar [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-) para obter tokens de identidade do usuário do Exchange.</span><span class="sxs-lookup"><span data-stu-id="c29ae-136">Your add-in can call [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-) to get Exchange user identity tokens.</span></span> <span data-ttu-id="c29ae-137">Para obter detalhes sobre o uso desses tokens, confira [Autenticar um usuário com um token de identidade para o Exchange](authenticate-a-user-with-an-identity-token.md).</span><span class="sxs-lookup"><span data-stu-id="c29ae-137">For details on using these tokens, see [Authenticate a user with an identity token for Exchange](authenticate-a-user-with-an-identity-token.md).</span></span>

## <a name="access-tokens-obtained-via-oauth2-flows"></a><span data-ttu-id="c29ae-138">Tokens de acesso obtidos por meio de fluxos do OAuth2</span><span class="sxs-lookup"><span data-stu-id="c29ae-138">Access tokens obtained via OAuth2 flows</span></span>

<span data-ttu-id="c29ae-139">Os suplementos também podem acessar serviços de terceiros que oferecem suporte ao OAuth2 para autorização.</span><span class="sxs-lookup"><span data-stu-id="c29ae-139">Add-ins can also access third-party services that support OAuth2 for authorization.</span></span> <span data-ttu-id="c29ae-140">Considere usar tokens OAuth2 se o suplemento:</span><span class="sxs-lookup"><span data-stu-id="c29ae-140">Consider using OAuth2 tokens if your add-in:</span></span>

- <span data-ttu-id="c29ae-141">Precisar acessar um serviço de terceiros fora do seu controle</span><span class="sxs-lookup"><span data-stu-id="c29ae-141">Needs access to a third-party service outside of your control</span></span>

<span data-ttu-id="c29ae-142">Com esse método, o suplemento solicita que o usuário entre no serviço usando o método [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) para inicializar o fluxo do OAuth2 ou usando a [biblioteca office-js-helpers](https://github.com/OfficeDev/office-js-helpers) para o fluxo do OAuth2 Implícito.</span><span class="sxs-lookup"><span data-stu-id="c29ae-142">Using this method, your add-in prompts the user to sign-in to the service either by using the [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) method to initialize the OAuth2 flow, or by using the [office-js-helpers library](https://github.com/OfficeDev/office-js-helpers) to the OAuth2 Implicit flow.</span></span>

## <a name="callback-tokens"></a><span data-ttu-id="c29ae-143">Tokens de retorno de chamada</span><span class="sxs-lookup"><span data-stu-id="c29ae-143">Callback tokens</span></span>

<span data-ttu-id="c29ae-144">Os tokens de retorno de chamada fornecem acesso à caixa de correio do usuário a partir do back-end do servidor usando o [Exchange Web Services (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange) ou a [API REST do Outlook](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api).</span><span class="sxs-lookup"><span data-stu-id="c29ae-144">Callback tokens provide access to the user's mailbox from your server back-end, either using [Exchange Web Services (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange), or the [Outlook REST API](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api).</span></span> <span data-ttu-id="c29ae-145">Considere usar tokens de retorno de chamada se o suplemento:</span><span class="sxs-lookup"><span data-stu-id="c29ae-145">Consider using callback tokens if your add-in:</span></span>

- <span data-ttu-id="c29ae-146">Precisar acessar a caixa de correio do usuário a partir do back-end do servidor.</span><span class="sxs-lookup"><span data-stu-id="c29ae-146">Needs access to the user's mailbox from your server back-end.</span></span>

<span data-ttu-id="c29ae-147">Os suplementos obtêm tokens de retorno de chamada usando um dos métodos [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span><span class="sxs-lookup"><span data-stu-id="c29ae-147">Add-ins obtain callback tokens using one of the [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) methods.</span></span> <span data-ttu-id="c29ae-148">O nível de acesso é controlado pelas permissões especificadas no manifesto do suplemento.</span><span class="sxs-lookup"><span data-stu-id="c29ae-148">The level of access is controlled by the permissions specified in the add-in manifest.</span></span>
