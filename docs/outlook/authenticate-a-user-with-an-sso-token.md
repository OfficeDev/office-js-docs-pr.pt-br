---
title: Autenticação de usuário com um token de logon único
description: Saiba como usar o token de logon único fornecido por um suplemento do Outlook para implementar o SSO com o serviço.
ms.date: 04/28/2020
localization_priority: Normal
ms.openlocfilehash: d53e75faa2d0471b43957cfa71ff6f6a50a0da4f
ms.sourcegitcommit: 7ef14753dce598a5804dad8802df7aaafe046da7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/10/2020
ms.locfileid: "45093977"
---
# <a name="authenticate-a-user-with-a-single-sign-on-token-in-an-outlook-add-in-preview"></a><span data-ttu-id="55a20-103">Autenticar um usuário com um token de logon único em um suplemento do Outlook (visualização)</span><span class="sxs-lookup"><span data-stu-id="55a20-103">Authenticate a user with a single-sign-on token in an Outlook add-in (preview)</span></span>

<span data-ttu-id="55a20-104">O SSO (logon único) oferece uma maneira simples para que o suplemento autentique usuários (e, opcionalmente, obtenha tokens de acesso para fazer uma chamada à [API do Microsoft Graph](/graph/overview)).</span><span class="sxs-lookup"><span data-stu-id="55a20-104">Single sign-on (SSO) provides a seamless way for your add-in to authenticate users (and optionally to obtain access tokens to call the [Microsoft Graph API](/graph/overview)).</span></span>

<span data-ttu-id="55a20-105">Usando este método, o suplemento pode obter um token de acesso com escopo para a API de back-end do servidor.</span><span class="sxs-lookup"><span data-stu-id="55a20-105">Using this method, your add-in can obtain an access token scoped to your server back-end API.</span></span> <span data-ttu-id="55a20-106">O suplemento usa isso como um token de portador no cabeçalho `Authorization` para autenticar um retorno de chamada para sua API.</span><span class="sxs-lookup"><span data-stu-id="55a20-106">The add-in uses this as a bearer token in the `Authorization` header to authenticate a call back to your API.</span></span> <span data-ttu-id="55a20-107">Opcionalmente, você também pode ter o código no lado do servidor:</span><span class="sxs-lookup"><span data-stu-id="55a20-107">Optionally, you can also have your server-side code:</span></span>

- <span data-ttu-id="55a20-108">concluir o fluxo Em Nome De para obter um token de acesso com escopo para a API do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="55a20-108">Complete the On-Behalf-Of flow to obtain an access token scoped to the Microsoft Graph API</span></span>
- <span data-ttu-id="55a20-109">Usar as informações de identidade no token para estabelecer a identidade do usuário e autenticar seus serviços de back-end</span><span class="sxs-lookup"><span data-stu-id="55a20-109">Use the identity information in the token to establish the user's identity and authenticate to your own back-end services</span></span>

<span data-ttu-id="55a20-110">Para obter uma visão geral do SSO em suplementos do Office, confira [Habilitar o logon único para suplementos do Office](../develop/sso-in-office-add-ins.md) e [Autorizar acesso ao Microsoft Graph em suplementos do Office](../develop/authorize-to-microsoft-graph.md).</span><span class="sxs-lookup"><span data-stu-id="55a20-110">For an overview of SSO in Office Add-ins, see [Enable single sign-on for Office Add-ins](../develop/sso-in-office-add-ins.md) and [Authorize to Microsoft Graph in your Office Add-in](../develop/authorize-to-microsoft-graph.md).</span></span>

> [!NOTE]
> <span data-ttu-id="55a20-111">Para usar o SSO, você deve carregar a versão beta da biblioteca de JavaScript do Office de https://appsforoffice.microsoft.com/lib/beta/hosted/office.js na página de inicialização HTML do suplemento.</span><span class="sxs-lookup"><span data-stu-id="55a20-111">To use SSO, you must load the beta version of the Office JavaScript Library from https://appsforoffice.microsoft.com/lib/beta/hosted/office.js in the startup HTML page of the add-in.</span></span> <span data-ttu-id="55a20-112">No entanto, você **não** deve usar APIs beta em suplementos de produção.</span><span class="sxs-lookup"><span data-stu-id="55a20-112">However, you should **not** use beta APIs in production add-ins.</span></span>

## <a name="enable-modern-authentication-in-your-microsoft-365-tenancy"></a><span data-ttu-id="55a20-113">Habilitar a autenticação moderna em seu Microsoft 365 locação</span><span class="sxs-lookup"><span data-stu-id="55a20-113">Enable modern authentication in your Microsoft 365 tenancy</span></span>

<span data-ttu-id="55a20-114">Para usar o SSO com um suplemento do Outlook, você deve habilitar a autenticação moderna para o Microsoft 365 locação.</span><span class="sxs-lookup"><span data-stu-id="55a20-114">To use SSO with an Outlook add-in, you must enable Modern Authentication for the Microsoft 365 tenancy.</span></span> <span data-ttu-id="55a20-115">Confira mais informações sobre como fazer isso em [Exchange Online: como habilitar seu locatário para autenticação moderna](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span><span class="sxs-lookup"><span data-stu-id="55a20-115">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>

## <a name="register-your-add-in"></a><span data-ttu-id="55a20-116">Registrar seu suplemento</span><span class="sxs-lookup"><span data-stu-id="55a20-116">Register your add-in</span></span>

<span data-ttu-id="55a20-117">Para usar o SSO, o suplemento do Outlook precisará ter uma API Web no lado do servidor registrada com o AAD (Azure Active Directory) v2.0.</span><span class="sxs-lookup"><span data-stu-id="55a20-117">To use SSO, your Outlook add-in will need to have a server-side web API that is registered with Azure Active Directory (AAD) v2.0.</span></span> <span data-ttu-id="55a20-118">Para mais informações, confira [Registrar um Suplemento do Office que usa SSO com o ponto de extremidade do Azure AD v2.0](../develop/register-sso-add-in-aad-v2.md).</span><span class="sxs-lookup"><span data-stu-id="55a20-118">For more information, see [Register an Office Add-in that uses SSO with the Azure AD v2.0 endpoint](../develop/register-sso-add-in-aad-v2.md).</span></span>

### <a name="provide-consent-when-sideloading-an-add-in"></a><span data-ttu-id="55a20-119">Fornecer consentimento quando estiver realizando o sideload de um suplemento</span><span class="sxs-lookup"><span data-stu-id="55a20-119">Provide consent when sideloading an add-in</span></span>

<span data-ttu-id="55a20-120">Quando um suplemento que usa SSO é adquirido na AppSource, a interface do usuário da loja trata de pedir ao usuário o consentimento para as permissões solicitadas do Graph.</span><span class="sxs-lookup"><span data-stu-id="55a20-120">When an add-in that uses SSO is acquired from AppSource, the store UI handles prompting the user for consent to the requested Graph permissions.</span></span> <span data-ttu-id="55a20-121">No entanto, ao desenvolver um suplemento, você deve fornecer o consentimento antecipadamente.</span><span class="sxs-lookup"><span data-stu-id="55a20-121">However, when you are developing an add-in, you have to provide consent in advance.</span></span> <span data-ttu-id="55a20-122">Para mais informações, confira [Conceder ao administrador consentimento para o suplemento](../develop/grant-admin-consent-to-an-add-in.md)</span><span class="sxs-lookup"><span data-stu-id="55a20-122">For more information, see [Grant administrator consent to the add-in](../develop/grant-admin-consent-to-an-add-in.md)</span></span>

## <a name="update-the-add-in-manifest"></a><span data-ttu-id="55a20-123">Atualizar o manifesto do suplemento</span><span class="sxs-lookup"><span data-stu-id="55a20-123">Update the add-in manifest</span></span>

<span data-ttu-id="55a20-124">A próxima etapa para habilitar o SSO no suplemento é adicionar um elemento `WebApplicationInfo` ao fim do elemento `VersionOverridesV1_1` [VersionOverrides](../reference/manifest/versionoverrides.md).</span><span class="sxs-lookup"><span data-stu-id="55a20-124">The next step to enable SSO in the add-in is to add a `WebApplicationInfo` element at the end of the `VersionOverridesV1_1` [VersionOverrides](../reference/manifest/versionoverrides.md) element.</span></span> <span data-ttu-id="55a20-125">Para mais informações, confira [Configurar o suplemento](../develop/sso-in-office-add-ins.md#configure-the-add-in).</span><span class="sxs-lookup"><span data-stu-id="55a20-125">For more information, see [Configure the add-in](../develop/sso-in-office-add-ins.md#configure-the-add-in).</span></span>

## <a name="get-the-sso-token"></a><span data-ttu-id="55a20-126">Obter o token SSO</span><span class="sxs-lookup"><span data-stu-id="55a20-126">Get the SSO token</span></span>

<span data-ttu-id="55a20-127">O suplemento é um token SSO com script no lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="55a20-127">The add-in gets an SSO token with client-side script.</span></span> <span data-ttu-id="55a20-128">Para saber mais, confira [Adicionar o código no lado do cliente](../develop/sso-in-office-add-ins.md#add-client-side-code).</span><span class="sxs-lookup"><span data-stu-id="55a20-128">For more information, see [Add client-side code](../develop/sso-in-office-add-ins.md#add-client-side-code).</span></span>

## <a name="use-the-sso-token-at-the-back-end"></a><span data-ttu-id="55a20-129">Usar o token SSO no back-end</span><span class="sxs-lookup"><span data-stu-id="55a20-129">Use the SSO token at the back-end</span></span>

<span data-ttu-id="55a20-130">Na maioria dos cenários, não haverá muitas razões para obter o token de acesso, se o suplemento não o passar no lado do servidor e o utilizar lá.</span><span class="sxs-lookup"><span data-stu-id="55a20-130">In most scenarios, there would be little point to obtaining the access token, if your add-in does not pass it on to a server-side and use it there.</span></span> <span data-ttu-id="55a20-131">Para obter detalhes sobre o que pode e deve ser feito no lado do servidor, confira [Adicionar código no lado do servidor](../develop/sso-in-office-add-ins.md#add-server-side-code).</span><span class="sxs-lookup"><span data-stu-id="55a20-131">For details on what your server-side could and should do, see [Add server-side code](../develop/sso-in-office-add-ins.md#add-server-side-code).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="55a20-132">Ao usar o token SSO como uma identidade em um suplemento do *Outlook*, é recomendável [usar também o token de identidade do Exchange](authenticate-a-user-with-an-identity-token.md) como uma identidade alternativa.</span><span class="sxs-lookup"><span data-stu-id="55a20-132">When using the SSO token as an identity in an *Outlook* add-in, we recommend that you also [use the Exchange identity token](authenticate-a-user-with-an-identity-token.md) as an alternate identity.</span></span> <span data-ttu-id="55a20-133">Os usuários do suplemento podem usar vários clientes, mas alguns podem não ser compatíveis com o fornecimento de tokens SSO.</span><span class="sxs-lookup"><span data-stu-id="55a20-133">Users of your add-in may use multiple clients, and some may not support providing an SSO token.</span></span> <span data-ttu-id="55a20-134">Usando o token de identidade do Exchange como uma alternativa, é possível evitar solicitações múltiplas de credenciais a esses usuários.</span><span class="sxs-lookup"><span data-stu-id="55a20-134">By using the Exchange identity token as an alternate, you can avoid having to prompt these users for credentials multiple times.</span></span> <span data-ttu-id="55a20-135">Para mais informações, confira [Cenário: implementar o logon único no serviço em um Suplemento do Outlook](implement-sso-in-outlook-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="55a20-135">For more information, see [Scenario: Implement single sign-on to your service in an Outlook add-in](implement-sso-in-outlook-add-in.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="55a20-136">Confira também</span><span class="sxs-lookup"><span data-stu-id="55a20-136">See also</span></span>

- <span data-ttu-id="55a20-137">Para obter um suplemento do Outlook de exemplo que usa o token SSO para acessar a API do Microsoft Graph, confira [Suplemento de Exemplo AttachmentsDemo](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span><span class="sxs-lookup"><span data-stu-id="55a20-137">For a sample Outlook add-in that uses the SSO token to access the Microsoft Graph API, see [AttachmentsDemo Sample Add-in](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span></span>
- [<span data-ttu-id="55a20-138">Referência da API do SSO</span><span class="sxs-lookup"><span data-stu-id="55a20-138">SSO API reference</span></span>](../develop/sso-in-office-add-ins.md#sso-api-reference)
- [<span data-ttu-id="55a20-139">Conjunto de requisitos IdentityAPI</span><span class="sxs-lookup"><span data-stu-id="55a20-139">IdentityAPI requirement set</span></span>](../reference/requirement-sets/identity-api-requirement-sets.md)
