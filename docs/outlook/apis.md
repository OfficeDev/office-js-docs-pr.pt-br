---
title: APIs de suplemento do Outlook
description: Saiba como fazer referência a APIs de suplemento do Outlook e declarar permissões em seu suplemento do Outlook.
ms.date: 02/27/2020
localization_priority: Normal
ms.openlocfilehash: d7458eebf16a3d9373e59aa0455234437f25289b
ms.sourcegitcommit: 9609bd5b4982cdaa2ea7637709a78a45835ffb19
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/28/2020
ms.locfileid: "47293993"
---
# <a name="outlook-add-in-apis"></a><span data-ttu-id="cfbcb-103">APIs de suplemento do Outlook</span><span class="sxs-lookup"><span data-stu-id="cfbcb-103">Outlook add-in APIs</span></span>

<span data-ttu-id="cfbcb-104">Para usar APIs no seu suplemento do Outlook, você deve especificar o local da biblioteca Office.js, o conjunto de requisitos, o esquema e as permissões.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-104">To use APIs in your Outlook add-in, you must specify the location of the Office.js library, the requirement set, the schema, and the permissions.</span></span> <span data-ttu-id="cfbcb-105">Você usará principalmente as APIs JavaScript do Office expostas pelo objeto [Mailbox](#mailbox-object) .</span><span class="sxs-lookup"><span data-stu-id="cfbcb-105">You'll primarily use the Office JavaScript APIs exposed through the [Mailbox](#mailbox-object) object.</span></span>

## <a name="officejs-library"></a><span data-ttu-id="cfbcb-106">Biblioteca Office.js</span><span class="sxs-lookup"><span data-stu-id="cfbcb-106">Office.js library</span></span>

<span data-ttu-id="cfbcb-107">Para interagir com a API do suplemento do Outlook, você precisará usar as APIs JavaScript no Office.js.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-107">To interact with the Outlook add-in API, you need to use the JavaScript APIs in Office.js.</span></span> <span data-ttu-id="cfbcb-108">A CDN da biblioteca é `https://appsforoffice.microsoft.com/lib/1/hosted/Office.js`.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-108">The CDN for the library is `https://appsforoffice.microsoft.com/lib/1/hosted/Office.js`.</span></span> <span data-ttu-id="cfbcb-109">Suplementos enviados ao AppSource devem fazer referência ao Office.js por essa CDN. Eles não podem usar uma referência local.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-109">Add-ins submitted to AppSource must reference Office.js by this CDN; they can't use a local reference.</span></span>

<span data-ttu-id="cfbcb-110">Referência CDN em um `<script>` marca na `<head>` marca da página da web (arquivo. HTML,. aspx ou. PHP) implementa interface do usuário do seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-110">Reference the CDN in a `<script>` tag in the `<head>` tag of the web page (.html, .aspx, or .php file) that implements the UI of your add-in.</span></span>

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```
<span data-ttu-id="cfbcb-p103">À medida que adicionamos novas APIs, a URL para Office.js permanecerá a mesma. Somente mudaremos a versão na URL se mudarmos um comportamento de API existente.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-p103">As we add new APIs, the URL to Office.js will stay the same. We will change the version in the URL only if we break an existing API behavior.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="cfbcb-113">Ao desenvolver um suplemento para qualquer aplicativo cliente do Office, faça referência à API JavaScript do Office de dentro da `<head>` seção da página.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-113">When developing an add-in for any Office client application, reference the Office JavaScript API from inside the `<head>` section of the page.</span></span> <span data-ttu-id="cfbcb-114">Isso garante que a API seja totalmente inicializada antes de qualquer elemento de corpo.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-114">This ensures that the API is fully initialized prior to any body elements.</span></span> <span data-ttu-id="cfbcb-115">Os aplicativos do Office exigem que os suplementos inicializem dentro de 5 segundos de ativação.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-115">Office applications require that add-ins initialize within 5 seconds of activation.</span></span> <span data-ttu-id="cfbcb-116">Ao ultrapassar esse limite, considera-se que o suplemento não respondeu e uma mensagem de erro é exibida para o usuário.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-116">Crossing this threshold results in the add-in being declared unresponsive and an error message is displayed to the user.</span></span>

## <a name="requirement-sets"></a><span data-ttu-id="cfbcb-117">Conjuntos de requisitos</span><span class="sxs-lookup"><span data-stu-id="cfbcb-117">Requirement sets</span></span>

<span data-ttu-id="cfbcb-118">Todas as APIs do Outlook pertencem ao conjunto de requisitos `Mailbox`.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-118">All Outlook APIs belong to the `Mailbox` requirement set.</span></span> <span data-ttu-id="cfbcb-119">O conjunto de requisitos `Mailbox` tem versões, e cada novo conjunto de APIs lançado pertence a uma versão superior.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-119">The `Mailbox` requirement set has versions, and each new set of APIs that are released belongs to a higher version of the set.</span></span> <span data-ttu-id="cfbcb-120">Nem todos os clientes do Outlook terão suporte ao conjunto mais recente de APIs quando for lançado, mas se um cliente do Outlook declarar suporte a um conjunto de requisitos, ele dará suporte a todas as APIs nesse conjunto.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-120">Not all Outlook clients will support the newest set of APIs when they are released, but if an Outlook client declares support for a requirement set, it will support all the APIs in that requirement set.</span></span>

<span data-ttu-id="cfbcb-p106">Especifique uma versão mínima de conjunto de requisitos no manifesto para controlar em quais clientes do Outlook o suplemento aparecerá. Por exemplo, se você especificar a versão 1.3 do conjunto de requisitos, o suplemento não aparecerá nos clientes do Outlook incompatíveis com a versão mínima 1.3.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-p106">To control which Outlook clients the add-in appears in, specify a minimum requirement set version in the manifest. For example, if you specify requirement set version 1.3, the add-in will not show up in any Outlook client that doesn't support a minimum version of 1.3.</span></span>

<span data-ttu-id="cfbcb-p107">A especificação de um conjunto de requisitos não limita seu suplemento às APIs nessa versão. Se o suplemento especificar a versão 1.1 do conjunto de requisitos, mas estiver sendo executado em um cliente do Outlook que dá suporte à versão 1.3, ele poderá usar as APIs v1.3. O conjunto de requisitos controla somente quais clientes do Outlook exibirão o suplemento.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-p107">Specifying a requirement set doesn't limit your add-in to the APIs in that version. If the add-in specifies requirement set v1.1 but is running in an Outlook client that supports v1.3, the add-in can still use v1.3 APIs. The requirement set only controls which Outlook clients the add-in appears in.</span></span>

<span data-ttu-id="cfbcb-126">Para verificar a disponibilidade das APIs de um conjunto de requisitos superior ao especificado no manifesto, use JavaScript padrão:</span><span class="sxs-lookup"><span data-stu-id="cfbcb-126">To check the availability of any APIs from a requirement set greater than the one specified in the manifest, you can use standard JavaScript:</span></span>

```js
if (item.somePropertyOrFunction) {
   item.somePropertyOrFunction...  
}
```

> [!NOTE]
> <span data-ttu-id="cfbcb-127">essas verificações não são necessárias para APIs que estão na versão do conjunto de requisitos especificada no manifesto.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-127">These checks are not needed for any APIs that are in the requirement set version specified in the manifest.</span></span>

<span data-ttu-id="cfbcb-128">Especifique o conjunto de requisitos mínimo que proporciona suporte ao conjunto essencial de APIs para seu cenário, sem o qual os recursos do suplemento não funcionam.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-128">Specify the minimum requirement set that supports the critical set of APIs for your scenario, without which features of your add-in won't work.</span></span> <span data-ttu-id="cfbcb-129">Especifique o conjunto de requisitos no manifesto nos elementos `<Requirements>`.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-129">You specify the requirement set in the manifest in the `<Requirements>` element.</span></span> <span data-ttu-id="cfbcb-130">Para saber mais, confira os [Manifestos de Suplementos do Outlook](manifests.md) e [Noções básicas sobre os conjuntos de requisitos de APIs do Outlook](../reference/requirement-sets/outlook-api-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="cfbcb-130">For more information, see [Outlook add-in manifests](manifests.md) and [Understanding Outlook API requirement sets](../reference/requirement-sets/outlook-api-requirement-sets.md).</span></span>

<span data-ttu-id="cfbcb-131">O elemento `<Methods>` não se aplica a suplementos do Outlook e, portanto, você não pode declarar suporte a métodos específicos.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-131">The `<Methods>` element doesn't apply to Outlook add-ins, so you can't declare support for specific methods.</span></span>

## <a name="permissions"></a><span data-ttu-id="cfbcb-132">Permissões</span><span class="sxs-lookup"><span data-stu-id="cfbcb-132">Permissions</span></span>

<span data-ttu-id="cfbcb-p109">Seu suplemento requer as permissões apropriadas para usar as APIs de que precisa. Há quatro níveis de permissões. Para obter mais detalhes, confira [Noções básicas sobre suplementos do Outlook](understanding-outlook-add-in-permissions.md).</span><span class="sxs-lookup"><span data-stu-id="cfbcb-p109">Your add-in requires the appropriate permissions to use the APIs that it needs. There are four levels of permissions. For more details, see [Understanding Outlook add-in permissions](understanding-outlook-add-in-permissions.md).</span></span>

<br/>

|<span data-ttu-id="cfbcb-136">Nível da permissão</span><span class="sxs-lookup"><span data-stu-id="cfbcb-136">Permission level</span></span>|<span data-ttu-id="cfbcb-137">Descrição</span><span class="sxs-lookup"><span data-stu-id="cfbcb-137">Description</span></span>|
|:-----|:-----|
| <span data-ttu-id="cfbcb-138">**Restrito**</span><span class="sxs-lookup"><span data-stu-id="cfbcb-138">**Restricted**</span></span> | <span data-ttu-id="cfbcb-139">Permite o uso de entidades, mas não de expressões regulares.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-139">Allows use of entities but not regular expressions.</span></span> |
| <span data-ttu-id="cfbcb-140">**Leitura de item**</span><span class="sxs-lookup"><span data-stu-id="cfbcb-140">**Read item**</span></span> | <span data-ttu-id="cfbcb-141">Além do que é permitido em **Restrito**, ele permite:</span><span class="sxs-lookup"><span data-stu-id="cfbcb-141">In addition to what is allowed in **Restricted**, it allows:</span></span><ul><li><span data-ttu-id="cfbcb-142">expressões regulares</span><span class="sxs-lookup"><span data-stu-id="cfbcb-142">regular expressions</span></span></li><li><span data-ttu-id="cfbcb-143">acesso de leitura para a API do suplemento do Outlook</span><span class="sxs-lookup"><span data-stu-id="cfbcb-143">Outlook add-in API read access</span></span></li><li><span data-ttu-id="cfbcb-144">obter as propriedades do item e o token de retorno de chamada</span><span class="sxs-lookup"><span data-stu-id="cfbcb-144">getting the item properties and the callback token</span></span></li></ul> |
| <span data-ttu-id="cfbcb-145">**Leitura/gravação**</span><span class="sxs-lookup"><span data-stu-id="cfbcb-145">**Read/write**</span></span> | <span data-ttu-id="cfbcb-146">Além do que é permitido em **Leitura do item**, ele permite:</span><span class="sxs-lookup"><span data-stu-id="cfbcb-146">In addition to what is allowed in **Read item**, it allows:</span></span><ul><li><span data-ttu-id="cfbcb-147">acesso completo à API do Suplemento do Outlook, exceto `makeEwsRequestAsync`</span><span class="sxs-lookup"><span data-stu-id="cfbcb-147">full Outlook add-in API access except `makeEwsRequestAsync`</span></span></li><li><span data-ttu-id="cfbcb-148">definição das propriedades do item</span><span class="sxs-lookup"><span data-stu-id="cfbcb-148">setting the item properties</span></span></li></ul> |
| <span data-ttu-id="cfbcb-149">**Leitura/gravação de caixa de correio**</span><span class="sxs-lookup"><span data-stu-id="cfbcb-149">**Read/write mailbox**</span></span> | <span data-ttu-id="cfbcb-150">Além do que é permitido em **Leitura/gravação**, ele permite:</span><span class="sxs-lookup"><span data-stu-id="cfbcb-150">In addition to what is allowed in **Read/write**, it allows:</span></span><ul><li><span data-ttu-id="cfbcb-151">criar, ler, gravar itens e pastas</span><span class="sxs-lookup"><span data-stu-id="cfbcb-151">creating, reading, writing items and folders</span></span></li><li><span data-ttu-id="cfbcb-152">enviar itens</span><span class="sxs-lookup"><span data-stu-id="cfbcb-152">sending items</span></span></li><li><span data-ttu-id="cfbcb-153">chamar [makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)</span><span class="sxs-lookup"><span data-stu-id="cfbcb-153">calling [makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)</span></span></li></ul> |

<span data-ttu-id="cfbcb-154">Em geral, você deve especificar a permissão mínima necessária para o seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-154">In general, you should specify the minimum permission needed for your add-in.</span></span> <span data-ttu-id="cfbcb-155">As permissões são declaradas no elemento `<Permissions>` no manifesto.</span><span class="sxs-lookup"><span data-stu-id="cfbcb-155">Permissions are declared in the `<Permissions>` element in the manifest.</span></span> <span data-ttu-id="cfbcb-156">Para saber mais, confira [Manifestos de suplementos do Outlook](manifests.md).</span><span class="sxs-lookup"><span data-stu-id="cfbcb-156">For more information, see [Outlook add-in manifests](manifests.md).</span></span> <span data-ttu-id="cfbcb-157">Para saber mais sobre problemas de segurança, confira [privacidade e segurança para suplementos do Office](../concepts/privacy-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="cfbcb-157">For information about security issues, see [Privacy and security for Office Add-ins](../concepts/privacy-and-security.md).</span></span>

## <a name="mailbox-object"></a><span data-ttu-id="cfbcb-158">Objeto Mailbox</span><span class="sxs-lookup"><span data-stu-id="cfbcb-158">Mailbox object</span></span>

[!include[information about Mailbox object](../includes/mailbox-object-desc.md)]

## <a name="see-also"></a><span data-ttu-id="cfbcb-159">Confira também</span><span class="sxs-lookup"><span data-stu-id="cfbcb-159">See also</span></span>

- [<span data-ttu-id="cfbcb-160">Manifestos de suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="cfbcb-160">Outlook add-in manifests</span></span>](manifests.md)
- [<span data-ttu-id="cfbcb-161">Noções básicas sobre conjuntos de requisitos da API do Outlook</span><span class="sxs-lookup"><span data-stu-id="cfbcb-161">Understanding Outlook API requirement sets</span></span>](../reference/requirement-sets/outlook-api-requirement-sets.md)
- [<span data-ttu-id="cfbcb-162">Privacidade e segurança para Suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="cfbcb-162">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
