---
title: Dicas para lidar com valores de data em Suplementos do Outlook
description: A API JavaScript para Office usa o objeto JavaScript Date para a maioria dos processos de armazenamento e recuperação de datas e horas.
ms.date: 10/31/2019
localization_priority: Normal
ms.openlocfilehash: 5718839ebda433df6fb14886da34d734f81eb5f2
ms.sourcegitcommit: a3ddfdb8a95477850148c4177e20e56a8673517c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/20/2020
ms.locfileid: "42165695"
---
# <a name="tips-for-handling-date-values-in-outlook-add-ins"></a><span data-ttu-id="c3fd2-103">Dicas para lidar com valores de data em suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="c3fd2-103">Tips for handling date values in Outlook add-ins</span></span>

<span data-ttu-id="c3fd2-104">A API JavaScript para Office usa o objeto JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) para a maioria dos processos de armazenamento e recuperação de datas e horas.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-104">The JavaScript API for Office uses the JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) object for most of the storage and retrieval of dates and times.</span></span> 

<span data-ttu-id="c3fd2-105">Esse objeto **Date** fornece métodos como [getUTCDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getUTCHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getUTCMinutes](https://www.w3schools.com/jsref/jsref_getutcminutes.asp) e [toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp), que retornam o valor de data ou hora selecionado de acordo com o UTC (Tempo Universal Coordenado).</span><span class="sxs-lookup"><span data-stu-id="c3fd2-105">That **Date** object provides methods such as [getUTCDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getUTCHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getUTCMinutes](https://www.w3schools.com/jsref/jsref_getutcminutes.asp), and [toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp), which return the requested date or time value according to Universal Coordinated Time (UTC) time.</span></span>

<span data-ttu-id="c3fd2-106">O objeto **Date** também fornece outros métodos como [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp) e [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp), que retornam a data ou a hora solicitada de acordo com a "hora local".</span><span class="sxs-lookup"><span data-stu-id="c3fd2-106">The **Date** object also provides other methods such as [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp), and [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp), which return the requested date or time according to "local time".</span></span>

<span data-ttu-id="c3fd2-p101">O conceito de "hora local" é basicamente determinado pelo navegador e pelo sistema operacional no computador cliente. Por exemplo, na maioria dos navegadores em execução em um computador cliente baseado no Windows, uma chamada JavaScript para **getDate** retorna uma data com base no fuso horário definido no Windows do computador cliente.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-p101">The concept of "local time" is largely determined by the browser and operating system on the client computer. For instance, on most browsers running on a Windows-based client computer, a JavaScript call to **getDate**, returns a date based on the time zone set in Windows on the client computer.</span></span>

<span data-ttu-id="c3fd2-109">O exemplo a seguir cria um objeto **Date** `myLocalDate` na hora local e chama **toUTCString** para converter essa data em uma cadeia de caracteres de data em UTC.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-109">The following example creates a **Date** object `myLocalDate` in local time, and calls **toUTCString** to convert that date to a date string in UTC.</span></span>

```js
// Create and get the current date represented 
// in the client computer time zone.
var myLocalDate = new Date (); 

// Convert the Date value in the client computer time zone
// to a date string in UTC, and display the string.
document.write ("The current UTC time is " + 
    myLocalDate.toUTCString());
```

<span data-ttu-id="c3fd2-110">Embora você possa usar o objeto JavaScript **Date** para obter um valor de data ou hora baseado em UTC ou no fuso horário do computador cliente, o objeto **Date** é limitado em um aspecto: ele não oferece métodos para retornar um valor de data ou hora para qualquer outro fuso horário específico.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-110">While you can use the JavaScript **Date** object to get a date or time value based on UTC or the client computer time zone, the **Date** object is limited in one respect - it does not provide methods to return a date or time value for any other specific time zone.</span></span> <span data-ttu-id="c3fd2-111">Por exemplo, se seu computador cliente estiver definido para EST (hora oficial do leste dos EUA), não existe método **Date** que permita que você obtenha o valor de hora diferente de EST ou UTC, como PST (hora oficial do Pacífico).</span><span class="sxs-lookup"><span data-stu-id="c3fd2-111">For example, if your client computer is set to be on Eastern Standard Time (EST), there is no **Date** method that allows you to get the hour value other than in EST or UTC, such as Pacific Standard Time (PST).</span></span>


## <a name="date-related-features-for-outlook-add-ins"></a><span data-ttu-id="c3fd2-112">Recursos relacionados a data para suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="c3fd2-112">Date-related features for Outlook add-ins</span></span>

<span data-ttu-id="c3fd2-113">A limitação JavaScript mencionada tem uma implicação para você, quando você usa a API JavaScript para Office para lidar com valores de data ou hora em suplementos do Outlook que são executados em um cliente avançado do Outlook e no Outlook na Web ou em dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-113">The aforementioned JavaScript limitation has an implication for you, when you use the JavaScript API for Office to handle date or time values in Outlook add-ins that run in an Outlook rich client, and in Outlook on the web or mobile devices.</span></span>


### <a name="time-zones-for-outlook-clients"></a><span data-ttu-id="c3fd2-114">Fusos horários para clientes do Outlook</span><span class="sxs-lookup"><span data-stu-id="c3fd2-114">Time zones for Outlook clients</span></span>

<span data-ttu-id="c3fd2-115">Para maior clareza, vamos definir os fusos horários em questão.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-115">For clarity, let's define the time zones in question.</span></span>

|<span data-ttu-id="c3fd2-116">**Fuso horário**</span><span class="sxs-lookup"><span data-stu-id="c3fd2-116">**Time zone**</span></span>|<span data-ttu-id="c3fd2-117">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="c3fd2-117">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="c3fd2-118">Fuso horário do computador cliente</span><span class="sxs-lookup"><span data-stu-id="c3fd2-118">Client computer time zone</span></span>|<span data-ttu-id="c3fd2-119">Isso é definido no sistema operacional do computador cliente.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-119">This is set on the operating system of the client computer.</span></span> <span data-ttu-id="c3fd2-120">A maioria dos navegadores usa o fuso horário do computador cliente para exibir os valores de data ou hora do objeto JavaScript **Date**.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-120">Most browsers use the client computer time zone to display date or time values of the JavaScript **Date** object.</span></span><br/><br/><span data-ttu-id="c3fd2-121">Um cliente avançado do Outlook usa esse fuso horário para exibir os valores de data ou hora na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-121">An Outlook rich client uses this time zone to display date or time values in the user interface.</span></span> <br/><br/><span data-ttu-id="c3fd2-122">Por exemplo, em um computador cliente executando o Windows, o Outlook usa o fuso horário definido no Windows como o fuso horário local.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-122">For example, on a client computer running Windows, Outlook uses the time zone set on Windows as the local time zone.</span></span> <span data-ttu-id="c3fd2-123">No Mac, se o usuário alterar o fuso horário no computador cliente, o Outlook no Mac solicitará que o usuário atualize o fuso horário no Outlook também.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-123">On the Mac, if the user changes the time zone on the client computer, Outlook on Mac would prompt the user to update the time zone in Outlook as well.</span></span>|
|<span data-ttu-id="c3fd2-124">Fuso horário do EAC (Centro de Administração do Exchange)</span><span class="sxs-lookup"><span data-stu-id="c3fd2-124">Exchange Admin Center (EAC) time zone</span></span>|<span data-ttu-id="c3fd2-125">O usuário define esse valor de fuso horário (e o idioma preferido) quando faz logon no Outlook na Web ou em dispositivos móveis pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-125">The user sets this time zone value (and the preferred language) when he or she logs on to Outlook on the web or mobile devices the first time.</span></span> <br/><br/><span data-ttu-id="c3fd2-126">O Outlook na Web e dispositivos móveis usam esse fuso horário para exibir valores de data ou hora na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-126">Outlook on the web and mobile devices use this time zone to display date or time values in the user interface.</span></span>|

<span data-ttu-id="c3fd2-127">Como um cliente avançado do Outlook usa o fuso horário do computador cliente e a interface do usuário do Outlook na Web e dispositivos móveis usa o fuso horário do Eat, a hora local para o mesmo suplemento instalada para a mesma caixa de correio pode ser diferente ao executar em um clie avançado do Outlook NT e no Outlook na Web ou dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-127">Because an Outlook rich client uses the client computer time zone, and the user interface of Outlook on the web and mobile devices uses the EAC time zone, the local time for the same add-in installed for the same mailbox can be different when running in an Outlook rich client and in Outlook on the web or mobile devices.</span></span> <span data-ttu-id="c3fd2-128">Como desenvolvedor de suplementos do Outlook, você deve fornecer valores de data de entrada e saída de forma que sejam sempre consistentes com o fuso horário que o usuário espera no cliente correspondente.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-128">As an Outlook add-in developer, you should appropriately input and output date values so that those values are always consistent with the time zone that the user expects on the corresponding client.</span></span>


### <a name="date-related-api"></a><span data-ttu-id="c3fd2-129">API relacionada à data</span><span class="sxs-lookup"><span data-stu-id="c3fd2-129">Date-related API</span></span>

<span data-ttu-id="c3fd2-130">A seguir estão as propriedades e métodos da API JavaScript para Office que dão suporte a recursos relacionados a datas.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-130">The following are the properties and methods in the JavaScript API for Office that support date-related features.</span></span>

<span data-ttu-id="c3fd2-131">**Membro da API**</span><span class="sxs-lookup"><span data-stu-id="c3fd2-131">**API member**</span></span>|<span data-ttu-id="c3fd2-132">**Representação de fuso horário**</span><span class="sxs-lookup"><span data-stu-id="c3fd2-132">**Time zone representation**</span></span>|<span data-ttu-id="c3fd2-133">**Exemplo em um cliente avançado do Outlook**</span><span class="sxs-lookup"><span data-stu-id="c3fd2-133">**Example in an Outlook rich client**</span></span>|<span data-ttu-id="c3fd2-134">**Exemplo no Outlook na Web ou em dispositivos móveis**</span><span class="sxs-lookup"><span data-stu-id="c3fd2-134">**Example in Outlook on the web or mobile devices**</span></span>
--------------|----------------------------|-------------------------------------|-------------------
[<span data-ttu-id="c3fd2-135">Office.context.mailbox.userProfile.timeZone</span><span class="sxs-lookup"><span data-stu-id="c3fd2-135">Office.context.mailbox.userProfile.timeZone</span></span>](/javascript/api/outlook/office.userprofile?view=outlook-js-preview#timezone)|<span data-ttu-id="c3fd2-136">Em um cliente avançado do Outlook, essa propriedade retorna o fuso horário do computador cliente.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-136">In an Outlook rich client, this property returns the client computer time zone.</span></span> <span data-ttu-id="c3fd2-137">No Outlook na Web e dispositivos móveis, essa propriedade retorna o fuso horário da Eat.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-137">In Outlook on the web and mobile devices, this property returns the EAC time zone.</span></span> |<span data-ttu-id="c3fd2-138">EST</span><span class="sxs-lookup"><span data-stu-id="c3fd2-138">EST</span></span>|<span data-ttu-id="c3fd2-139">PST</span><span class="sxs-lookup"><span data-stu-id="c3fd2-139">PST</span></span>
<span data-ttu-id="c3fd2-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) e [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span><span class="sxs-lookup"><span data-stu-id="c3fd2-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) and [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span></span>|<span data-ttu-id="c3fd2-141">Cada uma dessas propriedades retorna um objeto JavaScript **Date**.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-141">Each of these properties returns a JavaScript **Date** object.</span></span> <span data-ttu-id="c3fd2-142">Esse valor de **Data** está correto, conforme mostrado no exemplo a seguir: `myUTCDate` tem o mesmo valor em um cliente avançado do Outlook, Outlook na Web e dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-142">This **Date** value is UTC-correct, as shown in the following example - `myUTCDate` has the same value in an Outlook rich client, Outlook on the web and mobile devices.</span></span><br/><br/>`var myDate = Office.mailbox.item.dateTimeCreated;`<br/>`var myUTCDate = myDate.getUTCDate;`<br/><br/><span data-ttu-id="c3fd2-143">No entanto `myDate.getDate` , chamar retorna um valor de data no fuso horário do computador cliente, que é consistente com o fuso horário usado para exibir os valores de data e hora na interface de cliente avançado do Outlook, mas pode ser diferente do fuso horário da Eat que o Outlook na Web e dispositivos móveis usam em sua interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-143">However, calling  `myDate.getDate` returns a date value in the client computer time zone, which is consistent with the time zone used to display date times values in the Outlook rich client interface, but may be different from the EAC time zone that Outlook on the web and mobile devices use in its user interface.</span></span>|<span data-ttu-id="c3fd2-144">Se o item é criado às 9h UTC:</span><span class="sxs-lookup"><span data-stu-id="c3fd2-144">If the item is created at 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="c3fd2-145">`dateTimeCreated.getHours` é retornado às 4h EST.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-145">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="c3fd2-146">Se o item for modificado às 11h UTC:</span><span class="sxs-lookup"><span data-stu-id="c3fd2-146">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="c3fd2-147">`dateTimeModified.getHours` é retornado às 6h EST.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-147">`dateTimeModified.getHours` returns 6am EST.</span></span>|<span data-ttu-id="c3fd2-148">Se a hora de criação do item for às 9h UTC:</span><span class="sxs-lookup"><span data-stu-id="c3fd2-148">If the item creation time is 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="c3fd2-149">`dateTimeCreated.getHours` é retornado às 4h EST.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-149">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="c3fd2-150">Se o item for modificado às 11h UTC:</span><span class="sxs-lookup"><span data-stu-id="c3fd2-150">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="c3fd2-151">`dateTimeModified.getHours` é retornado às 6h EST.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-151">`dateTimeModified.getHours` returns 6am EST.</span></span><br/><br/><span data-ttu-id="c3fd2-152">Observe que se você quer exibir a hora de criação ou de alteração na interface do usuário, convém primeiro converter a hora em PST para ficar consistente com o resto da interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-152">Notice that if you want to display the creation or modification time in the user interface, you would want to first convert the time to PST to be consistent with the rest of the user interface.</span></span>
[<span data-ttu-id="c3fd2-153">Office.context.mailbox.displayNewAppointmentForm</span><span class="sxs-lookup"><span data-stu-id="c3fd2-153">Office.context.mailbox.displayNewAppointmentForm</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|<span data-ttu-id="c3fd2-154">Cada um dos parâmetros _Start_ e _End_ requer um objeto JavaScript **Date**.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-154">Each of the  _Start_ and _End_ parameters requires a JavaScript **Date** object.</span></span> <span data-ttu-id="c3fd2-155">Os argumentos devem ser corrigidos por UTC, independentemente do fuso horário usado na interface do usuário de um cliente avançado do Outlook ou do Outlook na Web ou dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-155">The arguments should be UTC-correct regardless of the time zone used in the user interface of an Outlook rich client, or Outlook on the web or mobile devices.</span></span>|<span data-ttu-id="c3fd2-156">Se as horas de início e de término para o formulário de compromisso são 9h UTC e 11h UTC, você deve fazer com que os argumentos `start` e `end` estejam corretos em relação à UTC, o que significa que :</span><span class="sxs-lookup"><span data-stu-id="c3fd2-156">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="c3fd2-157">`start.getUTCHours` é retornado às 9h UTC</span><span class="sxs-lookup"><span data-stu-id="c3fd2-157">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="c3fd2-158">`end.getUTCHours` é retornado às 11h UTC</span><span class="sxs-lookup"><span data-stu-id="c3fd2-158">`end.getUTCHours` returns 11am UTC</span></span></li></ul>|<span data-ttu-id="c3fd2-159">Se as horas de início e de término para o formulário de compromisso são 9h UTC e 11h UTC, você deve fazer com que os argumentos `start` e `end` estejam corretos em relação à UTC, o que significa que :</span><span class="sxs-lookup"><span data-stu-id="c3fd2-159">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="c3fd2-160">`start.getUTCHours` é retornado às 9h UTC</span><span class="sxs-lookup"><span data-stu-id="c3fd2-160">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="c3fd2-161">`end.getUTCHours` é retornado às 11h UTC</span><span class="sxs-lookup"><span data-stu-id="c3fd2-161">`end.getUTCHours` returns 11am UTC</span></span></li></ul>

## <a name="helper-methods-for-date-related-scenarios"></a><span data-ttu-id="c3fd2-162">Métodos auxiliares para cenários de data</span><span class="sxs-lookup"><span data-stu-id="c3fd2-162">Helper methods for date-related scenarios</span></span>


<span data-ttu-id="c3fd2-163">Conforme descrito nas seções anteriores, como a "hora local" para um usuário no Outlook na Web ou dispositivos móveis pode ser diferente em um cliente avançado do Outlook, mas o objeto de **Data** JavaScript oferece suporte à conversão somente no fuso horário do computador cliente ou UTC, a API JavaScript para Office fornece dois métodos auxiliares: [Office. Context. Mailbox. convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) e [Office. Context. Mailbox. convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span><span class="sxs-lookup"><span data-stu-id="c3fd2-163">As described in the preceding sections, because the "local time" for a user in Outlook on the web or mobile devices can be different on an Outlook rich client, but the JavaScript **Date** object supports converting to only the client computer time zone or UTC, the JavaScript API for Office provides two helper methods: [Office.context.mailbox.convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) and [Office.context.mailbox.convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span></span>

<span data-ttu-id="c3fd2-164">Esses métodos auxiliares cuidam de qualquer necessidade de lidar com a data ou a hora de forma diferente para os dois cenários relacionados a datas a seguir, em um cliente avançado do Outlook, no Outlook na Web e em dispositivos móveis, reforçando "somente uma vez" para clientes diferentes do seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-164">These helper methods take care of any need to handle date or time differently for the following two date-related scenarios, in an Outlook rich client, Outlook on the web and mobile devices, thus reinforcing "write-once" for different clients of your add-in.</span></span>


### <a name="scenario-a-displaying-item-creation-or-modified-time"></a><span data-ttu-id="c3fd2-165">Cenário A: exibir a criação de item ou a hora da alteração</span><span class="sxs-lookup"><span data-stu-id="c3fd2-165">Scenario A: Displaying item creation or modified time</span></span>

<span data-ttu-id="c3fd2-166">Se você estiver exibindo a hora de criação do item (**Item.dateTimeCreated**) ou a hora da modificação (**Item.dateTimeModified**) na interface do usuário, primeiro use **convertToLocalClientTime** para converter o objeto **Date** fornecido por essas propriedades a fim de obter uma representação de dicionário no horário local apropriado.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-166">If you are displaying the item creation time (**Item.dateTimeCreated**) or modification time (**Item.dateTimeModified**) in the user interface, first use **convertToLocalClientTime** to convert the **Date** object provided by these properties to obtain a dictionary representation in the appropriate local time.</span></span> <span data-ttu-id="c3fd2-167">Em seguida, exiba as partes da data do dicionário.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-167">Then display the parts of the dictionary date.</span></span> <span data-ttu-id="c3fd2-168">A seguir, um exemplo desse cenário:</span><span class="sxs-lookup"><span data-stu-id="c3fd2-168">The following is an example of this scenario:</span></span>


```js
// This date is UTC-correct.
var myDate = Office.context.mailbox.item.dateTimeCreated;

// Call helper method to get date in dictionary format, 
// represented in the appropriate local time.
// In an Outlook rich client, this is dictionary format 
// in client computer time zone.
// In Outlook on the web or mobile devices, this dictionary 
// format is in EAC time zone.
var myLocalDictionaryDate = Office.context.mailbox.convertToLocalClientTime(myDate);

// Display different parts of the dictionary date.
document.write ("The item was created at " + myLocalDictionaryDate["hours"] + 
    ":" + myLocalDictionaryDate["minutes"]);)
```

<span data-ttu-id="c3fd2-169">Observe que **convertToLocalClientTime** se encarrega da diferença entre um cliente avançado do Outlook e o Outlook na Web ou dispositivos móveis:</span><span class="sxs-lookup"><span data-stu-id="c3fd2-169">Note that **convertToLocalClientTime** takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="c3fd2-170">Se **convertToLocalClientTime** detecta que o host atual é um cliente avançado, o método converte a representação **Date** em uma representação de dicionário no mesmo fuso horário do computador cliente, consistente com o resto da interface do usuário do cliente avançado.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-170">If **convertToLocalClientTime** detects the current host is a rich client, the method converts the **Date** representation to a dictionary representation in the same client computer time zone, consistent with the rest of the rich client user interface.</span></span>
    
- <span data-ttu-id="c3fd2-171">Se o **convertToLocalClientTime** detectar que o host atual é o Outlook na Web ou dispositivos móveis, o método converterá a representação de **Data** correta para UTC em um formato de dicionário no fuso horário da Eat, consistente com o restante da interface de usuário do Outlook na Web ou dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-171">If **convertToLocalClientTime** detects the current host is Outlook on the web or mobile devices, the method converts the UTC-correct **Date** representation to a dictionary format in the EAC time zone, consistent with the rest of the Outlook on the web or mobile devices user interface.</span></span>
    

### <a name="scenario-b-displaying-start-and-end-dates-in-a-new-appointment-form"></a><span data-ttu-id="c3fd2-172">Cenário B: exibir datas de início e de término em um formulário de novo compromisso</span><span class="sxs-lookup"><span data-stu-id="c3fd2-172">Scenario B: Displaying start and end dates in a new appointment form</span></span>

<span data-ttu-id="c3fd2-173">Se você está obtendo como entrada diferentes partes de um valor de data e hora representadas na hora local e quer fornecer esse valor de entrada de dicionário como uma hora de início ou de término em um formulário de compromisso, primeiro use o método auxiliar **convertToUtcClientTime** para converter o valor do dicionário em um objeto **Date** com correção para UTC.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-173">If you are obtaining as input different parts of a date-time value represented in the local time, and would like to provide this dictionary input value as a start or end time in an appointment form, first use the **convertToUtcClientTime** helper method to convert the dictionary value to a UTC-correct **Date** object.</span></span>

<span data-ttu-id="c3fd2-p110">No exemplo a seguir, supinha que `myLocalDictionaryStartDate` e `myLocalDictionaryEndDate` são valores de data e hora em formato de dicionário que você obteve do usuário. Esses valores se baseiam no horário local, dependendo do aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-p110">In the following example, assume  `myLocalDictionaryStartDate` and `myLocalDictionaryEndDate` are date-time values in dictionary format that you have obtained from the user. These values are based on the local time, dependent on the host application.</span></span>

```js
var myUTCCorrectStartDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryStartDate);
var myUTCCorrectEndDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryEndDate);

```

<span data-ttu-id="c3fd2-176">Os valores resultantes, `myUTCCorrectStartDate` e `myUTCCorrectEndDate`, são corrigidos para UTC.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-176">The resultant values,  `myUTCCorrectStartDate` and `myUTCCorrectEndDate`, are UTC-correct.</span></span> <span data-ttu-id="c3fd2-177">Passe esses objetos **Date** como argumentos para os parâmetros _Start_ e _End_ do método **Mailbox.displayNewAppointmentForm** para exibir o formulário do novo compromisso.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-177">Then pass these **Date** objects as arguments for the _Start_ and _End_ parameters of the **Mailbox.displayNewAppointmentForm** method to display the new appointment form.</span></span>

<span data-ttu-id="c3fd2-178">Observe que **convertToUtcClientTime** se encarrega da diferença entre um cliente avançado do Outlook e o Outlook na Web ou dispositivos móveis:</span><span class="sxs-lookup"><span data-stu-id="c3fd2-178">Note that **convertToUtcClientTime** takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="c3fd2-179">Se **convertToUtcClientTime** detecta que o host atual é um cliente avançado do Outlook, o método simplesmente converte a representação de dicionário em um objeto **Date**.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-179">If **convertToUtcClientTime** detects the current host is an Outlook rich client, the method simply converts the dictionary representation to a **Date** object.</span></span> <span data-ttu-id="c3fd2-180">Esse objeto **Date** é corrigido para UTC, conforme o esperado por **displayNewAppointmentForm**.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-180">This **Date** object is UTC-correct, as expected by **displayNewAppointmentForm**.</span></span>
    
- <span data-ttu-id="c3fd2-181">Se o **convertToUtcClientTime** detectar que o host atual é o Outlook na Web ou dispositivos móveis, o método converte o formato de dicionário dos valores de data e hora expressos no fuso horário da Eat em um objeto **Date** .</span><span class="sxs-lookup"><span data-stu-id="c3fd2-181">If **convertToUtcClientTime** detects the current host is Outlook on the web or mobile devices, the method converts the dictionary format of the date and time values expressed in the EAC time zone to a **Date** object.</span></span> <span data-ttu-id="c3fd2-182">Esse objeto **Date** é corrigido para UTC, conforme o esperado por **displayNewAppointmentForm**.</span><span class="sxs-lookup"><span data-stu-id="c3fd2-182">This **Date** object is UTC-correct, as expected by **displayNewAppointmentForm**.</span></span>
    

## <a name="see-also"></a><span data-ttu-id="c3fd2-183">Confira também</span><span class="sxs-lookup"><span data-stu-id="c3fd2-183">See also</span></span>

- [<span data-ttu-id="c3fd2-184">Implantar e instalar suplementos do Outlook para teste</span><span class="sxs-lookup"><span data-stu-id="c3fd2-184">Deploy and install Outlook add-ins for testing</span></span>](testing-and-tips.md)
    


