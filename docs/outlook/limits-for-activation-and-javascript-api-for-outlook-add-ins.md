---
title: Limites para ativação e uso da API em suplementos do Outlook
description: Você deve estar ciente das determinadas diretrizes de ativação e de uso da API e implementar seus suplementos dentro desses limites.
ms.date: 08/30/2022
ms.localizationpriority: medium
ms.openlocfilehash: b09886e49b0d980dbbf2465df7d077cd16a04f4d
ms.sourcegitcommit: 889d23061a9413deebf9092d675655f13704c727
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/07/2022
ms.locfileid: "67616011"
---
# <a name="limits-for-activation-and-javascript-api-for-outlook-add-ins"></a>Limites para ativação e API JavaScript para suplementos do Outlook

A fim de fornecer uma experiência satisfatória para os usuários dos suplementos do Outlook, você deve estar ciente das determinadas diretrizes de ativação e de uso da API e implementar seus suplementos dentro desses limites Essas diretrizes existem para que um suplemento individual não possa exigir do Exchange Server ou do Outlook que gastem um tempo excessivamente longo processando suas regras de ativação ou chamadas à API JavaScript para Office, afetando a experiência do usuário geral no Outlook e outros suplementos. Essas diretrizes existem para que um suplemento individual não possa exigir que o Exchange Server ou o Outlook gaste um período de tempo muito longo para processar suas regras de ativação ou chamadas para a API JavaScript do Office, afetando a experiência geral do usuário para o Outlook e outros suplementos. Esses limites se aplicam à criação de regras de ativação no manifesto do suplemento e ao uso de propriedades personalizadas, configurações de roaming, destinatários, solicitações e respostas dos Serviços Web do Exchange (EWS) e chamadas assíncronas.

> [!NOTE]
> Se o suplemento for executado em um cliente avançado do Outlook, você também deverá verificar se o suplemento é executado dentro de determinados limites de uso de recursos de runtime.

## <a name="limits-on-where-add-ins-activate"></a>Limites em que os suplementos são ativados

Para saber mais sobre onde os suplementos fazem e não são ativados, consulte os itens de Caixa de Correio disponíveis para [a seção suplementos](outlook-add-ins-overview.md#mailbox-items-available-to-add-ins) da página de visão geral dos suplementos do Outlook.

## <a name="limits-for-activation-rules"></a>Limites para regras de ativação

Siga estas diretrizes ao criar regras de ativação para suplementos do Outlook:

- Limite o tamanho do manifesto a 256 KB. Você não poderá instalar o suplemento do Outlook para uma caixa de correio do Exchange se exceder esse limite.

- Especifique até 15 regras de ativação para o suplemento. Você não poderá instalar o suplemento se exceder esse limite.

- Se você usar uma regra [ItemHasKnownEntity](/javascript/api/manifest/rule#itemhasknownentity-rule) no corpo do item selecionado, assuma que um cliente avançado do Outlook aplicará a regra somente ao primeiro MB do corpo e não ao restante do corpo acima desse limite. Seu suplemento não será ativado se existirem correspondentes somente após o primeiro MB do corpo. Se você acha que esse é um cenário provável, recrie suas condições para ativação.

- Se você usar expressões regulares em regras [ItemHasRegularExpressionMatch](/javascript/api/manifest/rule#itemhasregularexpressionmatch-rule), esteja ciente dos seguintes limites e diretrizes que geralmente se aplicam a qualquer aplicativo do Outlook e aqueles descritos nas tabelas `ItemHasKnownEntity` 1, 2 e 3 que diferem dependendo do aplicativo.
  - Especifique até cinco expressões regulares em regras de ativação em um suplemento. Você não poderá instalar um suplemento se exceder esse limite.
  - Especifique expressões regulares de modo que os resultados que você prevê sejam retornados pela chamada `getRegExMatches` de método dentro das primeiras 50 correspondências.
  - **Importante**: o texto é realçado com base em cadeias de caracteres resultantes da correspondência da expressão regular. No entanto, as ocorrências realçadas podem não corresponder exatamente ao que deve ser resultado de asserções de expressão regular reais, como look-ahead `(?!text)`negativo, look-behind `(?<=text)`e look-behind negativo `(?<!text)`. Por exemplo, se você usar a expressão regular `under(?!score)` em "Like under, under score, and underscore", a cadeia de caracteres "under" será realçada para todas as ocorrências em vez de apenas as duas primeiras.

A Tabela 1 lista os limites e descreve as diferenças no suporte para expressões regulares entre um cliente avançado do Outlook e Outlook na Web ou dispositivos móveis. O suporte independe de qualquer tipo específico de dispositivo e de corpo de item.

**Tabela 1. Diferenças gerais no suporte para expressões regulares**

|Cliente avançado do Outlook|Outlook na Web ou em dispositivos móveis|
|:-----|:-----|
|Usa o mecanismo de expressões regulares C++ fornecido como parte da biblioteca de modelo padrão do Visual Studio. Esse mecanismo é compatível com as normas ECMAScript 5. |Usa a avaliação da expressão regular que faz parte do JavaScript, é fornecida pelo navegador e dá suporte a um subconjunto dos ECMAScript 5.|
|Devido aos diferentes mecanismos regex, espere que um regex que inclua uma classe de caractere personalizada com base em classes de caractere predefinida retorne resultados diferentes em um cliente avançado do Outlook do que em dispositivos Outlook na Web ou móveis.<br/><br/>Por exemplo, o regex `[\s\S]{0,100}` corresponde a qualquer número, entre 0 e 100, de caracteres individuais que seja um espaço em branco ou um espaço não branco. Esse regex retorna resultados diferentes em um cliente avançado do Outlook do que Outlook na Web dispositivos móveis.<br/><br/>Você deve reescrever o regex como `(\s\|\S){0,100}` uma solução alternativa. Essa solução alternativa regex corresponde a qualquer número, entre 0 e 100, de espaço em branco ou não espaço em branco.<br/><br/>Você deve testar cada regex completamente em cada cliente do Outlook e, se um regex retornar resultados diferentes, reescreva o regex. |Você deve testar cada regex completamente em cada cliente do Outlook e, se um regex retornar resultados diferentes, reescreva o regex.|
|Por padrão, limita a avaliação de todas as expressões regulares de um suplemento para um segundo. Ultrapassar esse limite pode causar a reavaliação por até três vezes. Além do limite de reavaliação, um cliente avançado do Outlook desabilita a execução do suplemento para a mesma caixa de correio em qualquer um dos clientes do Outlook.<br/><br/>Os administradores podem substituir esses limites de avaliação usando as chaves `OutlookActivationAlertThreshold` `OutlookActivationManagerRetryLimit` e do Registro.|Não há suporte para o mesmo monitoramento de recursos ou configurações de registro que em um cliente avançado do Outlook. No entanto, suplementos com expressões regulares que exigem tempo excessivo de avaliação em um cliente avançado do Outlook são desabilitados para a mesma caixa de correio em todos os clientes do Outlook.|

A Tabela 2 lista os limites e descreve as diferenças na parte do corpo do item a que cada Outlook aplica uma expressão regular. Alguns desses limites dependem do tipo de dispositivo e do corpo do item se a expressão regular é aplicada no corpo do item.

**Tabela 2. Limita o tamanho do corpo do item avaliado**

||Cliente avançado do Outlook|Outlook em dispositivos móveis|Outlook na Web|
|:-----|:-----|:-----|:-----|
|**Fator forma**|Qualquer dispositivo com suporte.|Smartphones Android, iPad ou iPhone.|Qualquer dispositivo com suporte que não seja smartphones Android, iPad e iPhone.|
|**Corpo do item de texto sem formatação**|Aplica a regex no primeiro 1 MB de dados do corpo, mas não no restante do corpo acima desse limite.|Ativa o suplemento somente se o corpo ficar com menos de 16 mil caracteres.|Ativa o suplemento somente se o corpo ficar com menos de 500 mil caracteres.|
|**Corpo do item HTML**|Aplica a regex nos primeiros 512 KB de dados do corpo, mas não no restante do corpo acima desse limite. (O número real de caracteres depende da codificação, que pode variar de 1 a 4 bytes por caractere.)|Aplica a regex nos primeiros 64.000 KB de dados do corpo (incluindo caracteres de marca HTML), mas não no restante do corpo acima desse limite.|Ativa o suplemento somente se o corpo ficar com menos de 500 mil caracteres.|

A Tabela 3 lista os limites e descreve as diferenças nas correspondências que cada cliente do Outlook retorna depois de avaliar uma expressão regular. O suporte independe de um tipo de dispositivo específico, mas pode depender do tipo do corpo do item se a expressão regular é aplicada ao corpo do item.

**Tabela 3. Limites sobre as correspondências retornadas**

||Cliente avançado do Outlook|Outlook na Web ou em dispositivos móveis|
|:-----|:-----|:-----|
|**Ordem das correspondências retornadas**|Suponha `getRegExMatches` que retorne correspondências para que a mesma expressão regular aplicada no mesmo item seja diferente em um cliente avançado do Outlook do que em Outlook na Web ou dispositivos móveis.|Suponha `getRegExMatches` que retorne partidas em ordem diferente em um cliente avançado do Outlook do que Outlook na Web ou dispositivos móveis.|
|**Corpo do item de texto sem formatação**|`getRegExMatches` retorna qualquer corresponde que tem até 1.536 caracteres (1,5 KB), para um máximo de 50 partidas.<br/><br/>**Observação**: `getRegExMatches` não retorna as corresponde em nenhuma ordem específica na matriz retornada. Em geral, suponha que a ordem das correspondências em um cliente avançado do Outlook para a mesma expressão regular aplicada no mesmo item seja diferente da do Outlook na Web e dispositivos móveis.|`getRegExMatches` retorna qualquer corresponde que tem até 3.072 caracteres (3 KB), para um máximo de 50 partidas.|
|**Corpo do item HTML**|`getRegExMatches` retorna qualquer corresponde que tem até 3.072 caracteres (3 KB), para um máximo de 50 partidas.<br/> <br/> **Observação**: `getRegExMatches` não retorna as corresponde em nenhuma ordem específica na matriz retornada. Em geral, suponha que a ordem das correspondências em um cliente avançado do Outlook para a mesma expressão regular aplicada no mesmo item seja diferente da do Outlook na Web e dispositivos móveis.|`getRegExMatches` retorna qualquer corresponde que tem até 3.072 caracteres (3 KB), para um máximo de 50 partidas.|

## <a name="limits-for-javascript-api"></a>Limites para a API JavaScript

Além das diretrizes anteriores para regras de ativação, cada cliente do Outlook impõe determinados limites no modelo de objeto JavaScript, conforme descrito na Tabela 4.

**Tabela 4. Limites para obter ou definir determinados dados usando a API JavaScript do Office**

|Recurso|Limite|API relacionada|Descrição|
|:-----|:-----|:-----|:-----|
|Propriedades personalizadas|2.500 caracteres|Objeto [CustomProperties](/javascript/api/outlook/office.customproperties) método<br/> <br/>Método [item.loadCustomPropertiesAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Limite de todas as propriedades personalizadas para um item de compromisso ou mensagem. Todos os clientes do Outlook retornarão um erro se o tamanho total de todas as propriedades personalizadas de um suplemento exceder esse limite.|
|Configurações de roaming|32 KB número de caracteres|Objeto [RoamingSettings](/javascript/api/outlook/office.roamingsettings) propriedade<br/><br/> Propriedade [context.roamingSettings](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context#properties)|Limite para todas as configurações de roaming do suplemento. Todos os clientes do Outlook retornarão um erro se suas configurações excederem esse limite.|
|Cabeçalhos de Internet|256 KB por mensagem em Exchange Online<br/><br/>Limite de tamanho de cabeçalho determinado pelos administradores da organização no Exchange local|[Método InternetHeaders.setAsync](/javascript/api/outlook/office.internetheaders)|O limite de tamanho total de cabeçalhos que podem ser aplicados a uma mensagem.|
|Extrair entidades conhecidas|2000 número de caracteres|Método [item.getEntities](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods) método<br/> <br/>[item.getEntitiesByType](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods) método<br/> <br/>Método [item.getFilteredEntitiesByName](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Limite para o Exchange Server extrair entidades conhecidas no corpo do item. O Exchange Server ignora entidades além desse limite. Observe que esse limite é independente de o suplemento usar uma `ItemHasKnownEntity` regra.|
|Serviços Web do Exchange|1 MB número de caracteres|Método [mailbox.makeEwsRequestAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)|Limite para uma solicitação ou resposta a uma `Mailbox.makeEwsRequestAsync` chamada.|
|Destinatários|100 destinatários|Propriedade [item.requiredAttendees](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties) propriedade<br/> <br/>Propriedade [item.optionalAttendees](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Propriedade [item.to](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Propriedade [item.cc](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>[Recipients.addAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-addasync-member(1)) método<br/> <br/>[Recipient.getAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-getasync-member(1)) método<br/> <br/>Método [Recipient.setAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-setasync-member(1))|Limite para os destinatários especificados em cada propriedade.|
|Nome para exibição|255 caracteres|Propriedade [EmailAddressDetails.displayName](/javascript/api/outlook/office.emailaddressdetails#outlook-office-emailaddressdetails-displayname-member) objeto<br/><br/> [Recipients](/javascript/api/outlook/office.recipients) propriedade<br/><br/> `item.requiredAttendees` Propriedade<br/><br/> `item.optionalAttendees` Propriedade <br/><br/>`item.to` Propriedade <br/><br/>`item.cc` Propriedade|Limite de tamanho de um nome de exibição em um compromisso ou uma mensagem.|
|Definir o assunto|255 caracteres|Método [mailbox.displayNewAppointmentForm](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods) método<br/><br/> Método [Subject.setAsync](/javascript/api/outlook/office.subject#outlook-office-subject-setasync-member(1))|Limite para o assunto no formulário do novo compromisso ou para definir o assunto de um compromisso ou uma mensagem.|
|Definir o local|255 caracteres|Método [Location.setAsync](/javascript/api/outlook/office.location#outlook-office-location-setasync-member(1))|Limite para definir o local de um compromisso ou solicitação de reunião.|
|Corpo em um novo formulário de compromisso|32 KB número de caracteres|`Mailbox.displayNewAppointmentForm` Método|Limite do corpo em um formulário de novo compromisso.|
|Exibir o corpo de um item existente|32 KB número de caracteres|Método[mailbox.displayAppointmentForm](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods) método<br/><br/> Método [mailbox.displayMessageForm](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)|Para Outlook na Web dispositivos móveis: limite para o corpo em um formulário de compromisso ou mensagem existente.|
|Definir o corpo|1 MB número de caracteres|Método [Body.prependAsync](/javascript/api/outlook/office.body#outlook-office-body-prependasync-member(1)) método<br/> <br/>[Body.setAsync](/javascript/api/outlook/office.body#outlook-office-body-setasync-member(1))<br/><br/>Método [Body.setSelectedDataAsync](/javascript/api/outlook/office.body#outlook-office-body-setselecteddataasync-member(1))|Limite para configurar o corpo de um item de compromisso ou de mensagem.|
|Número de anexos|499 arquivos em Outlook na Web e dispositivos móveis|Método [item.addFileAttachmentAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Limite do número de arquivos que podem ser anexados a um item para envio. Outlook na Web e dispositivos móveis geralmente limitam a anexação de até 499 arquivos, por meio da interface do usuário e `addFileAttachmentAsync`. Um cliente avançado do Outlook não limita especificamente o número de anexos de arquivo. No entanto, todos os clientes do Outlook observam o limite para o tamanho dos anexos com os Exchange Server usuário foram configurados. Confira o "Tamanho dos anexos" na próxima linha.|
|Tamanho dos anexos|Depende do Exchange Server|`item.addFileAttachmentAsync` Método|Há um limite no tamanho de todos os anexos de um item que um administrador pode configurar no Exchange Server da caixa de correio do usuário. Para um cliente avançado do Outlook, isso limita a quantidade de anexos de um item. Para Outlook na Web e dispositivos móveis, o menor dos dois limites – o número de anexos e o tamanho de todos os anexos – restringe os anexos reais de um item.|
|Nome do arquivo anexo|255 caracteres|`item.addFileAttachmentAsync` Método|Limite para o comprimento do nome de arquivo de um anexo a ser adicionado a um item.|
|URI do anexo|2048 caracteres|`item.addFileAttachmentAsync` Método|Limite do URI do nome de arquivo a ser adicionado como um anexo a um item.|
|ID do anexo|100 caracteres|Método [item.addItemAttachmentAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods) método<br/><br/> Método [item.removeAttachmentAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Limite para o tamanho da ID do anexo a ser adicionado ou removido de um item.|
|Chamadas assíncronas|3 chamadas|`item.addFileAttachmentAsync` Método<br/><br/>`item.addItemAttachmentAsync` Método<br/><br/><br/>`item.removeAttachmentAsync` Método<br/><br/> [Body.getTypeAsync](/javascript/api/outlook/office.body#outlook-office-body-gettypeasync-member(1)) método<br/><br/>`Body.prependAsync` Método<br/><br/>`Body.setSelectedDataAsync` Método<br/><br/> [CustomProperties.saveAsync](/javascript/api/outlook/office.customproperties#outlook-office-customproperties-saveasync-member(1)) método<br/><br/><br/> [Item. Método LoadCustomPropertiesAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)<br/><br/><br/> [Location.getAsync](/javascript/api/outlook/office.location#outlook-office-location-getasync-member(1)) método<br/><br/>`Location.setAsync` Método<br/><br/> [mailbox.getCallbackTokenAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods) método<br/><br/> [mailbox.getUserIdentityTokenAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods) método<br/><br/> [mailbox.makeEwsRequestAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods) método<br/><br/>`Recipients.addAsync` Método<br/><br/> [Recipients.getAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-getasync-member(1)) método<br/><br/>`Recipients.setAsync` Método<br/><br/> [RoamingSettings.saveAsync](/javascript/api/outlook/office.roamingsettings#outlook-office-roamingsettings-saveasync-member(1)) método<br/><br/> [Subject.getAsync](/javascript/api/outlook/office.subject#outlook-office-subject-getasync-member(1)) método<br/><br/>`Subject.setAsync` Método<br/><br/> [Time.getAsync](/javascript/api/outlook/office.time#outlook-office-time-getasync-member(1)) método<br/><br/> Método [Time.setAsync](/javascript/api/outlook/office.time#outlook-office-time-setasync-member(1))|Para Outlook na Web ou dispositivos móveis: limite do número de chamadas assíncronas simultâneas a qualquer momento, pois os navegadores permitem apenas um número limitado de chamadas assíncronas para servidores. |

## <a name="see-also"></a>Confira também

- [Implantar e instalar suplementos do Outlook para teste](testing-and-tips.md)
- [Privacidade, permissões e segurança para suplementos do Outlook](../concepts/privacy-and-security.md)
