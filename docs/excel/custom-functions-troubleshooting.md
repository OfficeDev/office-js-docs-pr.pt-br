---
ms.date: 03/19/2019
description: Solução de problemas comuns em funções personalizadas do Excel.
title: Solução de problemas de funções personalizadas (versão prévia)
localization_priority: Priority
ms.openlocfilehash: 19c3dcccce7618289dc49c3f61ce781744c24369
ms.sourcegitcommit: a2950492a2337de3180b713f5693fe82dbdd6a17
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/27/2019
ms.locfileid: "30871336"
---
# <a name="troubleshoot-custom-functions"></a><span data-ttu-id="3d935-103">Solução de problemas de funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="3d935-103">Troubleshoot custom functions</span></span>

<span data-ttu-id="3d935-104">Ao desenvolver funções personalizadas, você poderá encontrar erros no produto durante a criação e testes das funções.</span><span class="sxs-lookup"><span data-stu-id="3d935-104">When developing custom functions, you may encounter errors in the product while creating and testing your functions.</span></span>

<span data-ttu-id="3d935-105">Para resolver problemas, você pode [habilitar o log de tempo de execução para capturar erros](#enable-runtime-logging) e consultar as [mensagens de erro nativas do Excel](#check-for-excel-error-messages).</span><span class="sxs-lookup"><span data-stu-id="3d935-105">To resolve issues, you can [enable runtime logging to capture errors](#enable-runtime-logging) and refer to [Excel's native error messages](#check-for-excel-error-messages).</span></span> <span data-ttu-id="3d935-106">Além disso, verifique se há erros comuns, como não [verificar certificados ssl](#verify-ssl-certificates) de forma adequada, [deixar promessas não resolvidas](#ensure-promises-return) e esquecer de [associar as funções](#associate-your-functions).</span><span class="sxs-lookup"><span data-stu-id="3d935-106">Also, check for common mistakes such as not [verifying ssl certificates](#verify-ssl-certificates) properly, [leaving promises unresolved](#ensure-promises-return), and forgetting to [associate your functions](#associate-your-functions).</span></span>

## <a name="enable-runtime-logging"></a><span data-ttu-id="3d935-107">Habilitar o log de tempo de execução</span><span class="sxs-lookup"><span data-stu-id="3d935-107">Enable runtime logging</span></span>

<span data-ttu-id="3d935-108">Se estiver testando o suplemento do Office no Windows, você deverá [habilitar o log de tempo de execução](/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in).</span><span class="sxs-lookup"><span data-stu-id="3d935-108">If you are testing your add-in in Office on Windows, you should [enable runtime logging](/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in).</span></span> <span data-ttu-id="3d935-109">O log de tempo de execução entrega instruções `console.log` a um arquivo de log separado criado para ajudar você a descobrir problemas.</span><span class="sxs-lookup"><span data-stu-id="3d935-109">Runtime logging delivers `console.log` statements to a separate log file you create to help you uncover issues.</span></span> <span data-ttu-id="3d935-110">As instruções abrangem vários erros, incluindo os relacionados ao arquivo de manifesto XML do suplemento, condições do tempo de execução ou a instalação de funções personalizadas.</span><span class="sxs-lookup"><span data-stu-id="3d935-110">The statements cover a variety of errors, including errors pertaining to your add-in's XML manifest file, runtime conditions, or installation of your custom functions.</span></span>  <span data-ttu-id="3d935-111">Saiba mais sobre o log de tempo de execução em [Usar o log de tempo de execução para depurar seu suplemento](/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in).</span><span class="sxs-lookup"><span data-stu-id="3d935-111">For more information about runtime logging, see [Use runtime logging to debug your add-in](/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in).</span></span>  

### <a name="check-for-excel-error-messages"></a><span data-ttu-id="3d935-112">Verificar se há mensagens de erro do Excel</span><span class="sxs-lookup"><span data-stu-id="3d935-112">Check for Excel error messages</span></span>

<span data-ttu-id="3d935-113">O Excel tem diversas mensagens de erro internas que serão retornadas para uma célula se houver um erro de cálculo.</span><span class="sxs-lookup"><span data-stu-id="3d935-113">Excel has a number of built-in error messages which are returned to a cell if there is calculation error.</span></span> <span data-ttu-id="3d935-114">As funções personalizadas usam apenas as seguintes mensagens de erro: `#NULL!`, `#DIV/0!`, `#VALUE!`, `#REF!`, `#NAME?`, `#NUM!`, `#N/A` e `#BUSY!`.</span><span class="sxs-lookup"><span data-stu-id="3d935-114">Custom functions only use the following error messages: `#NULL!`, `#DIV/0!`, `#VALUE!`, `#REF!`, `#NAME?`, `#NUM!`, `#N/A`, and `#BUSY!`.</span></span>

## <a name="common-issues"></a><span data-ttu-id="3d935-115">Problemas comuns</span><span class="sxs-lookup"><span data-stu-id="3d935-115">Common issues</span></span>

### <a name="my-add-in-wont-load-verify-certifications"></a><span data-ttu-id="3d935-116">Meu suplemento não carrega: verificar certificações</span><span class="sxs-lookup"><span data-stu-id="3d935-116">My add-in won't load: verify certifications</span></span>

<span data-ttu-id="3d935-117">Se o suplemento não for devidamente instalado, verifique se os certificados SSL estão configurados corretamente para o servidor Web que hospeda seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="3d935-117">If your add-in fails to install, verify that the SSL certificates are configured correctly for the web server that's hosting your add-in.</span></span> <span data-ttu-id="3d935-118">Normalmente, se houver um problema com os certificados SSL, você verá uma mensagem de erro no Excel avisando que não foi possível instalar seu suplemento corretamente.</span><span class="sxs-lookup"><span data-stu-id="3d935-118">Typically if there is a problem with SSL certificates, you will see an error message in Excel warning you that your add-in could not be installed properly.</span></span> <span data-ttu-id="3d935-119">Saiba mais em [Adicionar certificados autoassinados como certificado raiz de confiança](https://github.com/OfficeDev/generator-office/blob/master/src/docs/ssl.md).</span><span class="sxs-lookup"><span data-stu-id="3d935-119">For more information, see [Adding self-signed certificates as trusted root certificate](https://github.com/OfficeDev/generator-office/blob/master/src/docs/ssl.md).</span></span>

### <a name="my-functions-wont-load-associate-functions"></a><span data-ttu-id="3d935-120">Minhas funções não carregam: associar funções</span><span class="sxs-lookup"><span data-stu-id="3d935-120">My functions won't load: associate functions</span></span>

<span data-ttu-id="3d935-121">No arquivo de script das funções personalizadas, você precisa associar cada função personalizada à respectiva ID especificada no [arquivo de metadados JSON](custom-functions-json.md).</span><span class="sxs-lookup"><span data-stu-id="3d935-121">In your custom functions' script file, you need to associate each custom function with its ID specified in the [JSON metadata file](custom-functions-json.md).</span></span> <span data-ttu-id="3d935-122">Isso é feito usando o método `CustomFunctions.associate()`.</span><span class="sxs-lookup"><span data-stu-id="3d935-122">This is done by using the `CustomFunctions.associate()` method.</span></span> <span data-ttu-id="3d935-123">Normalmente, essa chamada de método é feita após cada função ou no final do arquivo de script.</span><span class="sxs-lookup"><span data-stu-id="3d935-123">Typically this method call is made after each function or at the end of the script file.</span></span> <span data-ttu-id="3d935-124">Se uma função personalizada não estiver associada, ele não funcionará.</span><span class="sxs-lookup"><span data-stu-id="3d935-124">If a custom function is not associated, it will not work.</span></span>

<span data-ttu-id="3d935-125">O exemplo a seguir mostra uma função add, seguida pelo nome `add` da função que está sendo associada a `ADD` da id JSON correspondente.</span><span class="sxs-lookup"><span data-stu-id="3d935-125">The following example shows an add function, followed by the function's name `add` being associated with the corresponding JSON id `ADD`.</span></span>

```js
function add(first, second){
  return first + second;
}

CustomFunctions.associate("ADD", add);
```

<span data-ttu-id="3d935-126">Saiba mais sobre esse processo em [Associar os nomes de função com metadados JSON](/office/dev/add-ins/excel/custom-functions-best-practices#associating-function-names-with-json-metadata).</span><span class="sxs-lookup"><span data-stu-id="3d935-126">For more information on this process, see [Associating function names with json metadata](/office/dev/add-ins/excel/custom-functions-best-practices#associating-function-names-with-json-metadata).</span></span>

### <a name="ensure-promises-return"></a><span data-ttu-id="3d935-127">Garantir que as promessas retornem resultados</span><span class="sxs-lookup"><span data-stu-id="3d935-127">Ensure promises return</span></span>

<span data-ttu-id="3d935-128">Quando o Excel está aguardando a conclusão de uma função personalizada, ele exibe #BUSY!</span><span class="sxs-lookup"><span data-stu-id="3d935-128">When Excel is waiting for a custom function to complete, it displays #GETTING_DATA in the cell.</span></span> <span data-ttu-id="3d935-129">na célula.</span><span class="sxs-lookup"><span data-stu-id="3d935-129">Text selected in the cell</span></span> <span data-ttu-id="3d935-130">Se o código da função personalizada retornar uma promessa, mas a promessa não retornar um resultado, o Excel continuará exibindo #BUSY!.</span><span class="sxs-lookup"><span data-stu-id="3d935-130">If your custom function code returns a promise, but the promise does not return a result, Excel will continue showing #GETTING_DATA.</span></span> <span data-ttu-id="3d935-131">Verifique suas funções para garantir que as promessas estejam retornando corretamente um resultado para uma célula.</span><span class="sxs-lookup"><span data-stu-id="3d935-131">Check your functions to make sure that any promises are properly returning a result to a cell.</span></span>

## <a name="reporting-feedback"></a><span data-ttu-id="3d935-132">Fornecer comentários</span><span class="sxs-lookup"><span data-stu-id="3d935-132">Reporting Feedback</span></span>

<span data-ttu-id="3d935-133">Se você tiver problemas que não estão descritos aqui, fale conosco.</span><span class="sxs-lookup"><span data-stu-id="3d935-133">If you are encountering issues that aren't documented here, let us know.</span></span> <span data-ttu-id="3d935-134">Há duas maneiras de relatar problemas.</span><span class="sxs-lookup"><span data-stu-id="3d935-134">There are two ways to report issues.</span></span>

### <a name="in-excel-on-windows-or-mac"></a><span data-ttu-id="3d935-135">No Excel para Windows ou Mac</span><span class="sxs-lookup"><span data-stu-id="3d935-135">In Excel on Windows or Mac</span></span>

<span data-ttu-id="3d935-136">Se estiver usando o Excel para Windows ou Mac, envie comentários à equipe de extensibilidade do Office diretamente do Excel.</span><span class="sxs-lookup"><span data-stu-id="3d935-136">If using Excel for Windows or Mac, you can report feedback to the Office extensibility team directly from Excel.</span></span> <span data-ttu-id="3d935-137">Para fazer isso, selecione **Arquivo -> Comentários -> Enviar um Rosto Triste**.</span><span class="sxs-lookup"><span data-stu-id="3d935-137">To do this, select **File -> Feedback -> Send a Frown**.</span></span> <span data-ttu-id="3d935-138">Enviando um Rosto Triste, você fornece os registros necessários para entendermos o problema que você está enfrentando.</span><span class="sxs-lookup"><span data-stu-id="3d935-138">Sending a frown will provide the necessary logs to understand the issue you are hitting.</span></span>

### <a name="in-github"></a><span data-ttu-id="3d935-139">No Github</span><span class="sxs-lookup"><span data-stu-id="3d935-139">In Github</span></span>

<span data-ttu-id="3d935-140">Sinta-se à vontade para enviar problemas encontrados através do recurso "Comentários do conteúdo" na parte inferior de todas as páginas de documentação ou [informe um novo problema diretamente no repositório de funções personalizadas](https://github.com/OfficeDev/Excel-Custom-Functions/issues).</span><span class="sxs-lookup"><span data-stu-id="3d935-140">Feel free to submit an issue you encounter either through the "Content feedback" feature at the bottom of any documentation page, or by [filing a new issue directly to the custom functions repository](https://github.com/OfficeDev/Excel-Custom-Functions/issues).</span></span>

## <a name="see-also"></a><span data-ttu-id="3d935-141">Confira também</span><span class="sxs-lookup"><span data-stu-id="3d935-141">See also</span></span>

* [<span data-ttu-id="3d935-142">Metadados de funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="3d935-142">Custom functions metadata</span></span>](custom-functions-json.md)
* [<span data-ttu-id="3d935-143">Tempo de execução de funções personalizadas do Excel</span><span class="sxs-lookup"><span data-stu-id="3d935-143">Runtime for Excel custom functions</span></span>](custom-functions-runtime.md)
* <span data-ttu-id="3d935-144">[Práticas recomendadas de funções personalizadas](custom-functions-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="3d935-144">[Custom functions best practices](custom-functions-best-practices.md)</span></span>
* [<span data-ttu-id="3d935-145">Log de alteração de funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="3d935-145">Custom functions changelog</span></span>](custom-functions-changelog.md)
* [<span data-ttu-id="3d935-146">Tutorial de funções personalizadas do Excel</span><span class="sxs-lookup"><span data-stu-id="3d935-146">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
