---
title: Coautoria em suplementos do Excel
description: Aprenda a coautor uma Excel de trabalho armazenada em OneDrive, OneDrive for Business ou SharePoint Online.
ms.date: 07/23/2020
localization_priority: Normal
ms.openlocfilehash: d6500248c13f0cef85736b4ffbad0dc655afecd7
ms.sourcegitcommit: 883f71d395b19ccfc6874a0d5942a7016eb49e2c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/09/2021
ms.locfileid: "53349683"
---
# <a name="coauthoring-in-excel-add-ins"></a><span data-ttu-id="4d0c8-103">Coautoria em suplementos do Excel</span><span class="sxs-lookup"><span data-stu-id="4d0c8-103">Coauthoring in Excel add-ins</span></span>  

<span data-ttu-id="4d0c8-p101">Com a [coautoria](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), várias pessoas podem trabalhar juntas e editar simultaneamente a mesma pasta de trabalho do Excel. Todos os coautores de uma pasta de trabalho podem ver as alterações de outros coautores assim que o coautor salva a pasta de trabalho. Para ser coautor de uma pasta de trabalho do Excel, esta deve ser armazenada no OneDrive, OneDrive for Business ou SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-p101">With [coauthoring](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), multiple people can work together and edit the same Excel workbook simultaneously. All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook. To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4d0c8-107">Em Excel para Microsoft 365, você notará o AutoSave no canto superior esquerdo.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-107">In Excel for Microsoft 365, you will notice AutoSave in the upper-left corner.</span></span> <span data-ttu-id="4d0c8-108">Quando o Salvamento Automático estiver ativado, os coautores verão as respectivas alterações em tempo real.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-108">When AutoSave is turned on, coauthors see your changes in real time.</span></span> <span data-ttu-id="4d0c8-109">Considere o impacto desse comportamento no design do seu suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-109">Consider the impact of this behavior on the design of your Excel add-in.</span></span> <span data-ttu-id="4d0c8-110">Os usuários podem desativar o Salvamento Automático pelo botão no canto superior esquerdo da janela do Excel.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-110">Users can turn off AutoSave via the switch in the upper left of the Excel window.</span></span>

## <a name="coauthoring-overview"></a><span data-ttu-id="4d0c8-111">Visão geral da coautoria</span><span class="sxs-lookup"><span data-stu-id="4d0c8-111">Coauthoring overview</span></span>

<span data-ttu-id="4d0c8-112">Quando você altera o conteúdo de uma pasta de trabalho, o Excel sincroniza automaticamente essas alterações entre todos os coautores.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-112">When you change a workbook's content, Excel automatically synchronizes those changes across all coauthors.</span></span> <span data-ttu-id="4d0c8-113">Os coautores podem alterar o conteúdo de uma pasta de trabalho, assim como o código em execução em um suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-113">Coauthors can change the content of a workbook, but so can code running within an Excel add-in.</span></span> <span data-ttu-id="4d0c8-114">Por exemplo, quando o código JavaScript a seguir é executado em um Office, o valor de um intervalo é definido como Contoso.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-114">For example, when the following JavaScript code runs in an Office Add-in, the value of a range is set to Contoso.</span></span>

```js
range.values = [['Contoso']];
```

<span data-ttu-id="4d0c8-115">Depois que "Contoso" é sincronizado entre todos os coautores, qualquer usuário ou suplemento em execução na mesma pasta de trabalho verá o novo valor do intervalo.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-115">After 'Contoso' synchronizes across all coauthors, any user or add-in running in the same workbook will see the new value of the range.</span></span>

<span data-ttu-id="4d0c8-p104">A coautoria sincroniza apenas o conteúdo dentro da pasta de trabalho compartilhada. Os valores copiados da pasta de trabalho em variáveis de JavaScript em um suplemento do Excel não são sincronizados. Por exemplo, se seu suplemento armazenar o valor de uma célula (como "Contoso") em uma variável de JavaScript e um coautor alterar o valor da célula para "Exemplo", após a sincronização todos os coautores verão "Exemplo" na célula. No entanto, o valor da variável de JavaScript continuará definido como "Contoso". Além disso, quando vários autores usarem o mesmo suplemento, cada coautor terá sua própria cópia da variável, que não é sincronizada. Quando você usar variáveis que usam o conteúdo da pasta de trabalho, não se esqueça de verificar se há valores atualizados na pasta de trabalho antes de usar a variável.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-p104">Coauthoring only synchronizes the content within the shared workbook. Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized. For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell. However, the value of the JavaScript variable is still set to 'Contoso'. Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized. When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.</span></span>

## <a name="use-events-to-manage-the-in-memory-state-of-your-add-in"></a><span data-ttu-id="4d0c8-122">Usar eventos para gerenciar o estado na memória do suplemento</span><span class="sxs-lookup"><span data-stu-id="4d0c8-122">Use events to manage the in-memory state of your add-in</span></span>

<span data-ttu-id="4d0c8-p105">Os suplementos do Excel podem ler conteúdo da pasta de trabalho (de planilhas ocultas e um objeto de configuração) e armazená-lo em estruturas de dados, como variáveis. Depois que os valores originais são copiados em qualquer uma dessas estruturas de dados, os coautores podem atualizar o conteúdo da pasta de trabalho original. Isso significa que os valores copiados nas estruturas de dados agora estão fora de sincronia com o conteúdo da pasta de trabalho. Ao criar seus suplementos, lembre-se dessa separação do conteúdo da pasta de trabalho e dos valores armazenados em estruturas de dados.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-p105">Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables. After the original values are copied into any of these data structures, coauthors can update the original workbook content. This means that the copied values in the data structures are now out of sync with the workbook content. When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.</span></span>

<span data-ttu-id="4d0c8-127">Por exemplo, você pode criar um suplemento de conteúdo que exibe visualizações personalizadas.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-127">For example, you might build a content add-in that displays custom visualizations.</span></span> <span data-ttu-id="4d0c8-128">O estado de suas visualizações personalizadas pode ser salvo em uma planilha oculta.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-128">The state of your custom visualizations might be saved in a hidden worksheet.</span></span> <span data-ttu-id="4d0c8-129">Quando os coautores usam a mesma lista de trabalho, o cenário a seguir pode ocorrer.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-129">When coauthors use the same workbook, the following scenario can occur.</span></span>

- <span data-ttu-id="4d0c8-p107">O Usuário A abre o documento e as visualizações personalizadas são mostradas na pasta de trabalho. As visualizações personalizadas leem dados de uma planilha oculta (por exemplo, a cor das visualizações é definida como azul).</span><span class="sxs-lookup"><span data-stu-id="4d0c8-p107">User A opens the document and the custom visualizations are shown in the workbook. The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).</span></span>
- <span data-ttu-id="4d0c8-p108">O usuário B abre o mesmo documento e começa a modificar as visualizações personalizadas. O usuário B define a cor das visualizações personalizadas para laranja. A cor laranja é salva para a planilha oculta.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-p108">User B opens the same document, and starts modifying the custom visualizations. User B sets the color of the custom visualizations to orange. Orange is saved to the hidden worksheet.</span></span>
- <span data-ttu-id="4d0c8-135">A planilha oculta do Usuário A é atualizada com o novo valor laranja.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-135">User A's hidden worksheet is updated with the new value of orange.</span></span>
- <span data-ttu-id="4d0c8-136">As visualizações personalizadas do Usuário A continuam azuis.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-136">User A's custom visualizations are still blue.</span></span>

<span data-ttu-id="4d0c8-p109">Se quiser que as visualizações personalizadas do Usuário A respondam às alterações feitas pelos coautores na planilha oculta, use o evento [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs). Isso garante que as alterações no conteúdo da pasta de trabalho feitas pelos coautores sejam refletidas no estado do seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-p109">If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) event. This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.</span></span>

## <a name="caveats-to-using-events-with-coauthoring"></a><span data-ttu-id="4d0c8-139">Advertências para usar eventos com coautoria</span><span class="sxs-lookup"><span data-stu-id="4d0c8-139">Caveats to using events with coauthoring</span></span>

<span data-ttu-id="4d0c8-p110">Conforme descrito anteriormente, em alguns cenários, acionar eventos para todos os coautores proporciona uma experiência do usuários aprimorada. No entanto, lembre-se de que, em alguns cenários, esse comportamento pode resultar em uma má experiência do usuário.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-p110">As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience. However, be aware that in some scenarios this behavior can produce poor user experiences.</span></span>

<span data-ttu-id="4d0c8-142">Por exemplo, em cenários de validação de dados, é comum exibir a interface do usuário em resposta a eventos.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-142">For example, in data validation scenarios, it is common to display UI in response to events.</span></span> <span data-ttu-id="4d0c8-143">O evento [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) descrito na seção anterior é executado quando um usuário local ou coautor (remoto) altera o conteúdo da pasta de trabalho na associação.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-143">The [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) event described in the previous section runs when either a local user or coauthor (remote) changes the workbook content within the binding.</span></span> <span data-ttu-id="4d0c8-144">Se o manipulador de eventos do evento exibir a interface do usuário, os usuários verão a interface do usuário que não está relacionada às alterações em que estavam trabalhando na guia de trabalho, levando a uma experiência de usuário `BindingDataChanged` ruim.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-144">If the event handler of the `BindingDataChanged` event displays UI, users will see UI that is unrelated to changes they were working on in the workbook, leading to a poor user experience.</span></span> <span data-ttu-id="4d0c8-145">Evite a exibição da interface do usuário ao usar eventos no suplemento.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-145">Avoid displaying UI when using events in your add-in.</span></span>

## <a name="avoiding-table-row-coauthoring-conflicts"></a><span data-ttu-id="4d0c8-146">Evitando conflitos de coautor da linha de tabela</span><span class="sxs-lookup"><span data-stu-id="4d0c8-146">Avoiding table row coauthoring conflicts</span></span>

<span data-ttu-id="4d0c8-147">É um problema conhecido que as chamadas para a [`TableRowCollection.add`](/javascript/api/excel/excel.tablerowcollection#add-index--values-) API podem causar conflitos de coautoria.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-147">It is a known issue that calls to the [`TableRowCollection.add`](/javascript/api/excel/excel.tablerowcollection#add-index--values-) API can cause coauthoring conflicts.</span></span> <span data-ttu-id="4d0c8-148">Não recomendamos o uso dessa API se você antecipar que seu complemento será executado enquanto outros usuários estão editando a workbook do complemento (especificamente, se eles estão editando a tabela ou qualquer intervalo sob a tabela).</span><span class="sxs-lookup"><span data-stu-id="4d0c8-148">We do not recommend using that API if you anticipate your add-in will be run while other users are editing the add-in's workbook (specifically, if they are editing the table or any range under the table).</span></span> <span data-ttu-id="4d0c8-149">As orientações a seguir devem ajudá-lo a evitar problemas com o método (e evitar a acionamento da barra amarela Excel mostra que solicita que os usuários `TableRowCollection.add` atualizem).</span><span class="sxs-lookup"><span data-stu-id="4d0c8-149">The following guidance should help you avoid issues with the `TableRowCollection.add` method (and avoid triggering the yellow bar Excel shows that asks users to refresh).</span></span>

1. <span data-ttu-id="4d0c8-150">Use [`Range.values`](/javascript/api/excel/excel.range#values) em vez de [`TableRowCollection.add`](/javascript/api/excel/excel.tablerowcollection#add-index--values-) .</span><span class="sxs-lookup"><span data-stu-id="4d0c8-150">Use [`Range.values`](/javascript/api/excel/excel.range#values) instead of [`TableRowCollection.add`](/javascript/api/excel/excel.tablerowcollection#add-index--values-).</span></span> <span data-ttu-id="4d0c8-151">Definir os `Range` valores diretamente abaixo da tabela expande automaticamente a tabela.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-151">Setting the `Range` values directly below the table automatically expands the table.</span></span> <span data-ttu-id="4d0c8-152">Caso contrário, adicionar linhas de tabela por meio das APIs resulta em conflitos `Table` de mesclagem para usuários de coauth.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-152">Otherwise, adding table rows through the `Table` APIs results in merge conflicts for coauth users.</span></span>
1. <span data-ttu-id="4d0c8-153">Não deve haver regras [de validação de](https://support.microsoft.com/office/apply-data-validation-to-cells-29fecbcc-d1b9-42c1-9d76-eff3ce5f7249) dados aplicadas a células abaixo da tabela, a menos que a validação de dados seja aplicada a toda a coluna.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-153">There should be no [data validation rules](https://support.microsoft.com/office/apply-data-validation-to-cells-29fecbcc-d1b9-42c1-9d76-eff3ce5f7249) applied to cells below the table, unless the data validation is applied to the entire column.</span></span>
1. <span data-ttu-id="4d0c8-154">Se houver dados sob a tabela, o complemento precisará lidar com isso antes de definir o valor do intervalo.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-154">If there is data under the table, the add-in needs to handle that before setting the range value.</span></span> <span data-ttu-id="4d0c8-155">Usar [`Range.insert`](/javascript/api/excel/excel.range##insert-shift-) para inserir uma linha vazia moverá os dados e dará espaço para a tabela de expansão.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-155">Using [`Range.insert`](/javascript/api/excel/excel.range##insert-shift-) to insert an empty row will move the data and make space for the expanding table.</span></span> <span data-ttu-id="4d0c8-156">Caso contrário, você corre o risco de sobrescrever células abaixo da tabela.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-156">Otherwise, you risk overwriting cells below the table.</span></span>
1. <span data-ttu-id="4d0c8-157">Não é possível adicionar uma linha vazia a uma tabela com `Range.values` .</span><span class="sxs-lookup"><span data-stu-id="4d0c8-157">You cannot add an empty row to a table with `Range.values`.</span></span> <span data-ttu-id="4d0c8-158">A tabela só se expande automaticamente se os dados estão presentes nas células diretamente abaixo da tabela.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-158">The table only automatically expands if data is present in the cells directly below the table.</span></span> <span data-ttu-id="4d0c8-159">Use dados temporários ou colunas ocultas como solução alternativa para adicionar uma linha de tabela vazia.</span><span class="sxs-lookup"><span data-stu-id="4d0c8-159">Use either temporary data or hidden columns as a workaround to add an empty table row.</span></span>

## <a name="see-also"></a><span data-ttu-id="4d0c8-160">Confira também</span><span class="sxs-lookup"><span data-stu-id="4d0c8-160">See also</span></span>

- [<span data-ttu-id="4d0c8-161">Sobre a coautoria no Excel (VBA)</span><span class="sxs-lookup"><span data-stu-id="4d0c8-161">About coauthoring in Excel (VBA)</span></span>](/office/vba/excel/concepts/about-coauthoring-in-excel)
- [<span data-ttu-id="4d0c8-162">Como o Salvamento Automático afeta suplementos e macros (VBA)</span><span class="sxs-lookup"><span data-stu-id="4d0c8-162">How AutoSave impacts add-ins and macros (VBA)</span></span>](/office/vba/library-reference/concepts/how-autosave-impacts-addins-and-macros)
