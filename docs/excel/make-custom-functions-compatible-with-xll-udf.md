---
title: Tornar suas funções personalizadas compatíveis com as funções definidas pelo usuário XLL
description: Habilitar a compatibilidade com as funções definidas pelo usuário do Excel XLL que possuem funcionalidade equivalente às suas funções personalizadas
ms.date: 04/22/2019
localization_priority: Normal
ms.openlocfilehash: 09914e040c1721dd8b9e91952e5814e7a6b914e5
ms.sourcegitcommit: 7462409209264dc7f8f89f3808a7a6249fcd739e
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/26/2019
ms.locfileid: "33356833"
---
# <a name="make-your-custom-functions-compatible-with-xll-user-defined-functions"></a><span data-ttu-id="ddcda-103">Tornar suas funções personalizadas compatíveis com as funções definidas pelo usuário XLL</span><span class="sxs-lookup"><span data-stu-id="ddcda-103">Make your custom functions compatible with XLL user-defined functions</span></span>

<span data-ttu-id="ddcda-104">Se você tiver os XLLs do Excel existentes, poderá criar funções personalizadas equivalentes em um suplemento do Office para estender seus recursos de solução para outras plataformas, como online ou macOS.</span><span class="sxs-lookup"><span data-stu-id="ddcda-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Office Add-in to extend your solution features to other platforms such as online or macOS.</span></span> <span data-ttu-id="ddcda-105">No enTanto, os suplementos do Office não possuem todas as funcionalidades disponíveis em XLLs.</span><span class="sxs-lookup"><span data-stu-id="ddcda-105">However, Office Add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="ddcda-106">Dependendo da funcionalidade que sua solução usa, o XLL pode fornecer uma experiência melhor do que as funções personalizadas do suplemento do Office no Excel para Windows.</span><span class="sxs-lookup"><span data-stu-id="ddcda-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Office Add-in custom functions on Excel for Windows.</span></span>

<span data-ttu-id="ddcda-107">Você pode configurar seu suplemento do Office para que, quando um XLL equivalente já estiver instalado no computador do usuário, o Excel execute o XLL, em vez de suas funções personalizadas do suplemento do Office.</span><span class="sxs-lookup"><span data-stu-id="ddcda-107">You can configure your Office Add-in so that when an equivalent XLL is already installed on the user's computer, Excel runs the XLL instead of your Office Add-in custom functions.</span></span> <span data-ttu-id="ddcda-108">O XLL é chamado de equivalente porque o Excel faz a transição contínua entre as funções de personalização XLL e suplemento do Office, dependendo da que está instalada no Windows.</span><span class="sxs-lookup"><span data-stu-id="ddcda-108">The XLL is called equivalent because Excel will seamlessly transition between the XLL and the Office Add-in custom functions depending on which is installed on Windows.</span></span>

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="ddcda-109">Especificar o XLL equivalente no manifesto</span><span class="sxs-lookup"><span data-stu-id="ddcda-109">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="ddcda-110">Para habilitar a compatibilidade com um XLL existente, identifique o XLL equivalente no manifesto do suplemento do Office.</span><span class="sxs-lookup"><span data-stu-id="ddcda-110">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Office Add-in.</span></span> <span data-ttu-id="ddcda-111">Em seguida, o Excel usará as funções do XLL em vez de suas funções personalizadas do suplemento do Office durante a execução no Windows.</span><span class="sxs-lookup"><span data-stu-id="ddcda-111">Then Excel will use the XLL's functions instead of your Office Add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="ddcda-112">Para definir o XLL equivalente para suas funções personalizadas, especifique o `FileName` do XLL.</span><span class="sxs-lookup"><span data-stu-id="ddcda-112">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="ddcda-113">Quando o usuário abre uma pasta de trabalho com funções do XLL, o Excel converte as funções em funções compatíveis.</span><span class="sxs-lookup"><span data-stu-id="ddcda-113">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="ddcda-114">Em seguida, a pasta de trabalho usa o XLL quando aberto no Excel no Windows, e ele usará as funções personalizadas do seu suplemento do Office quando for aberto online ou no macOS.</span><span class="sxs-lookup"><span data-stu-id="ddcda-114">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Office Add-in when opened online or on macOS.</span></span>

<span data-ttu-id="ddcda-115">O exemplo a seguir mostra como especificar um suplemento de COM e um XLL como equivalente.</span><span class="sxs-lookup"><span data-stu-id="ddcda-115">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="ddcda-116">Em geral, você especifica tanto tanto quanto à integridade este exemplo mostra tanto no contexto.</span><span class="sxs-lookup"><span data-stu-id="ddcda-116">Often you will specify both so for completeness this example shows both in context.</span></span> <span data-ttu-id="ddcda-117">Eles são identificados por seus `ProgID` e `FileName` , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="ddcda-117">They are identified by their `ProgID` and `FileName` respectively.</span></span> <span data-ttu-id="ddcda-118">Para obter mais informações sobre a compatibilidade do suplemento COM, confira [tornar o suplemento do Office compatível com um suplemento de com existente](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="ddcda-118">For more information on COM add-in compatibility, see [Make your Office Add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
...
<EquivalentAddins>
  <EquivalentAddin>
    <ProgID>ContosoCOMAddin</ProgID>
    <Type>COM</Type>
  </EquivalentAddin>

  <EquivalentAddin>
    <FileName>contosofunctions.xll</FileName>
    <Type>XLL</Type>
  </EquivalentAddin>
<EquivalentAddins>
...
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="ddcda-119">Se um suplemento declarar suas funções personalizadas para serem compatíveis com XLL, alterar o manifesto posteriormente poderá quebrar a pasta de trabalho de um usuário, pois ele alterará o formato de arquivo.</span><span class="sxs-lookup"><span data-stu-id="ddcda-119">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user’s workbook because it will change the file format.</span></span>

## <a name="office-add-in-updates"></a><span data-ttu-id="ddcda-120">Atualizações de suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="ddcda-120">Office Add-in updates</span></span>

<span data-ttu-id="ddcda-121">Depois de especificar um XLL equivalente para o suplemento do Office, o Excel interrompe o processamento de atualizações para seu suplemento do Office.</span><span class="sxs-lookup"><span data-stu-id="ddcda-121">Once you specify an equivalent XLL for your Office Add-in, Excel stops processing updates for your Office Add-in.</span></span> <span data-ttu-id="ddcda-122">O usuário deve desinstalar o XLL para obter as atualizações mais recentes para o suplemento do Office.</span><span class="sxs-lookup"><span data-stu-id="ddcda-122">The user must uninstall the XLL in order to get the latest updates for the Office Add-in.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="ddcda-123">Comportamento de função personalizada para funções compatíveis com XLL</span><span class="sxs-lookup"><span data-stu-id="ddcda-123">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="ddcda-124">Quando uma planilha é aberta contendo funções XLL para as quais há também um suplemento equivalente, as funções do XLL são convertidas em funções personalizadas compatíveis com XLL.</span><span class="sxs-lookup"><span data-stu-id="ddcda-124">When a spreadsheet is opened that contains XLL functions for which there is also an equivalent add-in, the XLL's functions are converted to XLL compatible custom functions.</span></span> <span data-ttu-id="ddcda-125">No próximo salvamento, eles são gravados no arquivo em um modo compatível para que funcionem com as funções personalizadas do XLL e do suplemento do Office (quando em outras plataformas).</span><span class="sxs-lookup"><span data-stu-id="ddcda-125">On the next save, they are written to the file in a compatible mode so that they work with both the XLL and Office Add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="ddcda-126">A tabela a seguir compara os recursos nas funções de XLL definidas pelo usuário, funções personalizadas compatíveis e funções personalizadas do suplemento do Office.</span><span class="sxs-lookup"><span data-stu-id="ddcda-126">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Office Add-in custom functions.</span></span>

|         |<span data-ttu-id="ddcda-127">Função de XLL definida pelo usuário</span><span class="sxs-lookup"><span data-stu-id="ddcda-127">XLL user-defined function</span></span> |<span data-ttu-id="ddcda-128">Funções personalizadas compatíveis com XLL</span><span class="sxs-lookup"><span data-stu-id="ddcda-128">XLL compatible custom functions</span></span> |<span data-ttu-id="ddcda-129">Função personalizada de suplemento do Office</span><span class="sxs-lookup"><span data-stu-id="ddcda-129">Office Add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="ddcda-130">Plataformas com suporte</span><span class="sxs-lookup"><span data-stu-id="ddcda-130">Supported platforms</span></span> | <span data-ttu-id="ddcda-131">Windows</span><span class="sxs-lookup"><span data-stu-id="ddcda-131">Windows</span></span> | <span data-ttu-id="ddcda-132">Windows, macOS, Excel online</span><span class="sxs-lookup"><span data-stu-id="ddcda-132">Windows, macOS, Excel online</span></span> | <span data-ttu-id="ddcda-133">Windows, macOS, Excel online</span><span class="sxs-lookup"><span data-stu-id="ddcda-133">Windows, macOS, Excel online</span></span> |
| <span data-ttu-id="ddcda-134">Formatos de arquivo com suporte</span><span class="sxs-lookup"><span data-stu-id="ddcda-134">Supported file formats</span></span> | <span data-ttu-id="ddcda-135">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="ddcda-135">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="ddcda-136">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="ddcda-136">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="ddcda-137">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="ddcda-137">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="ddcda-138">Preenchimento automático de fórmula</span><span class="sxs-lookup"><span data-stu-id="ddcda-138">Formula autocomplete</span></span> | <span data-ttu-id="ddcda-139">Não</span><span class="sxs-lookup"><span data-stu-id="ddcda-139">No</span></span> | <span data-ttu-id="ddcda-140">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-140">Yes</span></span> | <span data-ttu-id="ddcda-141">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-141">Yes</span></span> |
| <span data-ttu-id="ddcda-142">Streaming</span><span class="sxs-lookup"><span data-stu-id="ddcda-142">Streaming</span></span> | <span data-ttu-id="ddcda-143">Possível via xlfRTD e o retorno de chamada XLL.</span><span class="sxs-lookup"><span data-stu-id="ddcda-143">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="ddcda-144">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-144">Yes</span></span> | <span data-ttu-id="ddcda-145">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-145">Yes</span></span> |
| <span data-ttu-id="ddcda-146">Localização de funções</span><span class="sxs-lookup"><span data-stu-id="ddcda-146">Localization of functions</span></span> | <span data-ttu-id="ddcda-147">Não</span><span class="sxs-lookup"><span data-stu-id="ddcda-147">No</span></span> | <span data-ttu-id="ddcda-148">Não.</span><span class="sxs-lookup"><span data-stu-id="ddcda-148">No.</span></span> <span data-ttu-id="ddcda-149">O nome e a ID devem corresponder às funções de XLL existentes.</span><span class="sxs-lookup"><span data-stu-id="ddcda-149">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="ddcda-150">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-150">Yes</span></span> |
| <span data-ttu-id="ddcda-151">Funções voláteis</span><span class="sxs-lookup"><span data-stu-id="ddcda-151">Volatile functions</span></span> | <span data-ttu-id="ddcda-152">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-152">Yes</span></span> | <span data-ttu-id="ddcda-153">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-153">Yes</span></span> | <span data-ttu-id="ddcda-154">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-154">Yes</span></span> |
| <span data-ttu-id="ddcda-155">Suporte para recálculo de vários encadeamentos</span><span class="sxs-lookup"><span data-stu-id="ddcda-155">Multi-threaded recalculation support</span></span> | <span data-ttu-id="ddcda-156">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-156">Yes</span></span> | <span data-ttu-id="ddcda-157">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-157">Yes</span></span> | <span data-ttu-id="ddcda-158">Sim</span><span class="sxs-lookup"><span data-stu-id="ddcda-158">Yes</span></span> |
| <span data-ttu-id="ddcda-159">Comportamento de cálculo</span><span class="sxs-lookup"><span data-stu-id="ddcda-159">Calculation behavior</span></span> | <span data-ttu-id="ddcda-160">Nenhuma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="ddcda-160">No UI.</span></span> <span data-ttu-id="ddcda-161">O Excel pode não responder durante o cálculo.</span><span class="sxs-lookup"><span data-stu-id="ddcda-161">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="ddcda-162">Os usuários verão #BUSY!</span><span class="sxs-lookup"><span data-stu-id="ddcda-162">Users will see #BUSY!</span></span> <span data-ttu-id="ddcda-163">até que um resultado seja retornado.</span><span class="sxs-lookup"><span data-stu-id="ddcda-163">until a result is returned.</span></span> | <span data-ttu-id="ddcda-164">Os usuários verão #BUSY!</span><span class="sxs-lookup"><span data-stu-id="ddcda-164">Users will see #BUSY!</span></span> <span data-ttu-id="ddcda-165">até que um resultado seja retornado.</span><span class="sxs-lookup"><span data-stu-id="ddcda-165">until a result is returned.</span></span> |
| <span data-ttu-id="ddcda-166">Conjuntos de requisitos</span><span class="sxs-lookup"><span data-stu-id="ddcda-166">Requirement sets</span></span> | <span data-ttu-id="ddcda-167">N/D</span><span class="sxs-lookup"><span data-stu-id="ddcda-167">N/A</span></span> | <span data-ttu-id="ddcda-168">CustomFunctions 1,1 somente</span><span class="sxs-lookup"><span data-stu-id="ddcda-168">CustomFunctions 1.1 only</span></span> | <span data-ttu-id="ddcda-169">CustomFunctions 1,1 e posterior</span><span class="sxs-lookup"><span data-stu-id="ddcda-169">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="ddcda-170">Confira também</span><span class="sxs-lookup"><span data-stu-id="ddcda-170">See also</span></span>

- [<span data-ttu-id="ddcda-171">Tornar o suplemento do Office compatível com um suplemento de COM existente</span><span class="sxs-lookup"><span data-stu-id="ddcda-171">Make your Office Add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- <span data-ttu-id="ddcda-172">[Práticas recomendadas de funções personalizadas](custom-functions-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="ddcda-172">[Custom functions best practices](custom-functions-best-practices.md)</span></span>
- [<span data-ttu-id="ddcda-173">Log de alteração de funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="ddcda-173">Custom functions changelog</span></span>](custom-functions-changelog.md)
- [<span data-ttu-id="ddcda-174">Tutorial de funções personalizadas do Excel</span><span class="sxs-lookup"><span data-stu-id="ddcda-174">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)