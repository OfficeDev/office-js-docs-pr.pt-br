---
title: Estender funções personalizadas com funções definidas pelo usuário XLL
description: Habilitar a compatibilidade com as funções definidas pelo usuário do Excel XLL que possuem funcionalidade equivalente às suas funções personalizadas
ms.date: 07/31/2019
localization_priority: Normal
ms.openlocfilehash: a0a98dab1ec046151d2dd0d80a4a3a4542654574
ms.sourcegitcommit: 528577145b2cf0a42bc64c56145d661c4d019fb8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/02/2019
ms.locfileid: "37353878"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions"></a><span data-ttu-id="eaff6-103">Estender funções personalizadas com funções definidas pelo usuário XLL</span><span class="sxs-lookup"><span data-stu-id="eaff6-103">Extend custom functions with XLL user-defined functions</span></span>

<span data-ttu-id="eaff6-104">Se você tiver os XLLs do Excel existentes, poderá criar funções personalizadas equivalentes em um suplemento do Excel para estender seus recursos de solução para outras plataformas, como online ou macOS.</span><span class="sxs-lookup"><span data-stu-id="eaff6-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or macOS.</span></span> <span data-ttu-id="eaff6-105">No entanto, os suplementos do Excel não possuem todas as funcionalidades disponíveis em XLLs.</span><span class="sxs-lookup"><span data-stu-id="eaff6-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="eaff6-106">Dependendo da funcionalidade que sua solução usa, o XLL pode fornecer uma experiência melhor do que as funções personalizadas do suplemento do Excel no Excel no Windows.</span><span class="sxs-lookup"><span data-stu-id="eaff6-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

> [!NOTE]
> <span data-ttu-id="eaff6-107">O suplemento de COM e a compatibilidade do XLL UDF são compatíveis com as seguintes plataformas, quando conectados a uma assinatura do Office 365:</span><span class="sxs-lookup"><span data-stu-id="eaff6-107">COM add-in and XLL UDF compatibility is supported by the following platforms, when connected to an Office 365 subscription:</span></span>
> - <span data-ttu-id="eaff6-108">Excel na Web</span><span class="sxs-lookup"><span data-stu-id="eaff6-108">Excel on the web</span></span>
> - <span data-ttu-id="eaff6-109">Excel no Windows (versão 1904 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="eaff6-109">Excel on Windows (version 1904 or later)</span></span>
> - <span data-ttu-id="eaff6-110">Excel no Mac (versão 13,329 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="eaff6-110">Excel on Mac (version 13.329 or later)</span></span>
> 
> <span data-ttu-id="eaff6-111">Para usar o suplemento de COM e a compatibilidade do XLL UDF no Excel na Web, faça logon usando sua assinatura do Office 365 ou uma [conta da Microsoft](https://account.microsoft.com/account).</span><span class="sxs-lookup"><span data-stu-id="eaff6-111">To use COM add-in and XLL UDF compatibility within Excel on the web, login by using either your Office 365 subscription or a [Microsoft account](https://account.microsoft.com/account).</span></span> <span data-ttu-id="eaff6-112">Caso ainda não tenha uma assinatura do Office 365, obtenha uma ingressando no [Programa para Desenvolvedores do Office 365](https://developer.microsoft.com/office/dev-program).</span><span class="sxs-lookup"><span data-stu-id="eaff6-112">If you don't already have an Office 365 subscription, you can get one by joining the [Office 365 Developer Program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="eaff6-113">Especificar o XLL equivalente no manifesto</span><span class="sxs-lookup"><span data-stu-id="eaff6-113">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="eaff6-114">Para habilitar a compatibilidade com um XLL existente, identifique o XLL equivalente no manifesto do suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="eaff6-114">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="eaff6-115">Em seguida, o Excel usará as funções do XLL em vez de suas funções personalizadas do suplemento do Excel ao executar o Windows.</span><span class="sxs-lookup"><span data-stu-id="eaff6-115">Then Excel will use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="eaff6-116">Para definir o XLL equivalente para suas funções personalizadas, especifique o `FileName` do XLL.</span><span class="sxs-lookup"><span data-stu-id="eaff6-116">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="eaff6-117">Quando o usuário abre uma pasta de trabalho com funções do XLL, o Excel converte as funções em funções compatíveis.</span><span class="sxs-lookup"><span data-stu-id="eaff6-117">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="eaff6-118">Em seguida, a pasta de trabalho usa o XLL quando aberto no Excel no Windows, e ele usará as funções personalizadas do seu suplemento do Excel quando ele for aberto online ou no macOS.</span><span class="sxs-lookup"><span data-stu-id="eaff6-118">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on macOS.</span></span>

<span data-ttu-id="eaff6-119">O exemplo a seguir mostra como especificar um suplemento de COM e um XLL como equivalente.</span><span class="sxs-lookup"><span data-stu-id="eaff6-119">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="eaff6-120">Em geral, você especifica tanto tanto quanto à integridade este exemplo mostra tanto no contexto.</span><span class="sxs-lookup"><span data-stu-id="eaff6-120">Often you will specify both so for completeness this example shows both in context.</span></span> <span data-ttu-id="eaff6-121">Eles são identificados por seus `ProgId` e `FileName` , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="eaff6-121">They are identified by their `ProgId` and `FileName` respectively.</span></span> <span data-ttu-id="eaff6-122">O `EquivalentAddins` elemento deve ser posicionado imediatamente antes da `VersionOverrides` marca de fechamento.</span><span class="sxs-lookup"><span data-stu-id="eaff6-122">The `EquivalentAddins` element must be positioned immediately before the closing `VersionOverrides` tag.</span></span> <span data-ttu-id="eaff6-123">Para obter mais informações sobre a compatibilidade do suplemento COM, consulte [tornar o suplemento do Excel compatível com um suplemento de com existente](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="eaff6-123">For more information on COM add-in compatibility, see [Make your Excel add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>

    <EquivalentAddin>
      <FileName>contosofunctions.xll</FileName>
      <Type>XLL</Type>
    </EquivalentAddin>
  <EquivalentAddins>
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="eaff6-124">Se um suplemento declarar suas funções personalizadas para serem compatíveis com XLL, alterar o manifesto posteriormente poderá quebrar a pasta de trabalho de um usuário, pois ele alterará o formato de arquivo.</span><span class="sxs-lookup"><span data-stu-id="eaff6-124">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user’s workbook because it will change the file format.</span></span>

## <a name="excel-add-in-updates"></a><span data-ttu-id="eaff6-125">Atualizações de suplementos do Excel</span><span class="sxs-lookup"><span data-stu-id="eaff6-125">Excel add-in updates</span></span>

<span data-ttu-id="eaff6-126">Depois de especificar um XLL equivalente para seu suplemento do Excel, o Excel interrompe o processamento de atualizações para seu suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="eaff6-126">Once you specify an equivalent XLL for your Excel add-in, Excel stops processing updates for your Excel add-in.</span></span> <span data-ttu-id="eaff6-127">O usuário deve desinstalar o XLL para obter as atualizações mais recentes para o suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="eaff6-127">The user must uninstall the XLL in order to get the latest updates for the Excel add-in.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="eaff6-128">Comportamento de função personalizada para funções compatíveis com XLL</span><span class="sxs-lookup"><span data-stu-id="eaff6-128">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="eaff6-129">Quando uma planilha é aberta contendo funções XLL para as quais há também um suplemento equivalente, as funções do XLL são convertidas em funções personalizadas compatíveis com XLL.</span><span class="sxs-lookup"><span data-stu-id="eaff6-129">When a spreadsheet is opened that contains XLL functions for which there is also an equivalent add-in, the XLL's functions are converted to XLL compatible custom functions.</span></span> <span data-ttu-id="eaff6-130">Na próxima vez que você salvar, eles serão gravados no arquivo em um modo compatível para que eles funcionem com as funções personalizadas do XLL e do suplemento do Excel (quando em outras plataformas).</span><span class="sxs-lookup"><span data-stu-id="eaff6-130">On the next save, they are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="eaff6-131">A tabela a seguir compara os recursos nas funções de XLL definidas pelo usuário, funções personalizadas compatíveis e funções personalizadas de suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="eaff6-131">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="eaff6-132">Função de XLL definida pelo usuário</span><span class="sxs-lookup"><span data-stu-id="eaff6-132">XLL user-defined function</span></span> |<span data-ttu-id="eaff6-133">Funções personalizadas compatíveis com XLL</span><span class="sxs-lookup"><span data-stu-id="eaff6-133">XLL compatible custom functions</span></span> |<span data-ttu-id="eaff6-134">Função personalizada de suplemento do Excel</span><span class="sxs-lookup"><span data-stu-id="eaff6-134">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="eaff6-135">Plataformas com suporte</span><span class="sxs-lookup"><span data-stu-id="eaff6-135">Supported platforms</span></span> | <span data-ttu-id="eaff6-136">Windows</span><span class="sxs-lookup"><span data-stu-id="eaff6-136">Windows</span></span> | <span data-ttu-id="eaff6-137">Windows, macOS, navegador da Web</span><span class="sxs-lookup"><span data-stu-id="eaff6-137">Windows, macOS, web browser</span></span> | <span data-ttu-id="eaff6-138">Windows, macOS, navegador da Web</span><span class="sxs-lookup"><span data-stu-id="eaff6-138">Windows, macOS, web browser</span></span> |
| <span data-ttu-id="eaff6-139">Formatos de arquivo com suporte</span><span class="sxs-lookup"><span data-stu-id="eaff6-139">Supported file formats</span></span> | <span data-ttu-id="eaff6-140">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="eaff6-140">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="eaff6-141">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="eaff6-141">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="eaff6-142">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="eaff6-142">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="eaff6-143">Preenchimento automático de fórmula</span><span class="sxs-lookup"><span data-stu-id="eaff6-143">Formula autocomplete</span></span> | <span data-ttu-id="eaff6-144">Não</span><span class="sxs-lookup"><span data-stu-id="eaff6-144">No</span></span> | <span data-ttu-id="eaff6-145">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-145">Yes</span></span> | <span data-ttu-id="eaff6-146">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-146">Yes</span></span> |
| <span data-ttu-id="eaff6-147">Streaming</span><span class="sxs-lookup"><span data-stu-id="eaff6-147">Streaming</span></span> | <span data-ttu-id="eaff6-148">Possível via xlfRTD e o retorno de chamada XLL.</span><span class="sxs-lookup"><span data-stu-id="eaff6-148">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="eaff6-149">Não</span><span class="sxs-lookup"><span data-stu-id="eaff6-149">No</span></span> | <span data-ttu-id="eaff6-150">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-150">Yes</span></span> |
| <span data-ttu-id="eaff6-151">Localização de funções</span><span class="sxs-lookup"><span data-stu-id="eaff6-151">Localization of functions</span></span> | <span data-ttu-id="eaff6-152">Não</span><span class="sxs-lookup"><span data-stu-id="eaff6-152">No</span></span> | <span data-ttu-id="eaff6-153">Não.</span><span class="sxs-lookup"><span data-stu-id="eaff6-153">No.</span></span> <span data-ttu-id="eaff6-154">O nome e a ID devem corresponder às funções de XLL existentes.</span><span class="sxs-lookup"><span data-stu-id="eaff6-154">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="eaff6-155">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-155">Yes</span></span> |
| <span data-ttu-id="eaff6-156">Funções voláteis</span><span class="sxs-lookup"><span data-stu-id="eaff6-156">Volatile functions</span></span> | <span data-ttu-id="eaff6-157">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-157">Yes</span></span> | <span data-ttu-id="eaff6-158">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-158">Yes</span></span> | <span data-ttu-id="eaff6-159">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-159">Yes</span></span> |
| <span data-ttu-id="eaff6-160">Suporte para recálculo de vários encadeamentos</span><span class="sxs-lookup"><span data-stu-id="eaff6-160">Multi-threaded recalculation support</span></span> | <span data-ttu-id="eaff6-161">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-161">Yes</span></span> | <span data-ttu-id="eaff6-162">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-162">Yes</span></span> | <span data-ttu-id="eaff6-163">Sim</span><span class="sxs-lookup"><span data-stu-id="eaff6-163">Yes</span></span> |
| <span data-ttu-id="eaff6-164">Comportamento de cálculo</span><span class="sxs-lookup"><span data-stu-id="eaff6-164">Calculation behavior</span></span> | <span data-ttu-id="eaff6-165">Nenhuma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="eaff6-165">No UI.</span></span> <span data-ttu-id="eaff6-166">O Excel pode não responder durante o cálculo.</span><span class="sxs-lookup"><span data-stu-id="eaff6-166">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="eaff6-167">Os usuários verão #BUSY!</span><span class="sxs-lookup"><span data-stu-id="eaff6-167">Users will see #BUSY!</span></span> <span data-ttu-id="eaff6-168">até que um resultado seja retornado.</span><span class="sxs-lookup"><span data-stu-id="eaff6-168">until a result is returned.</span></span> | <span data-ttu-id="eaff6-169">Os usuários verão #BUSY!</span><span class="sxs-lookup"><span data-stu-id="eaff6-169">Users will see #BUSY!</span></span> <span data-ttu-id="eaff6-170">até que um resultado seja retornado.</span><span class="sxs-lookup"><span data-stu-id="eaff6-170">until a result is returned.</span></span> |
| <span data-ttu-id="eaff6-171">Conjuntos de requisitos</span><span class="sxs-lookup"><span data-stu-id="eaff6-171">Requirement sets</span></span> | <span data-ttu-id="eaff6-172">N/D</span><span class="sxs-lookup"><span data-stu-id="eaff6-172">N/A</span></span> | <span data-ttu-id="eaff6-173">CustomFunctions 1,1 e posterior</span><span class="sxs-lookup"><span data-stu-id="eaff6-173">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="eaff6-174">CustomFunctions 1,1 e posterior</span><span class="sxs-lookup"><span data-stu-id="eaff6-174">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="eaff6-175">Confira também</span><span class="sxs-lookup"><span data-stu-id="eaff6-175">See also</span></span>

- [<span data-ttu-id="eaff6-176">Tornar seu suplemento do Excel compatível com um suplemento de COM existente</span><span class="sxs-lookup"><span data-stu-id="eaff6-176">Make your Excel add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="eaff6-177">Tutorial de funções personalizadas do Excel</span><span class="sxs-lookup"><span data-stu-id="eaff6-177">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
