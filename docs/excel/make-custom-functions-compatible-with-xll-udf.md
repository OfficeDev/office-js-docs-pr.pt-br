---
title: Estender funções personalizadas com funções definidas pelo usuário XLL
description: Habilitar a compatibilidade com as funções definidas pelo usuário do Excel XLL que possuem funcionalidade equivalente às suas funções personalizadas
ms.date: 04/29/2020
localization_priority: Normal
ms.openlocfilehash: 06a776678c60a4b66494097385f304ddac9a4ce0
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/08/2020
ms.locfileid: "44610358"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions"></a><span data-ttu-id="38375-103">Estender funções personalizadas com funções definidas pelo usuário XLL</span><span class="sxs-lookup"><span data-stu-id="38375-103">Extend custom functions with XLL user-defined functions</span></span>

<span data-ttu-id="38375-104">Se você tiver os XLLs do Excel existentes, poderá criar funções personalizadas equivalentes em um suplemento do Excel para estender seus recursos de solução para outras plataformas, como online ou em um Mac.</span><span class="sxs-lookup"><span data-stu-id="38375-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or on a Mac.</span></span> <span data-ttu-id="38375-105">No entanto, os suplementos do Excel não possuem todas as funcionalidades disponíveis em XLLs.</span><span class="sxs-lookup"><span data-stu-id="38375-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="38375-106">Dependendo da funcionalidade que sua solução usa, o XLL pode fornecer uma experiência melhor do que as funções personalizadas do suplemento do Excel no Excel no Windows.</span><span class="sxs-lookup"><span data-stu-id="38375-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

> [!NOTE]
> <span data-ttu-id="38375-107">O suplemento de COM e a compatibilidade do XLL UDF são compatíveis com as seguintes plataformas, quando conectados a uma assinatura do Office 365:</span><span class="sxs-lookup"><span data-stu-id="38375-107">COM add-in and XLL UDF compatibility is supported by the following platforms, when connected to an Office 365 subscription:</span></span>
> - <span data-ttu-id="38375-108">Excel Online</span><span class="sxs-lookup"><span data-stu-id="38375-108">Excel on the web</span></span>
> - <span data-ttu-id="38375-109">Excel no Windows (versão 1904 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="38375-109">Excel on Windows (version 1904 or later)</span></span>
> - <span data-ttu-id="38375-110">Excel no Mac (versão 13,329 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="38375-110">Excel on Mac (version 13.329 or later)</span></span>
> 
> <span data-ttu-id="38375-111">Para usar o suplemento de COM e a compatibilidade do XLL UDF no Excel na Web, faça logon usando sua assinatura do Office 365 ou uma [conta da Microsoft](https://account.microsoft.com/account).</span><span class="sxs-lookup"><span data-stu-id="38375-111">To use COM add-in and XLL UDF compatibility within Excel on the web, login by using either your Office 365 subscription or a [Microsoft account](https://account.microsoft.com/account).</span></span> <span data-ttu-id="38375-112">Se você ainda não tem uma assinatura do Office 365, é possível uma assinatura gratuita, de 90 dias, redimensionada do Office 365, participando do [programa de desenvolvedor do office 365](https://developer.microsoft.com/office/dev-program).</span><span class="sxs-lookup"><span data-stu-id="38375-112">If you don't already have an Office 365 subscription, you can a free, 90-day renewable Office 365 subscription by joining the [Office 365 Developer Program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="38375-113">Especificar o XLL equivalente no manifesto</span><span class="sxs-lookup"><span data-stu-id="38375-113">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="38375-114">Para habilitar a compatibilidade com um XLL existente, identifique o XLL equivalente no manifesto do suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="38375-114">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="38375-115">O Excel usará as funções do XLL em vez de suas funções personalizadas do suplemento do Excel ao executar o Windows.</span><span class="sxs-lookup"><span data-stu-id="38375-115">Excel will then use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="38375-116">Para definir o XLL equivalente para suas funções personalizadas, especifique o `FileName` do XLL.</span><span class="sxs-lookup"><span data-stu-id="38375-116">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="38375-117">Quando o usuário abre uma pasta de trabalho com funções do XLL, o Excel converte as funções em funções compatíveis.</span><span class="sxs-lookup"><span data-stu-id="38375-117">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="38375-118">Em seguida, a pasta de trabalho usa o XLL quando aberto no Excel no Windows, e ele usará as funções personalizadas do seu suplemento do Excel quando ele for aberto online ou em um Mac.</span><span class="sxs-lookup"><span data-stu-id="38375-118">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on a Mac.</span></span>

<span data-ttu-id="38375-119">O exemplo a seguir mostra como especificar um suplemento de COM e um XLL como equivalente.</span><span class="sxs-lookup"><span data-stu-id="38375-119">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="38375-120">Em geral, você especifica ambos.</span><span class="sxs-lookup"><span data-stu-id="38375-120">Often you will specify both.</span></span> <span data-ttu-id="38375-121">Para concluir, este exemplo mostra tanto no contexto.</span><span class="sxs-lookup"><span data-stu-id="38375-121">For completeness, this example shows both in context.</span></span> <span data-ttu-id="38375-122">Eles são identificados por seus `ProgId` e, `FileName` respectivamente.</span><span class="sxs-lookup"><span data-stu-id="38375-122">They are identified by their `ProgId` and `FileName` respectively.</span></span> <span data-ttu-id="38375-123">O `EquivalentAddins` elemento deve ser posicionado imediatamente antes da `VersionOverrides` marca de fechamento.</span><span class="sxs-lookup"><span data-stu-id="38375-123">The `EquivalentAddins` element must be positioned immediately before the closing `VersionOverrides` tag.</span></span> <span data-ttu-id="38375-124">Para obter mais informações sobre a compatibilidade do suplemento COM, consulte [tornar o suplemento do Excel compatível com um suplemento de com existente](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="38375-124">For more information on COM add-in compatibility, see [Make your Excel add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>

    <EquivalentAddin>
      <FileName>contosofunctions.xll</FileName>
      <Type>XLL</Type>
    </EquivalentAddin>
  <EquivalentAddins>
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="38375-125">Se um suplemento declarar suas funções personalizadas para serem compatíveis com XLL, alterar o manifesto posteriormente poderá quebrar a pasta de trabalho de um usuário, pois ele alterará o formato de arquivo.</span><span class="sxs-lookup"><span data-stu-id="38375-125">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user's workbook because it will change the file format.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="38375-126">Comportamento de função personalizada para funções compatíveis com XLL</span><span class="sxs-lookup"><span data-stu-id="38375-126">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="38375-127">As funções XLL de um suplemento são convertidas em funções personalizadas compatíveis com o XLL quando uma planilha é aberta e há um suplemento equivalente disponível.</span><span class="sxs-lookup"><span data-stu-id="38375-127">An add-in's XLL functions are converted to XLL compatible custom functions when a spreadsheet is opened and there is an equivalent add-in available.</span></span> <span data-ttu-id="38375-128">Na próxima vez que você salvar, as funções XLL serão gravadas no arquivo em um modo compatível para que funcionem com as funções personalizadas XLL e suplemento do Excel (quando estiverem em outras plataformas).</span><span class="sxs-lookup"><span data-stu-id="38375-128">On the next save, the XLL functions are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="38375-129">A tabela a seguir compara os recursos nas funções de XLL definidas pelo usuário, funções personalizadas compatíveis e funções personalizadas de suplemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="38375-129">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="38375-130">Função de XLL definida pelo usuário</span><span class="sxs-lookup"><span data-stu-id="38375-130">XLL user-defined function</span></span> |<span data-ttu-id="38375-131">Funções personalizadas compatíveis com XLL</span><span class="sxs-lookup"><span data-stu-id="38375-131">XLL compatible custom functions</span></span> |<span data-ttu-id="38375-132">Função personalizada de suplemento do Excel</span><span class="sxs-lookup"><span data-stu-id="38375-132">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="38375-133">Plataformas compatíveis</span><span class="sxs-lookup"><span data-stu-id="38375-133">Supported platforms</span></span> | <span data-ttu-id="38375-134">Windows</span><span class="sxs-lookup"><span data-stu-id="38375-134">Windows</span></span> | <span data-ttu-id="38375-135">Windows, macOS, navegador da Web</span><span class="sxs-lookup"><span data-stu-id="38375-135">Windows, macOS, web browser</span></span> | <span data-ttu-id="38375-136">Windows, macOS, navegador da Web</span><span class="sxs-lookup"><span data-stu-id="38375-136">Windows, macOS, web browser</span></span> |
| <span data-ttu-id="38375-137">Formatos de arquivo com suporte</span><span class="sxs-lookup"><span data-stu-id="38375-137">Supported file formats</span></span> | <span data-ttu-id="38375-138">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="38375-138">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="38375-139">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="38375-139">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="38375-140">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="38375-140">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="38375-141">Preenchimento automático de fórmula</span><span class="sxs-lookup"><span data-stu-id="38375-141">Formula autocomplete</span></span> | <span data-ttu-id="38375-142">Não</span><span class="sxs-lookup"><span data-stu-id="38375-142">No</span></span> | <span data-ttu-id="38375-143">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-143">Yes</span></span> | <span data-ttu-id="38375-144">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-144">Yes</span></span> |
| <span data-ttu-id="38375-145">Streaming</span><span class="sxs-lookup"><span data-stu-id="38375-145">Streaming</span></span> | <span data-ttu-id="38375-146">Possível via xlfRTD e o retorno de chamada XLL.</span><span class="sxs-lookup"><span data-stu-id="38375-146">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="38375-147">Não</span><span class="sxs-lookup"><span data-stu-id="38375-147">No</span></span> | <span data-ttu-id="38375-148">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-148">Yes</span></span> |
| <span data-ttu-id="38375-149">Localização de funções</span><span class="sxs-lookup"><span data-stu-id="38375-149">Localization of functions</span></span> | <span data-ttu-id="38375-150">Não</span><span class="sxs-lookup"><span data-stu-id="38375-150">No</span></span> | <span data-ttu-id="38375-151">Não.</span><span class="sxs-lookup"><span data-stu-id="38375-151">No.</span></span> <span data-ttu-id="38375-152">O nome e a ID devem corresponder às funções de XLL existentes.</span><span class="sxs-lookup"><span data-stu-id="38375-152">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="38375-153">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-153">Yes</span></span> |
| <span data-ttu-id="38375-154">Funções voláteis</span><span class="sxs-lookup"><span data-stu-id="38375-154">Volatile functions</span></span> | <span data-ttu-id="38375-155">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-155">Yes</span></span> | <span data-ttu-id="38375-156">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-156">Yes</span></span> | <span data-ttu-id="38375-157">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-157">Yes</span></span> |
| <span data-ttu-id="38375-158">Suporte para recálculo de vários encadeamentos</span><span class="sxs-lookup"><span data-stu-id="38375-158">Multi-threaded recalculation support</span></span> | <span data-ttu-id="38375-159">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-159">Yes</span></span> | <span data-ttu-id="38375-160">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-160">Yes</span></span> | <span data-ttu-id="38375-161">Sim</span><span class="sxs-lookup"><span data-stu-id="38375-161">Yes</span></span> |
| <span data-ttu-id="38375-162">Comportamento de cálculo</span><span class="sxs-lookup"><span data-stu-id="38375-162">Calculation behavior</span></span> | <span data-ttu-id="38375-163">Nenhuma interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="38375-163">No UI.</span></span> <span data-ttu-id="38375-164">O Excel pode não responder durante o cálculo.</span><span class="sxs-lookup"><span data-stu-id="38375-164">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="38375-165">Os usuários verão #BUSY!</span><span class="sxs-lookup"><span data-stu-id="38375-165">Users will see #BUSY!</span></span> <span data-ttu-id="38375-166">até que um resultado seja retornado.</span><span class="sxs-lookup"><span data-stu-id="38375-166">until a result is returned.</span></span> | <span data-ttu-id="38375-167">Os usuários verão #BUSY!</span><span class="sxs-lookup"><span data-stu-id="38375-167">Users will see #BUSY!</span></span> <span data-ttu-id="38375-168">até que um resultado seja retornado.</span><span class="sxs-lookup"><span data-stu-id="38375-168">until a result is returned.</span></span> |
| <span data-ttu-id="38375-169">Conjuntos de requisitos</span><span class="sxs-lookup"><span data-stu-id="38375-169">Requirement sets</span></span> | <span data-ttu-id="38375-170">N/A</span><span class="sxs-lookup"><span data-stu-id="38375-170">N/A</span></span> | <span data-ttu-id="38375-171">CustomFunctions 1,1 e posterior</span><span class="sxs-lookup"><span data-stu-id="38375-171">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="38375-172">CustomFunctions 1,1 e posterior</span><span class="sxs-lookup"><span data-stu-id="38375-172">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="38375-173">Confira também</span><span class="sxs-lookup"><span data-stu-id="38375-173">See also</span></span>

- [<span data-ttu-id="38375-174">Tornar seu suplemento do Excel compatível com um suplemento de COM existente</span><span class="sxs-lookup"><span data-stu-id="38375-174">Make your Excel add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="38375-175">Tutorial de funções personalizadas do Excel</span><span class="sxs-lookup"><span data-stu-id="38375-175">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
