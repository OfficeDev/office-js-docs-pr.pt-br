---
title: Estender funções personalizadas com funções definidas pelo usuário XLL
description: Habilitar a compatibilidade com funções definidas pelo usuário do Excel XLL que tenham funcionalidade equivalente às suas funções personalizadas
ms.date: 03/09/2021
localization_priority: Normal
ms.openlocfilehash: 32146e7eebb963e8d800b619ef052457e40f2ac6
ms.sourcegitcommit: c0c61fe84f3c5de88bd7eac29120056bb1224fc8
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/17/2021
ms.locfileid: "50836813"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions"></a><span data-ttu-id="1f840-103">Estender funções personalizadas com funções definidas pelo usuário XLL</span><span class="sxs-lookup"><span data-stu-id="1f840-103">Extend custom functions with XLL user-defined functions</span></span>

<span data-ttu-id="1f840-104">Se você tiver XLLs do Excel existentes, poderá criar funções personalizadas equivalentes em um complemento do Excel para estender seus recursos de solução para outras plataformas, como online ou em um Mac.</span><span class="sxs-lookup"><span data-stu-id="1f840-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or on a Mac.</span></span> <span data-ttu-id="1f840-105">No entanto, os complementos do Excel não têm toda a funcionalidade disponível em XLLs.</span><span class="sxs-lookup"><span data-stu-id="1f840-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="1f840-106">Dependendo da funcionalidade que sua solução usa, a XLL pode oferecer uma experiência melhor do que as funções personalizadas do complemento do Excel no Excel no Windows.</span><span class="sxs-lookup"><span data-stu-id="1f840-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

> [!NOTE]
> <span data-ttu-id="1f840-107">O complemento COM e a compatibilidade UDF XLL são compatíveis com as seguintes plataformas, quando conectadas a uma assinatura do Microsoft 365:</span><span class="sxs-lookup"><span data-stu-id="1f840-107">COM add-in and XLL UDF compatibility is supported by the following platforms, when connected to a Microsoft 365 subscription:</span></span>
>
> - <span data-ttu-id="1f840-108">Excel Online</span><span class="sxs-lookup"><span data-stu-id="1f840-108">Excel on the web</span></span>
> - <span data-ttu-id="1f840-109">Excel no Windows (versão 1904 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="1f840-109">Excel on Windows (version 1904 or later)</span></span>
> - <span data-ttu-id="1f840-110">Excel no Mac (versão 13.329 ou posterior)</span><span class="sxs-lookup"><span data-stu-id="1f840-110">Excel on Mac (version 13.329 or later)</span></span>
>
> <span data-ttu-id="1f840-111">Para usar o complemento COM e a compatibilidade UDF XLL no Excel na Web, faça logon usando sua assinatura do Microsoft 365 ou uma [conta da Microsoft.](https://account.microsoft.com/account)</span><span class="sxs-lookup"><span data-stu-id="1f840-111">To use COM add-in and XLL UDF compatibility within Excel on the web, login by using either your Microsoft 365 subscription or a [Microsoft account](https://account.microsoft.com/account).</span></span> <span data-ttu-id="1f840-112">Se você ainda não tiver uma assinatura do Microsoft 365, poderá ter uma assinatura do Microsoft [365](https://developer.microsoft.com/office/dev-program)renovável de 90 dias gratuita, juntando-se ao programa de desenvolvedor do Microsoft 365 .</span><span class="sxs-lookup"><span data-stu-id="1f840-112">If you don't already have a Microsoft 365 subscription, you can a free, 90-day renewable Microsoft 365 subscription by joining the [Microsoft 365 developer program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="1f840-113">Especificar XLL equivalente no manifesto</span><span class="sxs-lookup"><span data-stu-id="1f840-113">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="1f840-114">Para habilitar a compatibilidade com uma XLL existente, identifique a XLL equivalente no manifesto do seu complemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="1f840-114">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="1f840-115">O Excel usará as funções XLL em vez de funções personalizadas do seu complemento do Excel ao ser executado no Windows.</span><span class="sxs-lookup"><span data-stu-id="1f840-115">Excel will then use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="1f840-116">Para definir a XLL equivalente para suas funções personalizadas, especifique o `FileName` da XLL.</span><span class="sxs-lookup"><span data-stu-id="1f840-116">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="1f840-117">Quando o usuário abre uma planilha com funções da XLL, o Excel converte as funções em funções compatíveis.</span><span class="sxs-lookup"><span data-stu-id="1f840-117">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="1f840-118">A planilha usa a XLL quando aberta no Excel no Windows e usará funções personalizadas do seu complemento do Excel quando aberta online ou em um Mac.</span><span class="sxs-lookup"><span data-stu-id="1f840-118">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on a Mac.</span></span>

<span data-ttu-id="1f840-119">O exemplo a seguir mostra como especificar um complemento COM e uma XLL como equivalente.</span><span class="sxs-lookup"><span data-stu-id="1f840-119">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="1f840-120">Muitas vezes, você especificará ambos.</span><span class="sxs-lookup"><span data-stu-id="1f840-120">Often you will specify both.</span></span> <span data-ttu-id="1f840-121">Para completar, este exemplo mostra ambos no contexto.</span><span class="sxs-lookup"><span data-stu-id="1f840-121">For completeness, this example shows both in context.</span></span> <span data-ttu-id="1f840-122">Eles são identificados por `ProgId` seus e `FileName` respectivamente.</span><span class="sxs-lookup"><span data-stu-id="1f840-122">They are identified by their `ProgId` and `FileName` respectively.</span></span> <span data-ttu-id="1f840-123">O `EquivalentAddins` elemento deve ser posicionado imediatamente antes da marca de `VersionOverrides` fechamento.</span><span class="sxs-lookup"><span data-stu-id="1f840-123">The `EquivalentAddins` element must be positioned immediately before the closing `VersionOverrides` tag.</span></span> <span data-ttu-id="1f840-124">Para obter mais informações sobre compatibilidade com o complemento COM, consulte Tornar seu Add-in do Office compatível com um [add-in COM existente.](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)</span><span class="sxs-lookup"><span data-stu-id="1f840-124">For more information on COM add-in compatibility, see [Make your Office Add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>

    <EquivalentAddin>
      <FileName>contosofunctions.xll</FileName>
      <Type>XLL</Type>
    </EquivalentAddin>
  </EquivalentAddins>
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="1f840-125">Se um complemento declarar que suas funções personalizadas são compatíveis com XLL, alterar o manifesto posteriormente pode quebrar a pasta de trabalho do usuário porque ele alterará o formato de arquivo.</span><span class="sxs-lookup"><span data-stu-id="1f840-125">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user's workbook because it will change the file format.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="1f840-126">Comportamento de função personalizado para funções compatíveis com XLL</span><span class="sxs-lookup"><span data-stu-id="1f840-126">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="1f840-127">As funções XLL de um complemento são convertidas em funções personalizadas compatíveis com XLL quando uma planilha é aberta e há um complemento equivalente disponível.</span><span class="sxs-lookup"><span data-stu-id="1f840-127">An add-in's XLL functions are converted to XLL compatible custom functions when a spreadsheet is opened and there is an equivalent add-in available.</span></span> <span data-ttu-id="1f840-128">Na próxima salvação, as funções XLL são escritas no arquivo em um modo compatível para que elas funcionem com as funções personalizadas do complemento XLL e do Excel (quando em outras plataformas).</span><span class="sxs-lookup"><span data-stu-id="1f840-128">On the next save, the XLL functions are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="1f840-129">A tabela a seguir compara recursos entre funções definidas pelo usuário XLL, funções personalizadas compatíveis com XLL e funções personalizadas de complemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="1f840-129">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="1f840-130">Função definida pelo usuário XLL</span><span class="sxs-lookup"><span data-stu-id="1f840-130">XLL user-defined function</span></span> |<span data-ttu-id="1f840-131">Funções personalizadas compatíveis com XLL</span><span class="sxs-lookup"><span data-stu-id="1f840-131">XLL compatible custom functions</span></span> |<span data-ttu-id="1f840-132">Função personalizada do complemento do Excel</span><span class="sxs-lookup"><span data-stu-id="1f840-132">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="1f840-133">**Plataformas compatíveis**</span><span class="sxs-lookup"><span data-stu-id="1f840-133">**Supported platforms**</span></span> | <span data-ttu-id="1f840-134">Windows</span><span class="sxs-lookup"><span data-stu-id="1f840-134">Windows</span></span> | <span data-ttu-id="1f840-135">Windows, macOS, navegador da Web</span><span class="sxs-lookup"><span data-stu-id="1f840-135">Windows, macOS, web browser</span></span> | <span data-ttu-id="1f840-136">Windows, macOS, navegador da Web</span><span class="sxs-lookup"><span data-stu-id="1f840-136">Windows, macOS, web browser</span></span> |
| <span data-ttu-id="1f840-137">**Formatos de arquivo com suporte**</span><span class="sxs-lookup"><span data-stu-id="1f840-137">**Supported file formats**</span></span> | <span data-ttu-id="1f840-138">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="1f840-138">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="1f840-139">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="1f840-139">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="1f840-140">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="1f840-140">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="1f840-141">**Preenchimento automático de fórmula**</span><span class="sxs-lookup"><span data-stu-id="1f840-141">**Formula autocomplete**</span></span> | <span data-ttu-id="1f840-142">Não</span><span class="sxs-lookup"><span data-stu-id="1f840-142">No</span></span> | <span data-ttu-id="1f840-143">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-143">Yes</span></span> | <span data-ttu-id="1f840-144">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-144">Yes</span></span> |
| <span data-ttu-id="1f840-145">**Streaming**</span><span class="sxs-lookup"><span data-stu-id="1f840-145">**Streaming**</span></span> | <span data-ttu-id="1f840-146">Possível por meio de retorno de chamada xlfRTD e XLL.</span><span class="sxs-lookup"><span data-stu-id="1f840-146">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="1f840-147">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-147">Yes</span></span> | <span data-ttu-id="1f840-148">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-148">Yes</span></span> |
| <span data-ttu-id="1f840-149">**Localização de funções**</span><span class="sxs-lookup"><span data-stu-id="1f840-149">**Localization of functions**</span></span> | <span data-ttu-id="1f840-150">Não</span><span class="sxs-lookup"><span data-stu-id="1f840-150">No</span></span> | <span data-ttu-id="1f840-151">Não.</span><span class="sxs-lookup"><span data-stu-id="1f840-151">No.</span></span> <span data-ttu-id="1f840-152">O Nome e a ID devem corresponder às funções existentes da XLL.</span><span class="sxs-lookup"><span data-stu-id="1f840-152">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="1f840-153">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-153">Yes</span></span> |
| <span data-ttu-id="1f840-154">**Funções voláteis**</span><span class="sxs-lookup"><span data-stu-id="1f840-154">**Volatile functions**</span></span> | <span data-ttu-id="1f840-155">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-155">Yes</span></span> | <span data-ttu-id="1f840-156">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-156">Yes</span></span> | <span data-ttu-id="1f840-157">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-157">Yes</span></span> |
| <span data-ttu-id="1f840-158">**Suporte a recálculo com vários threads**</span><span class="sxs-lookup"><span data-stu-id="1f840-158">**Multi-threaded recalculation support**</span></span> | <span data-ttu-id="1f840-159">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-159">Yes</span></span> | <span data-ttu-id="1f840-160">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-160">Yes</span></span> | <span data-ttu-id="1f840-161">Sim</span><span class="sxs-lookup"><span data-stu-id="1f840-161">Yes</span></span> |
| <span data-ttu-id="1f840-162">**Comportamento de cálculo**</span><span class="sxs-lookup"><span data-stu-id="1f840-162">**Calculation behavior**</span></span> | <span data-ttu-id="1f840-163">Sem interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="1f840-163">No UI.</span></span> <span data-ttu-id="1f840-164">O Excel pode não responder durante o cálculo.</span><span class="sxs-lookup"><span data-stu-id="1f840-164">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="1f840-165">Os usuários verão #BUSY!</span><span class="sxs-lookup"><span data-stu-id="1f840-165">Users will see #BUSY!</span></span> <span data-ttu-id="1f840-166">até que um resultado seja retornado.</span><span class="sxs-lookup"><span data-stu-id="1f840-166">until a result is returned.</span></span> | <span data-ttu-id="1f840-167">Os usuários verão #BUSY!</span><span class="sxs-lookup"><span data-stu-id="1f840-167">Users will see #BUSY!</span></span> <span data-ttu-id="1f840-168">até que um resultado seja retornado.</span><span class="sxs-lookup"><span data-stu-id="1f840-168">until a result is returned.</span></span> |
| <span data-ttu-id="1f840-169">**Conjuntos de requisitos**</span><span class="sxs-lookup"><span data-stu-id="1f840-169">**Requirement sets**</span></span> | <span data-ttu-id="1f840-170">N/D</span><span class="sxs-lookup"><span data-stu-id="1f840-170">N/A</span></span> | <span data-ttu-id="1f840-171">CustomFunctions 1.1 e posterior</span><span class="sxs-lookup"><span data-stu-id="1f840-171">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="1f840-172">CustomFunctions 1.1 e posterior</span><span class="sxs-lookup"><span data-stu-id="1f840-172">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="1f840-173">Confira também</span><span class="sxs-lookup"><span data-stu-id="1f840-173">See also</span></span>

- [<span data-ttu-id="1f840-174">Torne o seu suplemento do Office compatível com um suplemento COM existente</span><span class="sxs-lookup"><span data-stu-id="1f840-174">Make your Office Add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="1f840-175">Tutorial de funções personalizadas do Excel</span><span class="sxs-lookup"><span data-stu-id="1f840-175">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
