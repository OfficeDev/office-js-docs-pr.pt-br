---
ms.date: 07/10/2019
description: Saiba mais sobre o tempo de execução de funções personalizadas do Excel.
title: Arquitetura de funções personalizadas
localization_priority: Normal
ms.openlocfilehash: ced62f7efb826862eee8079a66fa657ea466e4b3
ms.sourcegitcommit: d15bca2c12732f8599be2ec4b2adc7c254552f52
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/12/2020
ms.locfileid: "41950351"
---
# <a name="custom-functions-architecture"></a><span data-ttu-id="c275b-103">Arquitetura de funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="c275b-103">Custom functions architecture</span></span>

 <span data-ttu-id="c275b-104">Funções personalizadas estão com tempos de execução exclusivos que priorizam a execução de cálculos.</span><span class="sxs-lookup"><span data-stu-id="c275b-104">Custom functions are with their own unique runtime that prioritizes execution of calculations.</span></span> <span data-ttu-id="c275b-105">Este artigo aborda a diferenças entre o tempo de execução de funções personalizadas e o mecanismo de JavaScript baseados em navegador que habilita a maioria das outras partes do suplemento.</span><span class="sxs-lookup"><span data-stu-id="c275b-105">This article will cover the differences between the custom functions runtime and the browser-based JavaScript engine which powers most other parts of your add-in.</span></span>

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

## <a name="custom-functions-runtime"></a><span data-ttu-id="c275b-106">Tempo de execução de funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="c275b-106">Custom functions runtime</span></span>

<span data-ttu-id="c275b-107">Um suplemento Web do Office pode interagir com o usuário como um painel de tarefas ou como um painel de conteúdo e pode incluir comandos e funções personalizadas.</span><span class="sxs-lookup"><span data-stu-id="c275b-107">An Office Web Add-in can interact with the user as a task pane, or a content pane, and can include commands and custom functions.</span></span> <span data-ttu-id="c275b-108">Todas essas partes são executadas em um tempo de execução do mecanismo do navegador, exceto para funções personalizadas.</span><span class="sxs-lookup"><span data-stu-id="c275b-108">All of these parts run in a browser engine runtime except for custom functions.</span></span> <span data-ttu-id="c275b-109">As funções personalizadas são executadas em um tempo de execução de funções personalizadas separado para otimizar a velocidade de cálculo.</span><span class="sxs-lookup"><span data-stu-id="c275b-109">Custom functions run in a separate custom functions runtime to optimize for calculation speed.</span></span>

<span data-ttu-id="c275b-110">Observe que, se você estiver usando o [gerador Yeoman de suplementos do Office](https://www.npmjs.com/package/generator-office) para gerar o seu projeto, o tempo de execução de funções personalizadas será carregado por meio do arquivo de script custom-functions.js mencionado no arquivo **functions.html**.</span><span class="sxs-lookup"><span data-stu-id="c275b-110">Note that if you're using the [Yeoman generator for Office Add-ins](https://www.npmjs.com/package/generator-office) to generate your project, the custom functions runtime will load through the custom-functions.js script file referenced in the **functions.html** file.</span></span> <span data-ttu-id="c275b-111">O **functions.html** serve apenas para carregar o tempo de execução e não deve ser usado como painel de tarefas para o suplemento.</span><span class="sxs-lookup"><span data-stu-id="c275b-111">The **functions.html** serves only to load the runtime and shouldn't be used as the task pane for your add-in.</span></span>

<span data-ttu-id="c275b-112">A tabela a seguir destaca as diferenças entre o tempo de execução de funções personalizadas e o tempo de execução do mecanismo do navegador:</span><span class="sxs-lookup"><span data-stu-id="c275b-112">The following table highlights the differences between the custom functions runtime and the browser engine runtime:</span></span>

| <span data-ttu-id="c275b-113">Tempo de execução de funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="c275b-113">Custom functions runtime</span></span>  | <span data-ttu-id="c275b-114">Tempo de execução do mecanismo do navegador</span><span class="sxs-lookup"><span data-stu-id="c275b-114">Browser engine runtime</span></span>    |
|------------------------------------------------------------------ |-------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="c275b-115">Suporte para retornar o valor de uma célula</span><span class="sxs-lookup"><span data-stu-id="c275b-115">Supports returning a value from a cell</span></span>    | <span data-ttu-id="c275b-116">Suporte para APIs Office.js e elementos de interface do usuário</span><span class="sxs-lookup"><span data-stu-id="c275b-116">Supports Office.js APIs and UI elements</span></span>   |
| <span data-ttu-id="c275b-117">Não há o objeto `localStorage`, em vez disso, usa-se o objeto `OfficeRuntime.storage`.</span><span class="sxs-lookup"><span data-stu-id="c275b-117">Does not have `localStorage` object, instead uses the `OfficeRuntime.storage` object.</span></span>     | <span data-ttu-id="c275b-118">Há o objeto `localStorage`, opcionalmente poderá usar o objeto`OfficeRuntime.storage`.</span><span class="sxs-lookup"><span data-stu-id="c275b-118">Has `localStorage` object, can optionally use the `OfficeRuntime.storage` object.</span></span>     |
| <span data-ttu-id="c275b-119">Não suporta a interação com o DOM ou o carregamento de  bibliotecas que dependem do DOM, como jQuery.</span><span class="sxs-lookup"><span data-stu-id="c275b-119">Does not support interacting with the DOM, or loading libraries that depend on the DOM such as jQuery.</span></span>    | <span data-ttu-id="c275b-120">Suporta interação com o DOM e com o carregamento de bibliotecas que dependem do DOM.</span><span class="sxs-lookup"><span data-stu-id="c275b-120">Supports interacting with the DOM and loading libraries that depend on the DOM.</span></span> |

## <a name="browser-engine-runtime"></a><span data-ttu-id="c275b-121">Tempo de execução do mecanismo do navegador</span><span class="sxs-lookup"><span data-stu-id="c275b-121">Browser engine runtime</span></span>

<span data-ttu-id="c275b-122">O painel de tarefas o, suplemento de conteúdo e os comandos são executados em um tempo de execução do mecanismo do navegador.</span><span class="sxs-lookup"><span data-stu-id="c275b-122">The task pane, content add-in, and commands run in a browser engine runtime.</span></span>

<span data-ttu-id="c275b-123">APIs Office.js é compatível com o tempo de execução do mecanismo do navegador.</span><span class="sxs-lookup"><span data-stu-id="c275b-123">The browser engine runtime supports the Office.js APIs.</span></span> <span data-ttu-id="c275b-124">Tenha em mente que qualquer uma das APIs do Excel, assim como APIs que permitem manipular tabelas do Excel, são executadas no tempo de execução do mecanismo do navegador, mas não são acessíveis diretamente do tempo de execução de funções personalizadas.</span><span class="sxs-lookup"><span data-stu-id="c275b-124">Keep in mind that any of the Excel APIs, such as APIs which allow you to manipulate Excel tables, run on the browser engine runtime, but aren't directly accessible from the custom functions runtime.</span></span>

## <a name="communicate-between-runtimes"></a><span data-ttu-id="c275b-125">Comunicar-se entre os tempos de execução</span><span class="sxs-lookup"><span data-stu-id="c275b-125">Communicate between runtimes</span></span>

<span data-ttu-id="c275b-126">O código de funções personalizadas não pode interagir diretamente com o código em outras partes do seu suplemento da web, como o painel de tarefas porque estão em diferentes tempos de execução.</span><span class="sxs-lookup"><span data-stu-id="c275b-126">Your custom functions code cannot directly interact with code in other parts of your web add-in, like the task pane because they are in different runtimes.</span></span> <span data-ttu-id="c275b-127">Mas em alguns cenários, talvez seja necessário compartilhar dados, por exemplo, passando um token.</span><span class="sxs-lookup"><span data-stu-id="c275b-127">But in some scenarios you may need to share data, such as passing a token.</span></span>

<span data-ttu-id="c275b-128">O `OfficeRuntime.storage` pode ser usado para armazenar dados de suas funções personalizadas e para obter dados do seu código do painel de tarefas.</span><span class="sxs-lookup"><span data-stu-id="c275b-128">The `OfficeRuntime.storage` object can be used to store data from your custom functions and get data from your task pane code.</span></span> <span data-ttu-id="c275b-129">Para saber mais sobre como armazenar e compartilhar dados, confira [Salvar e compartilhar estado](custom-functions-save-state.md).</span><span class="sxs-lookup"><span data-stu-id="c275b-129">For more information about storing and sharing data, see [Save and share state](custom-functions-save-state.md).</span></span>

<span data-ttu-id="c275b-130">Você pode ver um exemplo de código usando o objeto `storage` neste [repositório Github](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Excel-custom-functions/AsyncStorage) dedicado para padrões e práticas recomendadas.</span><span class="sxs-lookup"><span data-stu-id="c275b-130">You can see a code sample using the `storage` object in this [Github repository](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Excel-custom-functions/AsyncStorage) dedicated to patterns and practices.</span></span>
<span data-ttu-id="c275b-131">Para saber mais sobre o objeto `storage`, confira [Tempo de execução de funções personalizadas](./custom-functions-runtime.md).</span><span class="sxs-lookup"><span data-stu-id="c275b-131">For more general information about the `storage` object, see [Custom functions runtime](./custom-functions-runtime.md).</span></span>

<span data-ttu-id="c275b-132">O objeto `storage` também pode ser útil para autenticação.</span><span class="sxs-lookup"><span data-stu-id="c275b-132">The `storage` object can also be useful for authentication.</span></span> <span data-ttu-id="c275b-133">Para saber mais, confira [autenticação de funções personalizadas](custom-functions-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="c275b-133">For more information, see [Custom functions authentication](custom-functions-authentication.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="c275b-134">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="c275b-134">Next steps</span></span>
<span data-ttu-id="c275b-135">Saiba mais sobre como [usar o tempo de execução de funções personalizadas](custom-functions-runtime.md)..</span><span class="sxs-lookup"><span data-stu-id="c275b-135">Learn more about how to [use the custom functions runtime](custom-functions-runtime.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="c275b-136">Confira também</span><span class="sxs-lookup"><span data-stu-id="c275b-136">See also</span></span>

* [<span data-ttu-id="c275b-137">Tempo de execução de funções personalizadas do Excel</span><span class="sxs-lookup"><span data-stu-id="c275b-137">Runtime for Excel custom functions</span></span>](custom-functions-runtime.md)
* [<span data-ttu-id="c275b-138">Receber e tratar dados com funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="c275b-138">Receive and handle data with custom functions</span></span>](custom-functions-web-reqs.md)
* [<span data-ttu-id="c275b-139">Metadados de funções personalizadas</span><span class="sxs-lookup"><span data-stu-id="c275b-139">Custom functions metadata</span></span>](custom-functions-json.md)
* [<span data-ttu-id="c275b-140">Tutorial de funções personalizadas do Excel</span><span class="sxs-lookup"><span data-stu-id="c275b-140">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
