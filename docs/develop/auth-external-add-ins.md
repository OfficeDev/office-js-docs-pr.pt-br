---
title: Autorizar serviços externos no seu suplemento do Office
description: Obter autorização para outras fontes de dados além da Microsoft como Google, Facebook, LinkedIn, SalesForce e GitHub, usando o OAuth 2.0, o código de autorização e os fluxos implícitos.
ms.date: 08/07/2019
localization_priority: Normal
ms.openlocfilehash: fd180e11106e7e1e2f20f539746535c4310ad81e
ms.sourcegitcommit: 7ef14753dce598a5804dad8802df7aaafe046da7
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/10/2020
ms.locfileid: "45093739"
---
# <a name="authorize-external-services-in-your-office-add-in"></a><span data-ttu-id="a7799-103">Autorizar serviços externos no seu suplemento do Office</span><span class="sxs-lookup"><span data-stu-id="a7799-103">Authorize external services in your Office Add-in</span></span>

<span data-ttu-id="a7799-104">Popular online services, including Microsoft 365, Google, Facebook, LinkedIn, SalesForce, and GitHub, let developers give users access to their accounts in other applications.</span><span class="sxs-lookup"><span data-stu-id="a7799-104">Popular online services, including Microsoft 365, Google, Facebook, LinkedIn, SalesForce, and GitHub, let developers give users access to their accounts in other applications.</span></span> <span data-ttu-id="a7799-105">This gives you the ability to include these services in your Office Add-in.</span><span class="sxs-lookup"><span data-stu-id="a7799-105">This gives you the ability to include these services in your Office Add-in.</span></span>

> [!NOTE]
> <span data-ttu-id="a7799-106">O restante deste artigo é sobre o acesso a serviços que não são da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="a7799-106">The remainder of this article is about accessing non-Microsoft services.</span></span> <span data-ttu-id="a7799-107">Para obter informações sobre como acessar o Microsoft Graph (incluindo o Microsoft 365), confira [acessar o Microsoft Graph com SSO](overview-authn-authz.md#access-to-microsoft-graph-with-sso) e [acesso ao Microsoft Graph sem SSO](overview-authn-authz.md#access-to-microsoft-graph-without-sso).</span><span class="sxs-lookup"><span data-stu-id="a7799-107">For information about accessing Microsoft Graph (including Microsoft 365), see [Access to Microsoft Graph with SSO](overview-authn-authz.md#access-to-microsoft-graph-with-sso) and [Access to Microsoft Graph without SSO](overview-authn-authz.md#access-to-microsoft-graph-without-sso).</span></span>

<span data-ttu-id="a7799-108">The industry standard framework for enabling web application access to an online service is **OAuth 2.0**.</span><span class="sxs-lookup"><span data-stu-id="a7799-108">The industry standard framework for enabling web application access to an online service is **OAuth 2.0**.</span></span> <span data-ttu-id="a7799-109">In most situations, you don't need to know the details of how the framework works to use it in your add-in.</span><span class="sxs-lookup"><span data-stu-id="a7799-109">In most situations, you don't need to know the details of how the framework works to use it in your add-in.</span></span> <span data-ttu-id="a7799-110">Many libraries are available that simplify the details for you.</span><span class="sxs-lookup"><span data-stu-id="a7799-110">Many libraries are available that simplify the details for you.</span></span>

<span data-ttu-id="a7799-111">Uma ideia fundamental do OAuth é que um aplicativo pode ser uma [entidade de segurança](/windows/security/identity-protection/access-control/security-principals) por si só, assim como um usuário ou um grupo, com sua própria identidade e conjunto de permissões.</span><span class="sxs-lookup"><span data-stu-id="a7799-111">A fundamental idea of OAuth is that an application can be a [security principal](/windows/security/identity-protection/access-control/security-principals) unto itself, just like a user or a group, with its own identity and set of permissions.</span></span> <span data-ttu-id="a7799-112">Nos cenários mais comuns, quando o usuário realiza uma ação no Suplemento do Office que requer o serviço online, o suplemento envia ao serviço uma solicitação para um conjunto específico de permissões para a conta do usuário.</span><span class="sxs-lookup"><span data-stu-id="a7799-112">In the most typical scenarios, when the user takes an action in the Office Add-in that requires the online service, the add-in sends the service a request for a specific set of permissions to the user's account.</span></span> <span data-ttu-id="a7799-113">Em seguida, o serviço solicita que o usuário conceda essas permissões ao suplemento.</span><span class="sxs-lookup"><span data-stu-id="a7799-113">The service then prompts the user to grant the add-in those permissions.</span></span> <span data-ttu-id="a7799-114">Após a concessão das permissões, o serviço envia ao suplemento um pequeno *token de acesso* codificado.</span><span class="sxs-lookup"><span data-stu-id="a7799-114">After the permissions are granted, the service sends the add-in a small encoded *access token*.</span></span> <span data-ttu-id="a7799-115">O suplemento pode usar o serviço, incluindo o token, em todas as suas solicitações para as APIs do serviço.</span><span class="sxs-lookup"><span data-stu-id="a7799-115">The add-in can use the service by including the token in all its requests to the service's APIs.</span></span> <span data-ttu-id="a7799-116">Porém, o suplemento só pode agir dentro das permissões concedidas a ele pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="a7799-116">But the add-in can act only within the permissions that the user granted it.</span></span> <span data-ttu-id="a7799-117">O token também expira após um tempo especificado.</span><span class="sxs-lookup"><span data-stu-id="a7799-117">The token also expires after a specified time.</span></span>

<span data-ttu-id="a7799-118">Vários padrões OAuth, chamados de *fluxos* ou *tipos de concessão*, foram projetados para diferentes cenários.</span><span class="sxs-lookup"><span data-stu-id="a7799-118">Several OAuth patterns, called *flows* or *grant types*, are designed for different scenarios.</span></span> <span data-ttu-id="a7799-119">Os dois padrões a seguir são os mais comumente implementados:</span><span class="sxs-lookup"><span data-stu-id="a7799-119">The following two patterns are the most commonly implemented:</span></span>

- <span data-ttu-id="a7799-120">**Fluxo Implícito**: a comunicação entre o suplemento e o serviço online é implementada com um JavaScript no lado do cliente.</span><span class="sxs-lookup"><span data-stu-id="a7799-120">**Implicit flow**: Communication between the add-in and the online service is implemented with client-side JavaScript.</span></span> <span data-ttu-id="a7799-121">Esse fluxo costuma ser usado em aplicativos página única (SPAs).</span><span class="sxs-lookup"><span data-stu-id="a7799-121">This flow is commonly used in single-page applications (SPAs).</span></span>
- <span data-ttu-id="a7799-122">**Fluxo de Código de Autorização**: A comunicação é *de servidor para servidor* entre o aplicativo Web do seu suplemento e o serviço online.</span><span class="sxs-lookup"><span data-stu-id="a7799-122">**Authorization Code flow**: Communication is *server-to-server* between your add-in's web application and the online service.</span></span> <span data-ttu-id="a7799-123">Portanto, a implementação é feita com código no lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="a7799-123">So, it is implemented with server-side code.</span></span>

<span data-ttu-id="a7799-124">A finalidade de um fluxo OAuth é garantir a identidade e autorização do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a7799-124">The purpose of an OAuth flow is to secure the identity and authorization of the application.</span></span> <span data-ttu-id="a7799-125">No fluxo de Código de Autorização, você recebe um *segredo do cliente* que precisa permanecer oculto.</span><span class="sxs-lookup"><span data-stu-id="a7799-125">In the Authorization Code flow, you're provided a *client secret* that needs to be kept hidden.</span></span> <span data-ttu-id="a7799-126">Um aplicativo que não tem nenhum back-end do lado do servidor, como é o caso de um SPA, não tem como proteger o segredo; por isso recomendamos usar o fluxo Implícito em SPAs.</span><span class="sxs-lookup"><span data-stu-id="a7799-126">An application that has no server-side backend, such as an SPA, has no way to protect the secret, so we recommend that you use the Implicit flow in SPAs.</span></span>

<span data-ttu-id="a7799-127">Você deve estar familiarizado com os prós e os contras do fluxo implícito e o fluxo do código de autorização.</span><span class="sxs-lookup"><span data-stu-id="a7799-127">You should be familiar with the pros and cons of the Implicit flow and the Authorization Code flow.</span></span> <span data-ttu-id="a7799-128">Para obter mais informações sobre esses dois fluxos, consulte [Código de Autorização](https://tools.ietf.org/html/rfc6749#section-1.3.1) e [Implícito](https://tools.ietf.org/html/rfc6749#section-1.3.2).</span><span class="sxs-lookup"><span data-stu-id="a7799-128">For more information about these two flows, see [Authorization Code](https://tools.ietf.org/html/rfc6749#section-1.3.1) and [Implicit](https://tools.ietf.org/html/rfc6749#section-1.3.2).</span></span>

> [!NOTE]
> <span data-ttu-id="a7799-129">You also have the option of using a middleman service to perform authorization and pass the access token to your add-in.</span><span class="sxs-lookup"><span data-stu-id="a7799-129">You also have the option of using a middleman service to perform authorization and pass the access token to your add-in.</span></span> <span data-ttu-id="a7799-130">For details about this scenario, see the **Middleman services** section later in this article.</span><span class="sxs-lookup"><span data-stu-id="a7799-130">For details about this scenario, see the **Middleman services** section later in this article.</span></span>

## <a name="using-the-implicit-flow-in-office-add-ins"></a><span data-ttu-id="a7799-131">Usando o fluxo Implícito em suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="a7799-131">Using the Implicit flow in Office Add-ins</span></span>

<span data-ttu-id="a7799-132">A melhor maneira de descobrir se um serviço online suporta o fluxo implícito é consultar a documentação do serviço.</span><span class="sxs-lookup"><span data-stu-id="a7799-132">The best way to find out if an online service supports the Implicit flow is to consult the service's documentation.</span></span>

<span data-ttu-id="a7799-133">Para obter informações sobre outras bibliotecas que suportam o fluxo implícito, consulte a seção **Bibliotecas** mais adiante neste artigo.</span><span class="sxs-lookup"><span data-stu-id="a7799-133">For information about libraries that support the Implicit flow, see the **Libraries** section later in this article.</span></span>

## <a name="using-the-authorization-code-flow-in-office-add-ins"></a><span data-ttu-id="a7799-134">Usando o fluxo de Código de Autorização em suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="a7799-134">Using the Authorization Code flow in Office Add-ins</span></span>

<span data-ttu-id="a7799-135">Many libraries are available for implementing the Authorization Code flow in various languages and frameworks.</span><span class="sxs-lookup"><span data-stu-id="a7799-135">Many libraries are available for implementing the Authorization Code flow in various languages and frameworks.</span></span> <span data-ttu-id="a7799-136">For more information about some of these libraries, see the **Libraries** section later in this article.</span><span class="sxs-lookup"><span data-stu-id="a7799-136">For more information about some of these libraries, see the **Libraries** section later in this article.</span></span>

## <a name="libraries"></a><span data-ttu-id="a7799-137">Bibliotecas</span><span class="sxs-lookup"><span data-stu-id="a7799-137">Libraries</span></span>

<span data-ttu-id="a7799-138">Libraries are available for many languages and platforms, for both the Implicit flow and the Authorization Code flow.</span><span class="sxs-lookup"><span data-stu-id="a7799-138">Libraries are available for many languages and platforms, for both the Implicit flow and the Authorization Code flow.</span></span> <span data-ttu-id="a7799-139">Some libraries are general purpose, while others are for specific online services.</span><span class="sxs-lookup"><span data-stu-id="a7799-139">Some libraries are general purpose, while others are for specific online services.</span></span>

<span data-ttu-id="a7799-140">**Google**: Search [GitHub.com/Google](https://github.com/google) for "auth" or the name of your language.</span><span class="sxs-lookup"><span data-stu-id="a7799-140">**Google**: Search [GitHub.com/Google](https://github.com/google) for "auth" or the name of your language.</span></span> <span data-ttu-id="a7799-141">Most of the relevant repos are named `google-auth-library-[name of language]`.</span><span class="sxs-lookup"><span data-stu-id="a7799-141">Most of the relevant repos are named `google-auth-library-[name of language]`.</span></span>

<span data-ttu-id="a7799-142">**Facebook**: Pesquise "library" ou "sdk" no [Facebook para Desenvolvedores](https://developers.facebook.com).</span><span class="sxs-lookup"><span data-stu-id="a7799-142">**Facebook**: Search [Facebook for Developers](https://developers.facebook.com) for "library" or "sdk".</span></span>

<span data-ttu-id="a7799-143">**General OAuth 2.0**: A page of links to libraries for over a dozen languages is maintained by the IETF OAuth Working Group at: [OAuth Code](https://oauth.net/code/).</span><span class="sxs-lookup"><span data-stu-id="a7799-143">**General OAuth 2.0**: A page of links to libraries for over a dozen languages is maintained by the IETF OAuth Working Group at: [OAuth Code](https://oauth.net/code/).</span></span> <span data-ttu-id="a7799-144">Note that some of these libraries are for implementing an OAuth compliant service.</span><span class="sxs-lookup"><span data-stu-id="a7799-144">Note that some of these libraries are for implementing an OAuth compliant service.</span></span> <span data-ttu-id="a7799-145">The libraries of interest to you as a an add-in developer are called *client* libraries on this page because your web server is a client of the OAuth compliant service.</span><span class="sxs-lookup"><span data-stu-id="a7799-145">The libraries of interest to you as a an add-in developer are called *client* libraries on this page because your web server is a client of the OAuth compliant service.</span></span>

## <a name="middleman-services"></a><span data-ttu-id="a7799-146">Serviços intermediários</span><span class="sxs-lookup"><span data-stu-id="a7799-146">Middleman services</span></span>

<span data-ttu-id="a7799-147">Your add-in can use a middleman service such as [OAuth.io](https://oauth.io) or [Auth0](https://auth0.com) to perform authorization.</span><span class="sxs-lookup"><span data-stu-id="a7799-147">Your add-in can use a middleman service such as [OAuth.io](https://oauth.io) or [Auth0](https://auth0.com) to perform authorization.</span></span> <span data-ttu-id="a7799-148">A middleman service may either provide access tokens for popular online services or simplify the process of enabling social login for your add-in, or both.</span><span class="sxs-lookup"><span data-stu-id="a7799-148">A middleman service may either provide access tokens for popular online services or simplify the process of enabling social login for your add-in, or both.</span></span> <span data-ttu-id="a7799-149">With very little code, your add-in can use either client-side script or server-side code to connect to the middleman service and it will send your add-in any required tokens for the online service.</span><span class="sxs-lookup"><span data-stu-id="a7799-149">With very little code, your add-in can use either client-side script or server-side code to connect to the middleman service and it will send your add-in any required tokens for the online service.</span></span> <span data-ttu-id="a7799-150">All of the authorization implementation code is in the middleman service.</span><span class="sxs-lookup"><span data-stu-id="a7799-150">All of the authorization implementation code is in the middleman service.</span></span> 

<span data-ttu-id="a7799-151">É recomendável que a interface do usuário de autenticação/autorização no suplemento usar nossos APIs de caixa de diálogo para abrir uma página de logon.</span><span class="sxs-lookup"><span data-stu-id="a7799-151">We recommend that the UI for authentication/authorization in your add-in use our Dialog APIs to open a login page.</span></span> <span data-ttu-id="a7799-152">Ver [usar as APIs REST de caixa de diálogo em um fluxo de autenticação](dialog-api-in-office-add-ins.md#use-the-dialog-apis-in-an-authentication-flow) para saber mais.</span><span class="sxs-lookup"><span data-stu-id="a7799-152">See [Use the Dialog APIs in an authentication flow](dialog-api-in-office-add-ins.md#use-the-dialog-apis-in-an-authentication-flow) for more information.</span></span> <span data-ttu-id="a7799-153">Quando você abre uma caixa de diálogo do Office dessa forma, a caixa de diálogo tem uma instância totalmente nova e separada do navegador e mecanismo JavaScript da instância na página pai (por exemplo, painel de tarefas do suplemento ou FunctionFile).</span><span class="sxs-lookup"><span data-stu-id="a7799-153">When you open an Office dialog in this way, the dialog has a completely new and separate instance of the browser and JavaScript engine from the instance in the parent page (e.g., the add-in's task pane or FunctionFile).</span></span> <span data-ttu-id="a7799-154">Um token e outras informações que podem ser convertidas em uma cadeia de caracteres é passado para o pai usando uma chamada de API `messageParent`.</span><span class="sxs-lookup"><span data-stu-id="a7799-154">A token, and any other information that can be converted to a string, is passed back to the parent using an API called `messageParent`.</span></span> <span data-ttu-id="a7799-155">Página pai, em seguida, pode usar o token para fazer chamadas autorizadas ao recurso.</span><span class="sxs-lookup"><span data-stu-id="a7799-155">The parent page can then use the token to make authorized calls to the resource.</span></span> <span data-ttu-id="a7799-156">Devido à arquitetura, tenha cuidado como usar as APIs REST fornecidas pelo serviço de intermediário.</span><span class="sxs-lookup"><span data-stu-id="a7799-156">Because of this architecture, you must be careful how you use the APIs provided by a middleman service.</span></span> <span data-ttu-id="a7799-157">Muitas vezes o serviço fornecerá uma configuração API no qual o código cria algum tipo de objeto contexto que é um token e o utiliza para fazer chamadas subsequentes ao recurso.</span><span class="sxs-lookup"><span data-stu-id="a7799-157">Often the service will provide an API set in which your code creates some kind of context object which both gets a token and uses that token in making subsequent calls to the resource.</span></span> <span data-ttu-id="a7799-158">Muitas vezes o serviço fornece um método de API único que faz a chamada inicial *e* cria objeto contexto.</span><span class="sxs-lookup"><span data-stu-id="a7799-158">Often the service has a single API method that makes the initial call *and* creates the context object.</span></span> <span data-ttu-id="a7799-159">Um objeto assim não pode ser stringificado completamente, para que não possam ser passado de caixa de diálogo Office para a página de pai.</span><span class="sxs-lookup"><span data-stu-id="a7799-159">An object like this cannot be completely stringified, so it cannot be passed from the Office dialog to the parent page.</span></span> <span data-ttu-id="a7799-160">Normalmente, o serviço intermediário fornece um segundo conjunto de API um nível inferior de abstração, como uma API REST.</span><span class="sxs-lookup"><span data-stu-id="a7799-160">Typically, the middleman service provides a second API set, at a lower level of abstraction, such as a REST API.</span></span> <span data-ttu-id="a7799-161">Este segundo conjunto tem um API que recebe um token do serviço e outras APIs que passam o token para o serviço ao usa-lo para obter acesso autorizado ao recurso.</span><span class="sxs-lookup"><span data-stu-id="a7799-161">This second set will have an API that gets a token from the service, and other APIs that pass the token to service when using it to get authorized access to the resource.</span></span> <span data-ttu-id="a7799-162">Precisa trabalhar com uma API neste nível inferior de abstração para que você possa obter o token na caixa de diálogo do Office e, em seguida, usar `messageParent` para passar para a página de pai.</span><span class="sxs-lookup"><span data-stu-id="a7799-162">You need to work with an API at this lower level of abstraction so that you can get the token in the Office dialog and then use `messageParent` to pass it to the parent page.</span></span> 

## <a name="what-is-cors"></a><span data-ttu-id="a7799-163">O que é CORS?</span><span class="sxs-lookup"><span data-stu-id="a7799-163">What is CORS?</span></span>

<span data-ttu-id="a7799-164">CORS stands for [Cross Origin Resource Sharing](https://developer.mozilla.org/docs/Web/HTTP/Access_control_CORS).</span><span class="sxs-lookup"><span data-stu-id="a7799-164">CORS stands for [Cross Origin Resource Sharing](https://developer.mozilla.org/docs/Web/HTTP/Access_control_CORS).</span></span> <span data-ttu-id="a7799-165">For information about how to use CORS inside add-ins, see [Addressing same-origin policy limitations in Office Add-ins](addressing-same-origin-policy-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="a7799-165">For information about how to use CORS inside add-ins, see [Addressing same-origin policy limitations in Office Add-ins](addressing-same-origin-policy-limitations.md).</span></span>
