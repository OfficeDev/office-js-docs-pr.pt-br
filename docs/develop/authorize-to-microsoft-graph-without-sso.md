---
title: Autorizar o Microsoft Graph sem SSO
description: ''
ms.date: 08/07/2019
localization_priority: Priority
ms.openlocfilehash: 9636077553904e7250cf1d6dc740febe9eac61e2
ms.sourcegitcommit: 24303ca235ebd7144a1d913511d8e4fb7c0e8c0d
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/11/2019
ms.locfileid: "36838484"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="930a8-102">Autorizar o Microsoft Graph sem SSO</span><span class="sxs-lookup"><span data-stu-id="930a8-102">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="930a8-103">Você pode conseguir autorização para o seu suplemento acessar os dados do Microsoft Graph obtendo um token de acesso ao Graph a partir do Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="930a8-103">You can get authorization to Microsoft Graph data for your add-in by obtaining an access token to Graph from Azure Active Directory (AAD).</span></span> <span data-ttu-id="930a8-104">Você faz isso usando o fluxo de código de autorização ou fluxo implícito da mesma forma que faria em qualquer outro aplicativo Web com uma exceção: o AAD não permite que sua página de logon seja aberta em um iframe.</span><span class="sxs-lookup"><span data-stu-id="930a8-104">You do this using either the Authorization Code flow or the Implicit Flow just as you would any in any other web application with one exception: AAD does not allow its login page to open in an iframe.</span></span> <span data-ttu-id="930a8-105">Quando um suplemento do Office está sendo executado no *Office na Web*, o painel de tarefas é um iframe.</span><span class="sxs-lookup"><span data-stu-id="930a8-105">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="930a8-106">Isso significa que você precisará abrir a tela de logon do AAD em uma caixa de diálogo aberta com a API de diálogo do Office.</span><span class="sxs-lookup"><span data-stu-id="930a8-106">This means that you will need to open the AAD login screen in a dialog opened with the Office Dialog API.</span></span> <span data-ttu-id="930a8-107">Isso afetará a maneira como você usa as bibliotecas auxiliares de autenticação e autorização.</span><span class="sxs-lookup"><span data-stu-id="930a8-107">This will effect how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="930a8-108">Para saber mais, confira [Autenticação com a API de diálogo do Office](auth-with-office-dialog-api.md).</span><span class="sxs-lookup"><span data-stu-id="930a8-108">For more information, see [Authentication with the Office Dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="930a8-109">Para obter informações sobre a autenticação de programação com o AAD, comece com [Visão geral da plataforma de Identidade da Microsoft (v 2.0)](/azure/active-directory/develop/v2-overview).</span><span class="sxs-lookup"><span data-stu-id="930a8-109">For information about programming authentication with AAD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview).</span></span> <span data-ttu-id="930a8-110">Há muitos tutoriais e guias nesse conjunto de documentos, bem como links para exemplos relevantes.</span><span class="sxs-lookup"><span data-stu-id="930a8-110">There are many tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="930a8-111">Uma vez mais para não esquecer: Talvez seja necessário ajustar o código nos exemplos para execução na caixa de diálogo do Office pois devemos levar em consideração o fato de que a caixa de diálogo é executada em um processo separado do painel de tarefas.</span><span class="sxs-lookup"><span data-stu-id="930a8-111">Once again a reminder: you may need to adjust the code in the samples to run in the Office Dialog to account for the fact that the Dialog runs in a separate process from the task pane.</span></span>

<span data-ttu-id="930a8-112">Após o seu código obter o token de acesso para o Microsoft Graph, ele passa o token de acesso da caixa de diálogo para o painel de tarefas, ou armazena o token em um banco de dados e sinaliza o painel de tarefas no qual o token está disponível.</span><span class="sxs-lookup"><span data-stu-id="930a8-112">After your code has obtained the access token to Microsoft Graph, either it passes the access token from the dialog to the task pane, or it stores the token in a database and signals the task pane that the token is available there.</span></span> <span data-ttu-id="930a8-113">(Confira [autenticação com a API de caixa de diálogo do Office](auth-with-office-dialog-api.md) para obter mais detalhes). O código no painel de tarefas solicita dados do Microsoft Graph e inclui o token nestas solicitações.</span><span class="sxs-lookup"><span data-stu-id="930a8-113">(See [Authentication with the Office Dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Microsoft Graph, and includes the token in those requests.</span></span> <span data-ttu-id="930a8-114">Para obter mais informações sobre como chamar o Microsoft Graph e os SDKs para Microsoft Graph, confira a[ documentação do Microsoft Graph](/graph/).</span><span class="sxs-lookup"><span data-stu-id="930a8-114">For more information about calling Microsoft Graph and the SDKs for Microsoft Graph, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="930a8-115">Bibliotecas e exemplos recomendados</span><span class="sxs-lookup"><span data-stu-id="930a8-115">Recommended libraries and samples</span></span>

<span data-ttu-id="930a8-116">Recomendamos que você use as seguintes bibliotecas ao acessar o Microsoft Graph sem usar o SSO:</span><span class="sxs-lookup"><span data-stu-id="930a8-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="930a8-117">Para suplementos usando um lado do servidor com uma Estrutura baseada em rede, como o .NET Core ou o ASP.NET, use o[MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span><span class="sxs-lookup"><span data-stu-id="930a8-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="930a8-118">Para suplementos usando um servidor baseado em NodeJS, use o[Passaport Azure AD.](https://github.com/AzureAD/passport-azure-ad)</span><span class="sxs-lookup"><span data-stu-id="930a8-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="930a8-119">Para suplementos usando o fluxo implícito, use [MSAL. js.](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki)</span><span class="sxs-lookup"><span data-stu-id="930a8-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="930a8-120">Para obter mais informações sobre as bibliotecas recomendadas para trabalhar com a plataforma de identidade da Microsoft (o antigo AAD v.2.0), confira[bibliotecas de autenticação da plataforma de identidade da Microsoft](/azure/active-directory/develop/reference-v2-libraries).</span><span class="sxs-lookup"><span data-stu-id="930a8-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="930a8-121">Os exemplos a seguir recebem dados do Microsoft Graph de um suplemento do Office:</span><span class="sxs-lookup"><span data-stu-id="930a8-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="930a8-122">Suplemento do Office Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="930a8-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/office-add-in-microsoft-graph-aspnet)
- [<span data-ttu-id="930a8-123">Suplemento do Outlook Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="930a8-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/outlook-add-in-microsoft-graph-aspnet)

