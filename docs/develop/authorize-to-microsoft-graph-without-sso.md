---
title: Autorizar o Microsoft Graph sem SSO
description: Saiba como autorizar o Microsoft Graph sem SSO
ms.date: 01/29/2020
localization_priority: Priority
ms.openlocfilehash: a7dbd1fdd85852a82fcb00050283fece84a04e04
ms.sourcegitcommit: 4c9e02dac6f8030efc7415e699370753ec9415c8
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/01/2020
ms.locfileid: "41649967"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="a510b-103">Autorizar o Microsoft Graph sem SSO</span><span class="sxs-lookup"><span data-stu-id="a510b-103">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="a510b-104">Seu suplemento pode obter autorização para acessar os dados do Microsoft Graph obtendo um token de acesso ao Graph a partir do Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="a510b-104">Your add-in can get authorization to Microsoft Graph data by obtaining an access token to Graph from Azure Active Directory (AAD).</span></span> <span data-ttu-id="a510b-105">Use o fluxo de código de autorização ou fluxo implícito da mesma forma que faria em qualquer outro aplicativo Web que sua página de logon seja aberta em um iframe.</span><span class="sxs-lookup"><span data-stu-id="a510b-105">Use either the Authorization Code flow or the Implicit flow just as you would in other web applications but with one exception: AAD does not allow its login page to open in an iframe.</span></span> <span data-ttu-id="a510b-106">Quando um suplemento do Office está sendo executado no *Office na Web*, o painel de tarefas é um iframe.</span><span class="sxs-lookup"><span data-stu-id="a510b-106">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="a510b-107">Isso significa que será necessário abrir a tela de logon do AAD em uma caixa de diálogo aberta com a API de Diálogo do Office.</span><span class="sxs-lookup"><span data-stu-id="a510b-107">This means you'll need to open the AAD login screen in a dialog box opened with the Office dialog API.</span></span> <span data-ttu-id="a510b-108">Isso afeta a maneira como você usa as bibliotecas auxiliares de autenticação e autorização.</span><span class="sxs-lookup"><span data-stu-id="a510b-108">This affects how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="a510b-109">Para saber mais, confira [Autenticação com a API de Diálogo do Office](auth-with-office-dialog-api.md).</span><span class="sxs-lookup"><span data-stu-id="a510b-109">For more information, see [Authentication with the Office dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="a510b-110">Para obter informações sobre autenticação de programação com o AAD, comece por [visão geral do Microsoft Identity Platform (v 2.0)](/azure/active-directory/develop/v2-overview), onde você encontrará tutoriais e guias nesse conjunto de documentos, bem como links para exemplos relevantes.</span><span class="sxs-lookup"><span data-stu-id="a510b-110">For information about programming authentication with AAD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview), where you'll find tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="a510b-111">Novamente, talvez seja necessário ajustar o código nos exemplos para execução na caixa de diálogo do Office pois devemos levar em consideração o fato de que a caixa de diálogo do Office é executada em um processo separado do painel de tarefas.</span><span class="sxs-lookup"><span data-stu-id="a510b-111">Once again, you may need to adjust the code in the samples to run in the Office dialog box to account for the fact that the Office dialog box runs in a separate process from the task pane.</span></span>

<span data-ttu-id="a510b-112">Após o seu código obter o token de acesso para o Microsoft Graph, ele passa o token de acesso da caixa de diálogo para o painel de tarefas, ou armazena o token em um banco de dados e sinaliza o painel de tarefas no qual o token está disponível.</span><span class="sxs-lookup"><span data-stu-id="a510b-112">After your code obtains the access token to Graph, either it passes the access token from the dialog box to the task pane, or it stores the token in a database and signals the task pane that the token is available.</span></span> <span data-ttu-id="a510b-113">(Confira [autenticação com a API de caixa de diálogo do Office](auth-with-office-dialog-api.md) para obter mais detalhes). O código no painel de tarefas solicita dados do Microsoft Graph e inclui o token nestas solicitações.</span><span class="sxs-lookup"><span data-stu-id="a510b-113">(See [Authentication with the Office dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Graph, and includes the token in those requests.</span></span> <span data-ttu-id="a510b-114">Para obter mais informações sobre como chamar o Microsoft Graph e os SDKs para Microsoft Graph, confira a[ documentação do Microsoft Graph](/graph/).</span><span class="sxs-lookup"><span data-stu-id="a510b-114">For more information about calling Graph and the Graph SDKs, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="a510b-115">Bibliotecas e exemplos recomendados</span><span class="sxs-lookup"><span data-stu-id="a510b-115">Recommended libraries and samples</span></span>

<span data-ttu-id="a510b-116">Recomendamos que você use as seguintes bibliotecas ao acessar o Microsoft Graph sem usar o SSO:</span><span class="sxs-lookup"><span data-stu-id="a510b-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="a510b-117">Para suplementos usando um lado do servidor com uma Estrutura baseada em rede, como o .NET Core ou o ASP.NET, use o[MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span><span class="sxs-lookup"><span data-stu-id="a510b-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="a510b-118">Para suplementos usando um servidor baseado em NodeJS, use o[Passaport Azure AD.](https://github.com/AzureAD/passport-azure-ad)</span><span class="sxs-lookup"><span data-stu-id="a510b-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="a510b-119">Para suplementos usando o fluxo implícito, use [MSAL. js.](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki)</span><span class="sxs-lookup"><span data-stu-id="a510b-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="a510b-120">Para obter mais informações sobre as bibliotecas recomendadas para trabalhar com a plataforma de identidade da Microsoft (o antigo AAD v.2.0), confira[bibliotecas de autenticação da plataforma de identidade da Microsoft](/azure/active-directory/develop/reference-v2-libraries).</span><span class="sxs-lookup"><span data-stu-id="a510b-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="a510b-121">Os exemplos a seguir recebem dados do Microsoft Graph de um suplemento do Office:</span><span class="sxs-lookup"><span data-stu-id="a510b-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="a510b-122">Suplemento do Office Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="a510b-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="a510b-123">Suplemento do Outlook Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="a510b-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Outlook-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="a510b-124">Suplemento do Office Microsoft Graph React</span><span class="sxs-lookup"><span data-stu-id="a510b-124">Office Add-in Microsoft Graph React</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-React)
