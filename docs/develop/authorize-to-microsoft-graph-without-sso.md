---
title: Autorizar o Microsoft Graph sem SSO
description: Saiba como autorizar o Microsoft Graph sem SSO
ms.date: 01/29/2020
localization_priority: Normal
ms.openlocfilehash: 99d300d0155ba9a117efda5d31ef068a41eb86a9
ms.sourcegitcommit: 8546889a759590c3798ce56e311d9e46f0171413
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/04/2021
ms.locfileid: "50104830"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="79ff4-103">Autorizar o Microsoft Graph sem SSO</span><span class="sxs-lookup"><span data-stu-id="79ff4-103">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="79ff4-104">Seu complemento pode obter autorização para dados do Microsoft Graph obtendo um token de acesso para o Microsoft Graph do Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="79ff4-104">Your add-in can get authorization to Microsoft Graph data by obtaining an access token to Microsoft Graph from Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="79ff4-105">Use o fluxo de Código de Autorização ou o fluxo Implícito da mesma forma que faria em outros aplicativos Web, mas com uma exceção: o Azure AD não permite que sua página de entrada seja aberta em um iframe.</span><span class="sxs-lookup"><span data-stu-id="79ff4-105">Use either the Authorization Code flow or the Implicit flow just as you would in other web applications but with one exception: Azure AD does not allow its sign in page to open in an iframe.</span></span> <span data-ttu-id="79ff4-106">Quando um suplemento do Office está sendo executado no *Office na Web*, o painel de tarefas é um iframe.</span><span class="sxs-lookup"><span data-stu-id="79ff4-106">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="79ff4-107">Isso significa que você precisará abrir a tela de logon do Azure AD em uma caixa de diálogo aberta com a API de diálogo do Office.</span><span class="sxs-lookup"><span data-stu-id="79ff4-107">This means you'll need to open the Azure AD login screen in a dialog box opened with the Office dialog API.</span></span> <span data-ttu-id="79ff4-108">Isso afeta a maneira como você usa as bibliotecas auxiliares de autenticação e autorização.</span><span class="sxs-lookup"><span data-stu-id="79ff4-108">This affects how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="79ff4-109">Para saber mais, confira [Autenticação com a API de Diálogo do Office](auth-with-office-dialog-api.md).</span><span class="sxs-lookup"><span data-stu-id="79ff4-109">For more information, see [Authentication with the Office dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="79ff4-110">Para obter informações sobre a autenticação de programação com o Azure AD, comece com a visão geral da [Microsoft Identity Platform (v2.0),](/azure/active-directory/develop/v2-overview)onde você encontrará tutoriais e guias nesse conjunto de documentação, bem como links para exemplos relevantes.</span><span class="sxs-lookup"><span data-stu-id="79ff4-110">For information about programming authentication with Azure AD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview), where you'll find tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="79ff4-111">Novamente, talvez seja necessário ajustar o código nos exemplos para execução na caixa de diálogo do Office pois devemos levar em consideração o fato de que a caixa de diálogo do Office é executada em um processo separado do painel de tarefas.</span><span class="sxs-lookup"><span data-stu-id="79ff4-111">Once again, you may need to adjust the code in the samples to run in the Office dialog box to account for the fact that the Office dialog box runs in a separate process from the task pane.</span></span>

<span data-ttu-id="79ff4-112">Depois que seu código obtém o token de acesso para o Microsoft Graph, ele passa o token de acesso da caixa de diálogo para o painel de tarefas ou armazena o token em um banco de dados e sinaliza o painel de tarefas em que o token está disponível.</span><span class="sxs-lookup"><span data-stu-id="79ff4-112">After your code obtains the access token to Microsoft Graph, either it passes the access token from the dialog box to the task pane, or it stores the token in a database and signals the task pane that the token is available.</span></span> <span data-ttu-id="79ff4-113">(Consulte [Autenticação com a API de caixa de diálogo do Office](auth-with-office-dialog-api.md) para obter detalhes.) O código no painel de tarefas solicita dados do Microsoft Graph e inclui o token nessas solicitações.</span><span class="sxs-lookup"><span data-stu-id="79ff4-113">(See [Authentication with the Office dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Microsoft Graph, and includes the token in those requests.</span></span> <span data-ttu-id="79ff4-114">Para obter mais informações sobre como chamar o Microsoft Graph e os SDKs do Microsoft Graph, consulte a [documentação do Microsoft Graph.](/graph/)</span><span class="sxs-lookup"><span data-stu-id="79ff4-114">For more information about calling Microsoft Graph and the Microsoft Graph SDKs, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="79ff4-115">Bibliotecas e exemplos recomendados</span><span class="sxs-lookup"><span data-stu-id="79ff4-115">Recommended libraries and samples</span></span>

<span data-ttu-id="79ff4-116">Recomendamos que você use as seguintes bibliotecas ao acessar o Microsoft Graph sem usar o SSO:</span><span class="sxs-lookup"><span data-stu-id="79ff4-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="79ff4-117">Para suplementos usando um lado do servidor com uma Estrutura baseada em rede, como o .NET Core ou o ASP.NET, use o[MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span><span class="sxs-lookup"><span data-stu-id="79ff4-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="79ff4-118">Para suplementos usando um servidor baseado em NodeJS, use o[Passaport Azure AD.](https://github.com/AzureAD/passport-azure-ad)</span><span class="sxs-lookup"><span data-stu-id="79ff4-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="79ff4-119">Para suplementos usando o fluxo implícito, use [MSAL. js.](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki)</span><span class="sxs-lookup"><span data-stu-id="79ff4-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="79ff4-120">Para obter mais informações sobre as bibliotecas recomendadas para trabalhar com a plataforma de identidade da Microsoft (o antigo AAD v.2.0), confira[bibliotecas de autenticação da plataforma de identidade da Microsoft](/azure/active-directory/develop/reference-v2-libraries).</span><span class="sxs-lookup"><span data-stu-id="79ff4-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="79ff4-121">Os exemplos a seguir recebem dados do Microsoft Graph de um suplemento do Office:</span><span class="sxs-lookup"><span data-stu-id="79ff4-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="79ff4-122">Suplemento do Office Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="79ff4-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="79ff4-123">Suplemento do Outlook Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="79ff4-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Outlook-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="79ff4-124">Suplemento do Office Microsoft Graph React</span><span class="sxs-lookup"><span data-stu-id="79ff4-124">Office Add-in Microsoft Graph React</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-React)
