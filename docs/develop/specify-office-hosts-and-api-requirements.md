---
title: Especificar hosts do Office e requisitos de API
description: Saiba como especificar Office aplicativos e requisitos de API para que o seu complemento funcione conforme esperado.
ms.date: 05/04/2021
localization_priority: Normal
ms.openlocfilehash: dad4a562c523291d7af3c975c89111fab410220c
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/23/2021
ms.locfileid: "53075961"
---
# <a name="specify-office-applications-and-api-requirements"></a><span data-ttu-id="0039d-103">Especificar requisitos da API e de aplicativos do Office</span><span class="sxs-lookup"><span data-stu-id="0039d-103">Specify Office applications and API requirements</span></span>

<span data-ttu-id="0039d-104">O Office do seu Office pode depender de um aplicativo Office específico, um conjunto de requisitos, um membro da API ou uma versão da API para funcionar conforme o esperado.</span><span class="sxs-lookup"><span data-stu-id="0039d-104">Your Office Add-in might depend on a specific Office application, a requirement set, an API member, or a version of the API in order to work as expected.</span></span> <span data-ttu-id="0039d-105">Por exemplo, o suplemento pode:</span><span class="sxs-lookup"><span data-stu-id="0039d-105">For example, your add-in might:</span></span>

- <span data-ttu-id="0039d-106">Executar em um único aplicativo do Office (por exemplo, Word ou Excel) ou diversos aplicativos.</span><span class="sxs-lookup"><span data-stu-id="0039d-106">Run in a single Office application (e.g., Word or Excel), or several applications.</span></span>

- <span data-ttu-id="0039d-p102">Usar as APIs de JavaScript que estão disponíveis apenas em algumas versões do Office. Por exemplo, você pode usar as APIs JavaScript do Excel em um suplemento executado no Excel 2016.</span><span class="sxs-lookup"><span data-stu-id="0039d-p102">Make use of JavaScript APIs that are only available in some versions of Office. For example, you might use the Excel JavaScript APIs in an add-in that runs in Excel 2016.</span></span>

- <span data-ttu-id="0039d-109">Executar apenas nas versões do Office que oferecem suporte a membros da API que seu suplemento usa.</span><span class="sxs-lookup"><span data-stu-id="0039d-109">Run only in versions of Office that support API members that your add-in uses.</span></span>

<span data-ttu-id="0039d-110">Este artigo ajuda você a entender quais opções você deve escolher para garantir que seu suplemento funcione conforme o esperado e atinja o público mais amplo possível.</span><span class="sxs-lookup"><span data-stu-id="0039d-110">This article helps you understand which options you should choose to ensure that your add-in works as expected and reaches the broadest audience possible.</span></span>

> [!NOTE]
> <span data-ttu-id="0039d-111">Para uma exibição de alto nível de onde os Office de Office atualmente são suportados, consulte Office disponibilidade de aplicativos cliente e plataforma para Office [de Office Desempate.](../overview/office-add-in-availability.md)</span><span class="sxs-lookup"><span data-stu-id="0039d-111">For a high-level view of where Office Add-ins are currently supported, see the [Office client application and platform availability for Office Add-ins](../overview/office-add-in-availability.md) page.</span></span>

<span data-ttu-id="0039d-112">A tabela a seguir lista os principais conceitos discutidos neste artigo.</span><span class="sxs-lookup"><span data-stu-id="0039d-112">The following table lists core concepts discussed throughout this article.</span></span>

|<span data-ttu-id="0039d-113">**Conceito**</span><span class="sxs-lookup"><span data-stu-id="0039d-113">**Concept**</span></span>|<span data-ttu-id="0039d-114">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="0039d-114">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="0039d-115">Office aplicativo, Office cliente</span><span class="sxs-lookup"><span data-stu-id="0039d-115">Office application, Office client application</span></span>|<span data-ttu-id="0039d-p103">O aplicativo do Office usado para executar seu suplemento. Por exemplo, Word e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="0039d-p103">The Office application used to run your add-in. For example, Word, Excel, and so on.</span></span>|
|<span data-ttu-id="0039d-118">Plataforma</span><span class="sxs-lookup"><span data-stu-id="0039d-118">Platform</span></span>|<span data-ttu-id="0039d-119">Onde o Office é executado, como em um navegador ou em um iPad.</span><span class="sxs-lookup"><span data-stu-id="0039d-119">Where the Office application runs, such as in a browser or on an iPad.</span></span>|
|<span data-ttu-id="0039d-120">Conjunto de requisitos</span><span class="sxs-lookup"><span data-stu-id="0039d-120">Requirement set</span></span>|<span data-ttu-id="0039d-121">Um grupo nomeado de membros relacionados da API.</span><span class="sxs-lookup"><span data-stu-id="0039d-121">A named group of related API members.</span></span> <span data-ttu-id="0039d-122">Os complementos usam conjuntos de requisitos para determinar se o aplicativo Office oferece suporte a membros da API usados pelo seu complemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-122">Add-ins use requirement sets to determine whether the Office application supports API members used by your add-in.</span></span> <span data-ttu-id="0039d-123">É mais fácil testar se há suporte para um conjunto de requisitos do que o suporte para membros individuais da API.</span><span class="sxs-lookup"><span data-stu-id="0039d-123">It's easier to test for the support of a requirement set than for the support of individual API members.</span></span> <span data-ttu-id="0039d-124">O suporte ao conjunto de requisitos varia Office aplicativo e a versão do Office aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0039d-124">Requirement set support varies by Office application and the version of the Office application.</span></span> <br ><span data-ttu-id="0039d-125">Conjuntos de requisitos são especificados no arquivo de manifesto.</span><span class="sxs-lookup"><span data-stu-id="0039d-125">Requirement sets are specified in the manifest file.</span></span> <span data-ttu-id="0039d-126">Quando você especifica conjuntos de requisitos no manifesto, define o nível mínimo de suporte à API que o aplicativo Office deve fornecer para executar o seu complemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-126">When you specify requirement sets in the manifest, you set the minimum level of API support that the Office application must provide in order to run your add-in.</span></span> <span data-ttu-id="0039d-127">Office aplicativos que não suportam conjuntos de <span class="ui">requisitos especificados</span>no manifesto não podem executar o seu complemento, e o seu complemento não será exibido em Meus Complementos . Isso restringe onde o seu complemento está disponível.</span><span class="sxs-lookup"><span data-stu-id="0039d-127">Office applications that don't support requirement sets specified in the manifest can't run your add-in, and your add-in won't display in <span class="ui">My Add-ins</span>. This restricts where your add-in is available.</span></span> <span data-ttu-id="0039d-128">No código usando verificações de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="0039d-128">In code using runtime checks.</span></span> <span data-ttu-id="0039d-129">Para obter uma lista completa de conjuntos de requisitos, confira [Conjuntos de requisitos de Suplemento do Office](../reference/requirement-sets/office-add-in-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="0039d-129">For the complete list of requirement sets, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span></span>|
|<span data-ttu-id="0039d-130">Verificação no tempo de execução</span><span class="sxs-lookup"><span data-stu-id="0039d-130">Runtime check</span></span>|<span data-ttu-id="0039d-131">Um teste que é executado em tempo de execução para determinar se o aplicativo Office executando seu complemento oferece suporte a conjuntos de requisitos ou métodos usados pelo seu complemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-131">A test that is performed at runtime to determine whether the Office application running your add-in supports requirement sets or methods used by your add-in.</span></span> <span data-ttu-id="0039d-132">Para executar uma verificação de tempo de execução, use uma instrução **if** com o método, os conjuntos de requisitos ou os nomes de método que não fazem parte de `isSetSupported` um conjunto de requisitos.</span><span class="sxs-lookup"><span data-stu-id="0039d-132">To perform a runtime check, you use an **if** statement with the `isSetSupported` method, the requirement sets, or the method names that aren't part of a requirement set.</span></span> <span data-ttu-id="0039d-133">Use as verificações no tempo de execução para garantir que seu suplemento alcance o maior número de clientes.</span><span class="sxs-lookup"><span data-stu-id="0039d-133">Use runtime checks to ensure that your add-in reaches the broadest number of customers.</span></span> <span data-ttu-id="0039d-134">Ao contrário dos conjuntos de requisitos, as verificações de tempo de execução não especificam o nível mínimo de suporte à API que o Office aplicativo deve fornecer para o seu complemento ser executado.</span><span class="sxs-lookup"><span data-stu-id="0039d-134">Unlike requirement sets, runtime checks don't specify the minimum level of API support that the Office application must provide for your add-in to run.</span></span> <span data-ttu-id="0039d-135">Em vez disso, use a **instrução if** para determinar se um membro da API tem suporte.</span><span class="sxs-lookup"><span data-stu-id="0039d-135">Instead, you use the **if** statement to determine whether an API member is supported.</span></span> <span data-ttu-id="0039d-136">Se houver, você poderá proporcionar mais funcionalidade em seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-136">If it is, you can provide additional functionality in your add-in.</span></span> <span data-ttu-id="0039d-137">Seu suplemento sempre aparecerá em **Meus Suplementos** ao usar verificações no tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="0039d-137">Your add-in will always display in **My Add-ins** when you use runtime checks.</span></span>|

## <a name="before-you-begin"></a><span data-ttu-id="0039d-138">Antes de começar</span><span class="sxs-lookup"><span data-stu-id="0039d-138">Before you begin</span></span>

<span data-ttu-id="0039d-139">O suplemento deve usar a versão mais recente do esquema de manifesto de suplemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-139">Your add-in must use the most current version of the add-in manifest schema.</span></span> <span data-ttu-id="0039d-140">Se você usar verificações de tempo de execução no seu add-in, certifique-se de usar a biblioteca mais recente Office API JavaScript (office.js).</span><span class="sxs-lookup"><span data-stu-id="0039d-140">If you use runtime checks in your add-in, ensure that you use the latest Office JavaScript API (office.js) library.</span></span>

### <a name="specify-the-latest-add-in-manifest-schema"></a><span data-ttu-id="0039d-141">Especificar o esquema de manifesto de suplemento mais recente</span><span class="sxs-lookup"><span data-stu-id="0039d-141">Specify the latest add-in manifest schema</span></span>

<span data-ttu-id="0039d-142">Seu manifesto de suplemento deve usar a versão 1.1 do esquema de manifesto de suplemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-142">Your add-in's manifest must use version 1.1 of the add-in manifest schema.</span></span> <span data-ttu-id="0039d-143">De definir [o elemento OfficeApp](../reference/manifest/officeapp.md) no manifesto do seu complemento da seguinte forma.</span><span class="sxs-lookup"><span data-stu-id="0039d-143">Set the [OfficeApp](../reference/manifest/officeapp.md) element in your add-in manifest as follows.</span></span> <span data-ttu-id="0039d-144">Este exemplo mostra o `TaskPaneApp` tipo.</span><span class="sxs-lookup"><span data-stu-id="0039d-144">This example shows the `TaskPaneApp` type.</span></span>

```XML
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="TaskPaneApp">
```

### <a name="specify-the-latest-office-javascript-api-library"></a><span data-ttu-id="0039d-145">Especifique a biblioteca Office API JavaScript mais recente</span><span class="sxs-lookup"><span data-stu-id="0039d-145">Specify the latest Office JavaScript API library</span></span>

<span data-ttu-id="0039d-146">Se você usar verificações de tempo de execução, consulte a versão mais atual da biblioteca de API JavaScript Office da rede de distribuição de conteúdo (CDN).</span><span class="sxs-lookup"><span data-stu-id="0039d-146">If you use runtime checks, reference the most current version of the Office JavaScript API library from the content delivery network (CDN).</span></span> <span data-ttu-id="0039d-147">Para tanto, adicione a seguinte marca `script` ao código HTML.</span><span class="sxs-lookup"><span data-stu-id="0039d-147">To do this, add the following  `script` tag to your HTML.</span></span> <span data-ttu-id="0039d-148">O uso de `/1/` na URL da CDN garante a referência à versão mais recente do Office.js.</span><span class="sxs-lookup"><span data-stu-id="0039d-148">Using `/1/` in the CDN URL ensures that you reference the most recent version of Office.js.</span></span>

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
```

## <a name="options-to-specify-office-applications-or-api-requirements"></a><span data-ttu-id="0039d-149">Opções para especificar Office aplicativos ou requisitos de API</span><span class="sxs-lookup"><span data-stu-id="0039d-149">Options to specify Office applications or API requirements</span></span>

<span data-ttu-id="0039d-150">Quando você especifica Office aplicativos ou requisitos de API, há vários fatores a considerar.</span><span class="sxs-lookup"><span data-stu-id="0039d-150">When you specify Office applications or API requirements, there are several factors to consider.</span></span> <span data-ttu-id="0039d-151">O diagrama a seguir mostra como decidir sobre qual técnica usar em seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-151">The following diagram shows how to decide which technique to use in your add-in.</span></span>

![Escolha a melhor opção para o seu complemento ao especificar Office aplicativos ou requisitos de API.](../images/options-for-office-hosts.png)

- <span data-ttu-id="0039d-153">Se o seu add-in for executado em um Office aplicativo, de definir o `Hosts` elemento no manifesto.</span><span class="sxs-lookup"><span data-stu-id="0039d-153">If your add-in runs in one Office application, set the `Hosts` element in the manifest.</span></span> <span data-ttu-id="0039d-154">Para saber mais, confira [Definir o elemento Hosts](#set-the-hosts-element).</span><span class="sxs-lookup"><span data-stu-id="0039d-154">For more information, see [Set the Hosts element](#set-the-hosts-element).</span></span>

- <span data-ttu-id="0039d-155">Para definir o conjunto mínimo de requisitos ou membros da API que um aplicativo Office deve suportar para executar o seu complemento, desmarcar `Requirements` o elemento no manifesto.</span><span class="sxs-lookup"><span data-stu-id="0039d-155">To set the minimum requirement set or API members that an Office application must support to run your add-in, set the `Requirements` element in the manifest.</span></span> <span data-ttu-id="0039d-156">Para saber mais, confira [Definir o elemento Requirements no manifesto](#set-the-requirements-element-in-the-manifest).</span><span class="sxs-lookup"><span data-stu-id="0039d-156">For more information, see [Set the Requirements element in the manifest](#set-the-requirements-element-in-the-manifest).</span></span>

- <span data-ttu-id="0039d-157">Se você quiser fornecer funcionalidade adicional se conjuntos de requisitos específicos ou membros da API estão disponíveis no aplicativo Office, execute uma verificação de tempo de execução no código JavaScript do seu complemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-157">If you would like to provide additional functionality if specific requirement sets or API members are available in the Office application, perform a runtime check in your add-in's JavaScript code.</span></span> <span data-ttu-id="0039d-158">Por exemplo, se o suplemento for executado no Excel 2016, use os membros do API JavaScript do Excel a fim de fornecer funcionalidades adicionais.</span><span class="sxs-lookup"><span data-stu-id="0039d-158">For example, if your add-in runs in Excel 2016, use API members from the Excel JavaScript API to provide additional functionality.</span></span> <span data-ttu-id="0039d-159">Para saber mais, confira [Usar verificações de tempo de execução em seu código JavaScript](#use-runtime-checks-in-your-javascript-code).</span><span class="sxs-lookup"><span data-stu-id="0039d-159">For more information, see [Use runtime checks in your JavaScript code](#use-runtime-checks-in-your-javascript-code).</span></span>

## <a name="set-the-hosts-element"></a><span data-ttu-id="0039d-160">Definir o elemento Hosts</span><span class="sxs-lookup"><span data-stu-id="0039d-160">Set the Hosts element</span></span>

<span data-ttu-id="0039d-161">Para fazer o seu complemento ser executado em um Office cliente, use os `Hosts` elementos e `Host` no manifesto.</span><span class="sxs-lookup"><span data-stu-id="0039d-161">To make your add-in run in one Office client application, use the `Hosts` and `Host` elements in the manifest.</span></span> <span data-ttu-id="0039d-162">Se você não especificar o elemento, o seu add-in será executado em todos os aplicativos Office suportados pelo tipo especificado `Hosts` (ou seja, Mail, Painel de Tarefas `OfficeApp` ou Conteúdo).</span><span class="sxs-lookup"><span data-stu-id="0039d-162">If you don't specify the `Hosts` element, your add-in will run in all Office applications supported by the specified `OfficeApp` type (that is, Mail, Task pane, or Content).</span></span>

<span data-ttu-id="0039d-163">Por exemplo, o seguinte e declaração especifica que o complemento funcionará com qualquer versão do Excel, que inclui `Hosts` `Host` Excel na Web, Windows e iPad.</span><span class="sxs-lookup"><span data-stu-id="0039d-163">For example, the following `Hosts` and `Host` declaration specifies that the add-in will work with any release of Excel, which includes Excel on the web, Windows, and iPad.</span></span>

```xml
<Hosts>
  <Host Name="Workbook" />
</Hosts>
```

<span data-ttu-id="0039d-164">O `Hosts` elemento pode conter um ou mais `Host` elementos.</span><span class="sxs-lookup"><span data-stu-id="0039d-164">The `Hosts` element can contain one or more `Host` elements.</span></span> <span data-ttu-id="0039d-165">O `Host` elemento especifica o Office aplicativo que seu add-in requer.</span><span class="sxs-lookup"><span data-stu-id="0039d-165">The `Host` element specifies the Office application your add-in requires.</span></span> <span data-ttu-id="0039d-166">O `Name` atributo é necessário e pode ser definido como um dos seguintes valores.</span><span class="sxs-lookup"><span data-stu-id="0039d-166">The `Name` attribute is required and can be set to one of the following values.</span></span>

| <span data-ttu-id="0039d-167">Nome</span><span class="sxs-lookup"><span data-stu-id="0039d-167">Name</span></span>          | <span data-ttu-id="0039d-168">Aplicativos cliente do Office</span><span class="sxs-lookup"><span data-stu-id="0039d-168">Office client applications</span></span>                     | <span data-ttu-id="0039d-169">Tipos de complemento disponíveis</span><span class="sxs-lookup"><span data-stu-id="0039d-169">Available add-in types</span></span> |
|:--------------|:-----------------------------------------------|:-----------------------|
| <span data-ttu-id="0039d-170">Banco de dados</span><span class="sxs-lookup"><span data-stu-id="0039d-170">Database</span></span>      | <span data-ttu-id="0039d-171">Aplicativos Web do Access</span><span class="sxs-lookup"><span data-stu-id="0039d-171">Access web apps</span></span>                                | <span data-ttu-id="0039d-172">Painel de tarefas</span><span class="sxs-lookup"><span data-stu-id="0039d-172">Task pane</span></span>              |
| <span data-ttu-id="0039d-173">Document</span><span class="sxs-lookup"><span data-stu-id="0039d-173">Document</span></span>      | <span data-ttu-id="0039d-174">Word na Web, Windows, Mac, iPad</span><span class="sxs-lookup"><span data-stu-id="0039d-174">Word on the web, Windows, Mac, iPad</span></span>            | <span data-ttu-id="0039d-175">Painel de tarefas</span><span class="sxs-lookup"><span data-stu-id="0039d-175">Task pane</span></span>              |
| <span data-ttu-id="0039d-176">Mailbox</span><span class="sxs-lookup"><span data-stu-id="0039d-176">Mailbox</span></span>       | <span data-ttu-id="0039d-177">Outlook na Web, Windows, Mac, Android, iOS</span><span class="sxs-lookup"><span data-stu-id="0039d-177">Outlook on the web, Windows, Mac, Android, iOS</span></span> | <span data-ttu-id="0039d-178">Email</span><span class="sxs-lookup"><span data-stu-id="0039d-178">Mail</span></span>                   |
| <span data-ttu-id="0039d-179">Notebook</span><span class="sxs-lookup"><span data-stu-id="0039d-179">Notebook</span></span>      | <span data-ttu-id="0039d-180">OneNote Online</span><span class="sxs-lookup"><span data-stu-id="0039d-180">OneNote on the web</span></span>                             | <span data-ttu-id="0039d-181">Painel de tarefas, Conteúdo</span><span class="sxs-lookup"><span data-stu-id="0039d-181">Task pane, Content</span></span>     |
| <span data-ttu-id="0039d-182">Presentation</span><span class="sxs-lookup"><span data-stu-id="0039d-182">Presentation</span></span>  | <span data-ttu-id="0039d-183">PowerPoint na Web, Windows, Mac, iPad</span><span class="sxs-lookup"><span data-stu-id="0039d-183">PowerPoint on the web, Windows, Mac, iPad</span></span>      | <span data-ttu-id="0039d-184">Painel de tarefas, Conteúdo</span><span class="sxs-lookup"><span data-stu-id="0039d-184">Task pane, Content</span></span>     |
| <span data-ttu-id="0039d-185">Project</span><span class="sxs-lookup"><span data-stu-id="0039d-185">Project</span></span>       | <span data-ttu-id="0039d-186">Project no Windows</span><span class="sxs-lookup"><span data-stu-id="0039d-186">Project on Windows</span></span>                             | <span data-ttu-id="0039d-187">Painel de tarefas</span><span class="sxs-lookup"><span data-stu-id="0039d-187">Task pane</span></span>              |
| <span data-ttu-id="0039d-188">Workbook</span><span class="sxs-lookup"><span data-stu-id="0039d-188">Workbook</span></span>      | <span data-ttu-id="0039d-189">Excel na Web, Windows, Mac, iPad</span><span class="sxs-lookup"><span data-stu-id="0039d-189">Excel on the web, Windows, Mac, iPad</span></span>           | <span data-ttu-id="0039d-190">Painel de tarefas, Conteúdo</span><span class="sxs-lookup"><span data-stu-id="0039d-190">Task pane, Content</span></span>     |

> [!NOTE]
> <span data-ttu-id="0039d-191">O `Name` atributo especifica o Office cliente que pode executar o seu add-in.</span><span class="sxs-lookup"><span data-stu-id="0039d-191">The `Name` attribute specifies the Office client application that can run your add-in.</span></span> <span data-ttu-id="0039d-192">Office aplicativos têm suporte em diferentes plataformas e são executados em desktops, navegadores da Web, tablets e dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="0039d-192">Office applications are supported on different platforms and run on desktops, web browsers, tablets, and mobile devices.</span></span> <span data-ttu-id="0039d-193">Você não pode especificar qual plataforma pode ser usada para executar seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-193">You can't specify which platform can be used to run your add-in.</span></span> <span data-ttu-id="0039d-194">Por exemplo, se você especificar , Outlook na Web e Windows pode ser usado `Mailbox` para executar o seu complemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-194">For example, if you specify `Mailbox`, both Outlook on the web and on Windows can be used to run your add-in.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="0039d-195">Não recomendamos mais criar e usar aplicativos Web do Access e bancos de dados no SharePoint.</span><span class="sxs-lookup"><span data-stu-id="0039d-195">We no longer recommend that you create and use Access web apps and databases in SharePoint.</span></span> <span data-ttu-id="0039d-196">Como alternativa, use o [Microsoft PowerApps](https://powerapps.microsoft.com/) para criar soluções de negócios sem código para dispositivos móveis e Web.</span><span class="sxs-lookup"><span data-stu-id="0039d-196">As an alternative, we recommend that you use [Microsoft PowerApps](https://powerapps.microsoft.com/) to build no-code business solutions for web and mobile devices.</span></span>

## <a name="set-the-requirements-element-in-the-manifest"></a><span data-ttu-id="0039d-197">Definir o elemento Requirements no manifesto</span><span class="sxs-lookup"><span data-stu-id="0039d-197">Set the Requirements element in the manifest</span></span>

<span data-ttu-id="0039d-198">O elemento especifica os conjuntos de requisitos mínimos ou membros da API que devem ser suportados pelo aplicativo `Requirements` Office para executar o seu complemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-198">The `Requirements` element specifies the minimum requirement sets or API members that must be supported by the Office application to run your add-in.</span></span> <span data-ttu-id="0039d-199">O elemento pode especificar conjuntos de requisitos e `Requirements` métodos individuais usados no seu complemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-199">The `Requirements` element can specify both requirement sets and individual methods used in your add-in.</span></span> <span data-ttu-id="0039d-200">Na versão 1.1 do esquema de manifesto do add-in, o elemento é opcional para todos os `Requirements` Outlook.</span><span class="sxs-lookup"><span data-stu-id="0039d-200">In version 1.1 of the add-in manifest schema, the `Requirements` element is optional for all add-ins, except for Outlook add-ins.</span></span>

> [!WARNING]
> <span data-ttu-id="0039d-201">Use apenas o elemento para especificar conjuntos de requisitos críticos ou membros `Requirements` da API que seu complemento deve usar.</span><span class="sxs-lookup"><span data-stu-id="0039d-201">Only use the `Requirements` element to specify critical requirement sets or API members that your add-in must use.</span></span> <span data-ttu-id="0039d-202">Se o aplicativo ou plataforma Office não oferece suporte aos conjuntos de requisitos ou membros da API especificados no elemento, o complemento não será executado nesse aplicativo ou plataforma e não será exibido em `Requirements` **Meus Complementos**. Em vez disso, recomendamos que você disponibilizar seu complemento em todas as plataformas de um aplicativo Office, como Excel na Web, Windows e iPad.</span><span class="sxs-lookup"><span data-stu-id="0039d-202">If the Office application or platform doesn't support the requirement sets or API members specified in the `Requirements` element, the add-in won't run in that application or platform, and won't display in **My Add-ins**. Instead, we recommend that you make your add-in available on all platforms of an Office application, such as Excel on the web, Windows, and iPad.</span></span> <span data-ttu-id="0039d-203">Para disponibilizar seu complemento  em todos os Office e plataformas, use verificações de tempo de execução em vez do `Requirements` elemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-203">To make your add-in available on  _all_ Office applications and platforms, use runtime checks instead of the `Requirements` element.</span></span>

<span data-ttu-id="0039d-204">O exemplo de código a seguir mostra um complemento que é carregado em todos os Office cliente que suportam o seguinte:</span><span class="sxs-lookup"><span data-stu-id="0039d-204">The following code example shows an add-in that loads in all Office client applications that support the following:</span></span>

-  <span data-ttu-id="0039d-205">`TableBindings` conjunto de requisitos, que tem uma versão mínima de "1.1".</span><span class="sxs-lookup"><span data-stu-id="0039d-205">`TableBindings` requirement set, which has a minimum version of "1.1".</span></span>

-  <span data-ttu-id="0039d-206">`OOXML` conjunto de requisitos, que tem uma versão mínima de "1.1".</span><span class="sxs-lookup"><span data-stu-id="0039d-206">`OOXML` requirement set, which has a minimum version of "1.1".</span></span>

-  <span data-ttu-id="0039d-207">`Document.getSelectedDataAsync` método.</span><span class="sxs-lookup"><span data-stu-id="0039d-207">`Document.getSelectedDataAsync` method.</span></span>

```XML
<Requirements>
   <Sets DefaultMinVersion="1.1">
      <Set Name="TableBindings" MinVersion="1.1"/>
      <Set Name="OOXML" MinVersion="1.1"/>
   </Sets>
   <Methods>
      <Method Name="Document.getSelectedDataAsync"/>
   </Methods>
</Requirements>
```

- <span data-ttu-id="0039d-208">O `Requirements` elemento contém os elementos e `Sets` `Methods` filho.</span><span class="sxs-lookup"><span data-stu-id="0039d-208">The `Requirements` element contains the `Sets` and `Methods` child elements.</span></span>

- <span data-ttu-id="0039d-209">O `Sets` elemento pode conter um ou mais `Set` elementos.</span><span class="sxs-lookup"><span data-stu-id="0039d-209">The `Sets` element can contain one or more `Set` elements.</span></span> <span data-ttu-id="0039d-210">`DefaultMinVersion` especifica o valor `MinVersion` padrão de todos os elementos `Set` filho.</span><span class="sxs-lookup"><span data-stu-id="0039d-210">`DefaultMinVersion` specifies the default `MinVersion` value of all child `Set` elements.</span></span>

- <span data-ttu-id="0039d-211">O `Set` elemento especifica conjuntos de requisitos que o aplicativo Office deve dar suporte para executar o add-in.</span><span class="sxs-lookup"><span data-stu-id="0039d-211">The `Set` element specifies requirement sets that the Office application must support to run the add-in.</span></span> <span data-ttu-id="0039d-212">O `Name` atributo especifica o nome do conjunto de requisitos.</span><span class="sxs-lookup"><span data-stu-id="0039d-212">The `Name` attribute specifies the name of the requirement set.</span></span> <span data-ttu-id="0039d-213">Especifica `MinVersion` a versão mínima do conjunto de requisitos.</span><span class="sxs-lookup"><span data-stu-id="0039d-213">The `MinVersion` specifies the minimum version of the requirement set.</span></span> <span data-ttu-id="0039d-214">`MinVersion`substitui o valor de For more information about requirement sets and requirement set versions that your API members `DefaultMinVersion` belong to, [see Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="0039d-214">`MinVersion` overrides the value of `DefaultMinVersion` For more information about requirement sets and requirement set versions that your API members belong to, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span></span>

- <span data-ttu-id="0039d-215">O `Methods` elemento pode conter um ou mais `Method` elementos.</span><span class="sxs-lookup"><span data-stu-id="0039d-215">The `Methods` element can contain one or more `Method` elements.</span></span> <span data-ttu-id="0039d-216">Não é possível usar o `Methods` elemento com Outlook de complementos.</span><span class="sxs-lookup"><span data-stu-id="0039d-216">You can't use the `Methods` element with Outlook add-ins.</span></span>

- <span data-ttu-id="0039d-217">O elemento especifica um método individual que deve ser suportado no Office `Method` aplicativo em que o seu complemento é executado.</span><span class="sxs-lookup"><span data-stu-id="0039d-217">The `Method` element specifies an individual method that must be supported in the Office application where your add-in runs.</span></span> <span data-ttu-id="0039d-218">O `Name` atributo é necessário e especifica o nome do método qualificado com seu objeto pai.</span><span class="sxs-lookup"><span data-stu-id="0039d-218">The `Name` attribute is required and specifies the name of the method qualified with its parent object.</span></span>

## <a name="use-runtime-checks-in-your-javascript-code"></a><span data-ttu-id="0039d-219">Usar verificações no tempo de execução em seu código JavaScript</span><span class="sxs-lookup"><span data-stu-id="0039d-219">Use runtime checks in your JavaScript code</span></span>

<span data-ttu-id="0039d-220">Talvez você queira fornecer funcionalidade adicional no seu add-in se determinados conjuntos de requisitos são suportados pelo Office aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0039d-220">You might want to provide additional functionality in your add-in if certain requirement sets are supported by the Office application.</span></span> <span data-ttu-id="0039d-221">Por exemplo, você pode usar a nova API JavaScript do Word em seu suplemento existente se o suplemento for executado no Word 2016. </span><span class="sxs-lookup"><span data-stu-id="0039d-221">For example, you might want to use the Word JavaScript APIs in your existing add-in if your add-in runs in Word 2016.</span></span> <span data-ttu-id="0039d-222">Para fazer isso, use o método [isSetSupported](/javascript/api/office/office.requirementsetsupport#issetsupported-name--minversion-) com o nome do conjunto de requisitos.</span><span class="sxs-lookup"><span data-stu-id="0039d-222">To do this, you use the [isSetSupported](/javascript/api/office/office.requirementsetsupport#issetsupported-name--minversion-) method with the name of the requirement set.</span></span> <span data-ttu-id="0039d-223">`isSetSupported`determina, no tempo de execução, se o aplicativo Office executando o complemento oferece suporte ao conjunto de requisitos.</span><span class="sxs-lookup"><span data-stu-id="0039d-223">`isSetSupported` determines, at runtime, whether the Office application running the add-in supports the requirement set.</span></span> <span data-ttu-id="0039d-224">Se o conjunto de requisitos for suportado, retornará true e executa o código adicional que usa os membros `isSetSupported` da API desse conjunto de requisitos. </span><span class="sxs-lookup"><span data-stu-id="0039d-224">If the requirement set is supported, `isSetSupported` returns **true** and runs the additional code that uses the API members from that requirement set.</span></span> <span data-ttu-id="0039d-225">Se o Office aplicativo não dá suporte ao conjunto de requisitos, retorna false e o `isSetSupported` código adicional não será executado. </span><span class="sxs-lookup"><span data-stu-id="0039d-225">If the Office application doesn't support the requirement set, `isSetSupported` returns **false** and the additional code won't run.</span></span> <span data-ttu-id="0039d-226">O código a seguir mostra a sintaxe a ser usada com `isSetSupported`.</span><span class="sxs-lookup"><span data-stu-id="0039d-226">The following code shows the syntax to use with `isSetSupported`.</span></span>

```js
if (Office.context.requirements.isSetSupported(RequirementSetName, MinimumVersion))
{
   // Code that uses API members from RequirementSetName.
}

```

- <span data-ttu-id="0039d-227">_RequirementSetName_ (obrigatório) é uma cadeia de caracteres que representa o nome do conjunto de requisitos (por exemplo, "**ExcelApi**", "**Mailbox**", etc.).</span><span class="sxs-lookup"><span data-stu-id="0039d-227">_RequirementSetName_ (required) is a string that represents the name of the requirement set (e.g., "**ExcelApi**", "**Mailbox**", etc.).</span></span> <span data-ttu-id="0039d-228">Para saber mais sobre os conjuntos de requisitos disponíveis, confira [Conjuntos de requisitos de Suplemento do Office](../reference/requirement-sets/office-add-in-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="0039d-228">For more information about available requirement sets, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span></span>
- <span data-ttu-id="0039d-229">_MinimumVersion_ (opcional) é uma cadeia de caracteres que especifica a versão mínima do conjunto de requisitos que o aplicativo Office deve suportar para que o código dentro da instrução seja executado `if` (por exemplo, "**1,9**").</span><span class="sxs-lookup"><span data-stu-id="0039d-229">_MinimumVersion_ (optional) is a string that specifies the minimum requirement set version that the Office application must support in order for the code within the `if` statement to run (e.g., "**1.9**").</span></span>

> [!WARNING]
> <span data-ttu-id="0039d-230">Ao chamar `isSetSupported` o método, o valor do `MinimumVersion` parâmetro (se especificado) deve ser uma cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="0039d-230">When calling the `isSetSupported` method, the value of the `MinimumVersion` parameter (if specified) should be a string.</span></span> <span data-ttu-id="0039d-231">Isso ocorre porque o analisador de JavaScript não pode diferenciar valores numéricos, como 1.1 e 1.10, onde é possível para valores de cadeia de caracteres como "1.1" e "1.10".</span><span class="sxs-lookup"><span data-stu-id="0039d-231">This is because the JavaScript parser cannot differentiate between numeric values such as 1.1 and 1.10, where as it can for string values such as "1.1" and "1.10".</span></span>
> <span data-ttu-id="0039d-232">A sobrecarga de `number` está obsoleta.</span><span class="sxs-lookup"><span data-stu-id="0039d-232">The `number` overload is deprecated.</span></span>

<span data-ttu-id="0039d-233">Use `isSetSupported` com o aplicativo Office da seguinte `RequirementSetName` forma.</span><span class="sxs-lookup"><span data-stu-id="0039d-233">Use `isSetSupported` with the `RequirementSetName` associated with the Office application as follows.</span></span>

|<span data-ttu-id="0039d-234">Aplicativo do Office</span><span class="sxs-lookup"><span data-stu-id="0039d-234">Office application</span></span>|<span data-ttu-id="0039d-235">RequirementSetName</span><span class="sxs-lookup"><span data-stu-id="0039d-235">RequirementSetName</span></span>|
|---|---|
|<span data-ttu-id="0039d-236">Excel</span><span class="sxs-lookup"><span data-stu-id="0039d-236">Excel</span></span>|<span data-ttu-id="0039d-237">ExcelApi</span><span class="sxs-lookup"><span data-stu-id="0039d-237">ExcelApi</span></span>|
|<span data-ttu-id="0039d-238">OneNote</span><span class="sxs-lookup"><span data-stu-id="0039d-238">OneNote</span></span>|<span data-ttu-id="0039d-239">OneNoteApi</span><span class="sxs-lookup"><span data-stu-id="0039d-239">OneNoteApi</span></span>|
|<span data-ttu-id="0039d-240">Outlook</span><span class="sxs-lookup"><span data-stu-id="0039d-240">Outlook</span></span>|<span data-ttu-id="0039d-241">Caixa de correio</span><span class="sxs-lookup"><span data-stu-id="0039d-241">Mailbox</span></span>|
|<span data-ttu-id="0039d-242">Word</span><span class="sxs-lookup"><span data-stu-id="0039d-242">Word</span></span>|<span data-ttu-id="0039d-243">WordApi</span><span class="sxs-lookup"><span data-stu-id="0039d-243">WordApi</span></span>|

<span data-ttu-id="0039d-244">O método e os conjuntos de requisitos para esses aplicativos estão disponíveis no arquivo Office.js mais recente `isSetSupported` no CDN.</span><span class="sxs-lookup"><span data-stu-id="0039d-244">The `isSetSupported` method and the requirement sets for these applications are available in the latest Office.js file on the CDN.</span></span> <span data-ttu-id="0039d-245">Se você não usar Office.js do CDN, o seu complemento poderá gerar exceções porque será `isSetSupported` indefinida.</span><span class="sxs-lookup"><span data-stu-id="0039d-245">If you don't use Office.js from the CDN, your add-in might generate exceptions because `isSetSupported` will be undefined.</span></span> <span data-ttu-id="0039d-246">Para obter mais informações, [consulte Especificar a biblioteca Office API JavaScript mais recente.](#specify-the-latest-office-javascript-api-library)</span><span class="sxs-lookup"><span data-stu-id="0039d-246">For more information, see [Specify the latest Office JavaScript API library](#specify-the-latest-office-javascript-api-library).</span></span>

<span data-ttu-id="0039d-247">O exemplo de código a seguir mostra como um add-in pode fornecer funcionalidades diferentes para diferentes Office aplicativos que podem dar suporte a diferentes conjuntos de requisitos ou membros da API.</span><span class="sxs-lookup"><span data-stu-id="0039d-247">The following code example shows how an add-in can provide different functionality for different Office applications that might support different requirement sets or API members.</span></span>

```js
if (Office.context.requirements.isSetSupported('WordApi', '1.1'))
{
    // Run code that provides additional functionality using the Word JavaScript API when the add-in runs in Word 2016 or later.
}
else if (Office.context.requirements.isSetSupported('CustomXmlParts'))
{
    // Run code that uses API members from the CustomXmlParts requirement set.
}
else
{
    // Run additional code when the Office application is not Word 2016 or later and does not support the CustomXmlParts requirement set.
}

```

## <a name="runtime-checks-using-methods-not-in-a-requirement-set"></a><span data-ttu-id="0039d-248">Verificações no tempo de execução usando métodos que não fazem parte de um conjunto de requisitos</span><span class="sxs-lookup"><span data-stu-id="0039d-248">Runtime checks using methods not in a requirement set</span></span>

<span data-ttu-id="0039d-249">Alguns membros de API não pertencem a conjuntos de requisitos.</span><span class="sxs-lookup"><span data-stu-id="0039d-249">Some API members don't belong to requirement sets.</span></span> <span data-ttu-id="0039d-250">Isso só se aplica a membros da API que fazem parte do namespace da [API JavaScript](../reference/javascript-api-for-office.md) do Office (qualquer coisa em, exceto APIs de Caixa de Correio de Outlook ), mas não membros da API que pertencem à API JavaScript do Word (qualquer coisa em ), Excel API JavaScript (qualquer coisa em OneNote ), ou api `Office.` [](/javascript/api/outlook) [](../reference/overview/word-add-ins-reference-overview.md) `Word.` [](../reference/overview/excel-add-ins-reference-overview.md) `Excel.` [JavaScript](../reference/overview/onenote-add-ins-javascript-reference.md) (qualquer coisa `OneNote.` em ) namespaces.</span><span class="sxs-lookup"><span data-stu-id="0039d-250">This only applies to API members that are part of the [Office JavaScript API](../reference/javascript-api-for-office.md) namespace (anything under `Office.` except [Outlook Mailbox APIs](/javascript/api/outlook)), but not API members that belong to the [Word JavaScript API](../reference/overview/word-add-ins-reference-overview.md) (anything in `Word.`), [Excel JavaScript API](../reference/overview/excel-add-ins-reference-overview.md) (anything in `Excel.`), or [OneNote JavaScript API](../reference/overview/onenote-add-ins-javascript-reference.md) (anything in `OneNote.`) namespaces.</span></span> <span data-ttu-id="0039d-251">Quando o seu complemento depende de um método que não faz parte de um conjunto de requisitos, você pode usar a verificação de tempo de execução para determinar se o método é suportado pelo aplicativo Office, conforme mostrado no exemplo de código a seguir.</span><span class="sxs-lookup"><span data-stu-id="0039d-251">When your add-in depends on a method that is not part of a requirement set, you can use the runtime check to determine whether the method is supported by the Office application, as shown in the following code example.</span></span> <span data-ttu-id="0039d-252">Para obter uma lista completa dos métodos que não pertencem a um conjunto de requisitos, confira [Conjuntos de requisitos de Suplemento do Office](../reference/requirement-sets/office-add-in-requirement-sets.md#methods-that-arent-part-of-a-requirement-set).</span><span class="sxs-lookup"><span data-stu-id="0039d-252">For a complete list of methods that don't belong to a requirement set, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md#methods-that-arent-part-of-a-requirement-set).</span></span>

> [!NOTE]
> <span data-ttu-id="0039d-253">Recomendamos limitar o uso desse tipo de verificação no tempo de execução no código de seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="0039d-253">We recommend that you limit the use of this type of runtime check in your add-in's code.</span></span>

<span data-ttu-id="0039d-254">O exemplo de código a seguir verifica se o aplicativo Office suporta `document.setSelectedDataAsync` .</span><span class="sxs-lookup"><span data-stu-id="0039d-254">The following code example checks whether the Office application supports `document.setSelectedDataAsync`.</span></span>

```js
if (Office.context.document.setSelectedDataAsync)
{
    // Run code that uses `document.setSelectedDataAsync`.
}
```


## <a name="see-also"></a><span data-ttu-id="0039d-255">Confira também</span><span class="sxs-lookup"><span data-stu-id="0039d-255">See also</span></span>

- [<span data-ttu-id="0039d-256">Manifesto XML dos Suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="0039d-256">Office Add-ins XML manifest</span></span>](add-in-manifests.md)
- [<span data-ttu-id="0039d-257">Conjuntos de requisitos de Suplemento do Office</span><span class="sxs-lookup"><span data-stu-id="0039d-257">Office Add-in requirement sets</span></span>](../reference/requirement-sets/office-add-in-requirement-sets.md)
- [<span data-ttu-id="0039d-258">Word-Add-in-Get-Set-EditOpen-XML</span><span class="sxs-lookup"><span data-stu-id="0039d-258">Word-Add-in-Get-Set-EditOpen-XML</span></span>](https://github.com/OfficeDev/Word-Add-in-Get-Set-EditOpen-XML)
