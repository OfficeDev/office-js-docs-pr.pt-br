---
title: Suporte da API JavaScript para Office para suplementos de conteúdo e de painel de tarefas no Office 2013
description: Use a API JavaScript do Office para criar um painel de tarefas no Office 2013.
ms.date: 02/27/2020
localization_priority: Normal
ms.openlocfilehash: 334db88bbec07755678e3ba35e0d4998951ff5ab
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/08/2020
ms.locfileid: "44609703"
---
# <a name="office-javascript-api-support-for-content-and-task-pane-add-ins-in-office-2013"></a><span data-ttu-id="01427-103">Suporte da API JavaScript para Office para suplementos de conteúdo e de painel de tarefas no Office 2013</span><span class="sxs-lookup"><span data-stu-id="01427-103">Office JavaScript API support for content and task pane add-ins in Office 2013</span></span>

[!include[information about the common API](../includes/alert-common-api-info.md)]

<span data-ttu-id="01427-p101">Você pode usar a [API JavaScript para Office](../reference/javascript-api-for-office.md) para criar suplementos de painel de tarefas ou de conteúdo para aplicativos host do Office 2013. Os objetos e métodos que dão suporte a suplementos de conteúdo e de painel de tarefas são categorizados da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="01427-p101">You can use the [Office JavaScript API](../reference/javascript-api-for-office.md) to create task pane or content add-ins for Office 2013 host applications. The objects and methods that content and task pane add-ins support are categorized as follows:</span></span>

1. <span data-ttu-id="01427-106">**Objetos comuns compartilhados com outros suplementos do Office.** Esses objetos incluem [Office](/javascript/api/office), [Context](/javascript/api/office/office.context)e [AsyncResult](/javascript/api/office/office.asyncresult).</span><span class="sxs-lookup"><span data-stu-id="01427-106">**Common objects shared with other Office Add-ins.** These objects include [Office](/javascript/api/office), [Context](/javascript/api/office/office.context), and [AsyncResult](/javascript/api/office/office.asyncresult).</span></span> <span data-ttu-id="01427-107">O `Office` objeto é o objeto raiz da API JavaScript do Office.</span><span class="sxs-lookup"><span data-stu-id="01427-107">The `Office` object is the root object of the Office JavaScript API.</span></span> <span data-ttu-id="01427-108">O `Context` objeto representa o ambiente de tempo de execução do suplemento.</span><span class="sxs-lookup"><span data-stu-id="01427-108">The `Context` object represents the add-in's runtime environment.</span></span> <span data-ttu-id="01427-109">Ambos `Office` e `Context` são os objetos fundamentais para qualquer suplemento do Office.</span><span class="sxs-lookup"><span data-stu-id="01427-109">Both `Office` and `Context` are the fundamental objects for any Office Add-in.</span></span> <span data-ttu-id="01427-110">O `AsyncResult` objeto representa os resultados de uma operação assíncrona, como os dados retornados para o `getSelectedDataAsync` método, que lê o que um usuário selecionou em um documento.</span><span class="sxs-lookup"><span data-stu-id="01427-110">The `AsyncResult` object represents the results of an asynchronous operation, such as the data returned to the `getSelectedDataAsync` method, which reads what a user has selected in a document.</span></span>

2. <span data-ttu-id="01427-111">**O objeto Document.**</span><span class="sxs-lookup"><span data-stu-id="01427-111">**The Document object.**</span></span> <span data-ttu-id="01427-112">A maior parte da API disponível para os suplementos de conteúdo e de painel de tarefas é exposta por meio dos métodos, propriedades e eventos do objeto [Document](/javascript/api/office/office.document) .</span><span class="sxs-lookup"><span data-stu-id="01427-112">The majority of the API available to content and task pane add-ins is exposed through the methods, properties, and events of the [Document](/javascript/api/office/office.document) object.</span></span> <span data-ttu-id="01427-113">Um suplemento de conteúdo ou de painel de tarefas pode usar a propriedade [Office. Context. Document](/javascript/api/office/office.context#document) para acessar o objeto **Document** e por meio dele, pode acessar os principais membros da API para trabalhar com dados em documentos, como [associações](/javascript/api/office/office.bindings) e objetos [CustomXmlParts](/javascript/api/office/office.customxmlparts) , e os métodos [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-), [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-)e [getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-) .</span><span class="sxs-lookup"><span data-stu-id="01427-113">A content or task pane add-in can use the [Office.context.document](/javascript/api/office/office.context#document) property to access the **Document** object, and through it, can access the key members of the API for working with data in documents, such as the [Bindings](/javascript/api/office/office.bindings) and [CustomXmlParts](/javascript/api/office/office.customxmlparts) objects, and the [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-), [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-), and [getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-) methods.</span></span> <span data-ttu-id="01427-114">O `Document` objeto também fornece a propriedade [Mode](/javascript/api/office/office.document#mode) para determinar se um documento é somente leitura ou no modo de edição, a propriedade [URL](/javascript/api/office/office.document#url) para obter a URL do documento atual e o acesso ao objeto [Settings](/javascript/api/office/office.settings) .</span><span class="sxs-lookup"><span data-stu-id="01427-114">The `Document` object also provides the [mode](/javascript/api/office/office.document#mode) property for determining whether a document is read-only or in edit mode, the [url](/javascript/api/office/office.document#url) property to get the URL of the current document, and access to the [Settings](/javascript/api/office/office.settings) object.</span></span> <span data-ttu-id="01427-115">O `Document` objeto também oferece suporte à adição de manipuladores de eventos para o evento [SelectionChanged](/javascript/api/office/office.documentselectionchangedeventargs) , para que você possa detectar quando um usuário altera sua seleção no documento.</span><span class="sxs-lookup"><span data-stu-id="01427-115">The `Document` object also supports adding event handlers for the [SelectionChanged](/javascript/api/office/office.documentselectionchangedeventargs) event, so you can detect when a user changes their selection in the document.</span></span>

   <span data-ttu-id="01427-116">Um suplemento de conteúdo ou de painel de tarefas pode acessar o `Document` objeto somente depois que o dom e o ambiente de tempo de execução foram carregados, normalmente no manipulador de eventos do evento [Office. Initialize](/javascript/api/office) .</span><span class="sxs-lookup"><span data-stu-id="01427-116">A content or task pane add-in can access the `Document` object only after the DOM and runtime environment has been loaded, typically in the event handler for the [Office.initialize](/javascript/api/office) event.</span></span> <span data-ttu-id="01427-117">Para saber mais sobre o fluxo de eventos quando um suplemento é inicializado e como verificar se o DOM e o tempo de execução foram carregados com êxito, confira [Carregar o DOM e o ambiente de tempo de execução](loading-the-dom-and-runtime-environment.md).</span><span class="sxs-lookup"><span data-stu-id="01427-117">For information about the flow of events when an add-in is initialized, and how to check that the DOM and runtime and loaded successfully, see [Loading the DOM and runtime environment](loading-the-dom-and-runtime-environment.md).</span></span>

3. <span data-ttu-id="01427-p105">**Objetos para trabalhar com recursos específicos.** Para trabalhar com recursos específicos da API, use as seguintes objetos e métodos:</span><span class="sxs-lookup"><span data-stu-id="01427-p105">**Objects for working with specific features.** To work with specific features of the API, use the following objects and methods:</span></span>

    - <span data-ttu-id="01427-120">Os métodos do objeto [Bindings](/javascript/api/office/office.bindings) para criar ou obter associações e os métodos e propriedades do objeto [Binding](/javascript/api/office/office.binding) para trabalhar com dados.</span><span class="sxs-lookup"><span data-stu-id="01427-120">The methods of the [Bindings](/javascript/api/office/office.bindings) object to create or get bindings, and the methods and properties of the [Binding](/javascript/api/office/office.binding) object to work with data.</span></span>

    - <span data-ttu-id="01427-121">Os objetos [CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart) e objetos associados para criar e manipular partes XML personalizadas em documentos do Word.</span><span class="sxs-lookup"><span data-stu-id="01427-121">The [CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart) and associated objects to create and manipulate custom XML parts in Word documents.</span></span>

    - <span data-ttu-id="01427-122">Os objetos [File](/javascript/api/office/office.file) e [Slice](/javascript/api/office/office.slice) para criar uma cópia do documento inteiro, dividi-lo em partes ou "fatias" e ler ou transmitir os dados nessas fatias.</span><span class="sxs-lookup"><span data-stu-id="01427-122">The [File](/javascript/api/office/office.file) and [Slice](/javascript/api/office/office.slice) objects to create a copy of the entire document, break it into chunks or "slices", and then read or transmit the data in those slices.</span></span>

    - <span data-ttu-id="01427-123">O objeto [Settings](/javascript/api/office/office.settings) para salvar dados personalizados, como preferências do usuário e o estado do suplemento.</span><span class="sxs-lookup"><span data-stu-id="01427-123">The [Settings](/javascript/api/office/office.settings) object to save custom data, such as user preferences, and add-in state.</span></span>


> [!IMPORTANT]
> <span data-ttu-id="01427-124">Alguns membros da API não têm suporte em todos os aplicativos do Office que podem hospedar suplementos de conteúdo e de painel de tarefas. Para determinar quais membros têm suporte, confira o seguinte:</span><span class="sxs-lookup"><span data-stu-id="01427-124">Some of the API members aren't supported across all Office applications that can host content and task pane add-ins. To determine which members are supported, see any of the following:</span></span>

<span data-ttu-id="01427-125">Para obter um resumo do suporte à API JavaScript do Office em aplicativos host do Office, consulte [Understanding the Office JavaScript API](understanding-the-javascript-api-for-office.md).</span><span class="sxs-lookup"><span data-stu-id="01427-125">For a summary of Office JavaScript API support across Office host applications, see [Understanding the Office JavaScript API](understanding-the-javascript-api-for-office.md).</span></span>


## <a name="reading-and-writing-to-an-active-selection"></a><span data-ttu-id="01427-126">Ler e gravar em uma seleção ativa</span><span class="sxs-lookup"><span data-stu-id="01427-126">Reading and writing to an active selection</span></span>

<span data-ttu-id="01427-127">Você pode ler ou gravar na seleção atual do usuário em um documento, planilha ou apresentação.</span><span class="sxs-lookup"><span data-stu-id="01427-127">You can read or write to the user's current selection in a document, spreadsheet, or presentation.</span></span> <span data-ttu-id="01427-128">Dependendo do aplicativo host para o suplemento, você pode especificar o tipo de estrutura de dados para ler ou gravar como um parâmetro nos métodos [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-) e [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-) do objeto [Document](/javascript/api/office/office.document).</span><span class="sxs-lookup"><span data-stu-id="01427-128">Depending on the host application for your add-in, you can specify the type of data structure to read or write as a parameter in the [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-) and [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-) methods of the [Document](/javascript/api/office/office.document) object.</span></span> <span data-ttu-id="01427-129">Por exemplo, você pode especificar qualquer tipo de dados (texto, HTML, dados tabulares ou Open XML do Office) para o Word, texto e dados tabulares para o Excel e texto para o PowerPoint e o Project.</span><span class="sxs-lookup"><span data-stu-id="01427-129">For example, you can specify any type of data (text, HTML, tabular data, or Office Open XML) for Word, text and tabular data for Excel, and text for PowerPoint and Project.</span></span> <span data-ttu-id="01427-130">Você também pode criar manipuladores de eventos para detectar alterações na seleção do usuário.</span><span class="sxs-lookup"><span data-stu-id="01427-130">You can also create event handlers to detect changes to the user's selection.</span></span> <span data-ttu-id="01427-131">O exemplo a seguir obtém dados da seleção como texto usando o `getSelectedDataAsync` método.</span><span class="sxs-lookup"><span data-stu-id="01427-131">The following example gets data from the selection as text using the `getSelectedDataAsync` method.</span></span>


```js
Office.context.document.getSelectedDataAsync(
    Office.CoercionType.Text, function (asyncResult) {
        if (asyncResult.status == Office.AsyncResultStatus.Failed) {
            write('Action failed. Error: ' + asyncResult.error.message);
        }
        else {
            write('Selected data: ' + asyncResult.value);
        }
    });

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message;
}

```

<span data-ttu-id="01427-132">Para saber mais e obter exemplos, consulte [Ler e gravar dados na seleção ativa em um documento ou planilha](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span><span class="sxs-lookup"><span data-stu-id="01427-132">For more details and examples, see [Read and write data to the active selection in a document or spreadsheet](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span></span>


## <a name="binding-to-a-region-in-a-document-or-spreadsheet"></a><span data-ttu-id="01427-133">Associar a uma região em um documento ou planilha</span><span class="sxs-lookup"><span data-stu-id="01427-133">Binding to a region in a document or spreadsheet</span></span>

<span data-ttu-id="01427-134">Você pode usar os `getSelectedDataAsync` `setSelectedDataAsync` métodos e para ler ou gravar na seleção *atual* do usuário em um documento, planilha ou apresentação.</span><span class="sxs-lookup"><span data-stu-id="01427-134">You can use the `getSelectedDataAsync` and `setSelectedDataAsync` methods to read or write to the user's *current* selection in a document, spreadsheet, or presentation.</span></span> <span data-ttu-id="01427-135">No entanto, para acessar a mesma região em um documento entre sessões de execução do suplemento sem exigir que o usuário faça uma seleção, primeiro você deve se associar a essa região.</span><span class="sxs-lookup"><span data-stu-id="01427-135">However, if you would like to access the same region in a document across sessions of running your add-in without requiring the user to make a selection, you should first bind to that region.</span></span> <span data-ttu-id="01427-136">Você também pode se inscrever para eventos de dados e alteração de seleção para a região associada.</span><span class="sxs-lookup"><span data-stu-id="01427-136">You can also subscribe to data and selection change events for that bound region.</span></span>

<span data-ttu-id="01427-p108">Você pode adicionar uma associação usando os métodos [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-), [addFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-) ou [addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-) para o objeto [Bindings](/javascript/api/office/office.bindings). Esses métodos retornam um identificador que você pode usar para acessar dados na associação ou para assinar seus eventos de alteração de dados ou alteração de seleção.</span><span class="sxs-lookup"><span data-stu-id="01427-p108">You can add a binding by using [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-), [addFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-), or [addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-) methods of the [Bindings](/javascript/api/office/office.bindings) object. These methods return an identifier that you can use to access data in the binding, or to subscribe to its data change or selection change events.</span></span>

<span data-ttu-id="01427-139">Veja a seguir um exemplo que adiciona uma associação ao texto selecionado no momento em um documento usando o `Bindings.addFromSelectionAsync` método.</span><span class="sxs-lookup"><span data-stu-id="01427-139">The following is an example that adds a binding to the currently selected text in a document, by using the `Bindings.addFromSelectionAsync` method.</span></span>



```js
Office.context.document.bindings.addFromSelectionAsync(
    Office.BindingType.Text, { id: 'myBinding' }, function (asyncResult) {
    if (asyncResult.status == Office.AsyncResultStatus.Failed) {
        write('Action failed. Error: ' + asyncResult.error.message);
    } else {
        write('Added new binding with type: ' +
            asyncResult.value.type + ' and id: ' + asyncResult.value.id);
    }
});

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message; 
}
```

<span data-ttu-id="01427-140">Para saber mais e obter exemplos, consulte [Associar a regiões em um documento ou planilha](bind-to-regions-in-a-document-or-spreadsheet.md).</span><span class="sxs-lookup"><span data-stu-id="01427-140">For more details and examples, see [Bind to regions in a document or spreadsheet](bind-to-regions-in-a-document-or-spreadsheet.md).</span></span>


## <a name="getting-entire-documents"></a><span data-ttu-id="01427-141">Obter documentos inteiros</span><span class="sxs-lookup"><span data-stu-id="01427-141">Getting entire documents</span></span>

<span data-ttu-id="01427-142">Se o suplemento de painel de tarefas for executado no PowerPoint ou no Word, você poderá usar os métodos [Document.getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-), [File.getSliceAsync](/javascript/api/office/office.file#getsliceasync-sliceindex--callback-) e [File.closeAsync](/javascript/api/office/office.file#closeasync-callback-) para obter um documento ou apresentação inteira.</span><span class="sxs-lookup"><span data-stu-id="01427-142">If your task pane add-in runs in PowerPoint or Word, you can use the [Document.getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-), [File.getSliceAsync](/javascript/api/office/office.file#getsliceasync-sliceindex--callback-), and [File.closeAsync](/javascript/api/office/office.file#closeasync-callback-) methods to get an entire presentation or document.</span></span>

<span data-ttu-id="01427-143">Ao chamar `Document.getFileAsync` você obtém uma cópia do documento em um objeto [File](/javascript/api/office/office.file) .</span><span class="sxs-lookup"><span data-stu-id="01427-143">When you call `Document.getFileAsync` you get a copy of the document in a [File](/javascript/api/office/office.file) object.</span></span> <span data-ttu-id="01427-144">O `File` objeto fornece acesso ao documento em "partes" representadas como objetos de [fatia](/javascript/api/office/office.slice) .</span><span class="sxs-lookup"><span data-stu-id="01427-144">The `File` object provides access to the document in "chunks" represented as [Slice](/javascript/api/office/office.slice) objects.</span></span> <span data-ttu-id="01427-145">Ao chamar `getFileAsync` , você pode especificar o tipo de arquivo (texto ou o formato XML do Open Office compactado) e o tamanho das fatias (até 4 MB).</span><span class="sxs-lookup"><span data-stu-id="01427-145">When you call `getFileAsync`, you can specify the file type (text or compressed Open Office XML format), and size of the slices (up to 4MB).</span></span> <span data-ttu-id="01427-146">Para acessar o conteúdo do `File` objeto, você chama `File.getSliceAsync` o que retorna os dados brutos na propriedade [Slice. Data](/javascript/api/office/office.slice#data) .</span><span class="sxs-lookup"><span data-stu-id="01427-146">To access the contents of the `File` object, you then call `File.getSliceAsync` which returns the raw data in the [Slice.data](/javascript/api/office/office.slice#data) property.</span></span> <span data-ttu-id="01427-147">Se tiver especificado o formato compactado, você obterá os dados do arquivo como uma matriz de bytes.</span><span class="sxs-lookup"><span data-stu-id="01427-147">If you specified compressed format, you will get the file data as a byte array.</span></span> <span data-ttu-id="01427-148">Se estiver transmitindo o arquivo para um serviço Web, você poderá transformar os dados brutos compactados em uma cadeia de caracteres codificada na base 64 antes do envio.</span><span class="sxs-lookup"><span data-stu-id="01427-148">If you are transmitting the file to a web service, you can transform the compressed raw data to a base64-encoded string before submission.</span></span> <span data-ttu-id="01427-149">Por fim, quando terminar de obter as fatias do arquivo, use o `File.closeAsync` método para fechar o documento.</span><span class="sxs-lookup"><span data-stu-id="01427-149">Finally, when you are finished getting slices of the file, use the `File.closeAsync` method to close the document.</span></span>

<span data-ttu-id="01427-150">Para saber mais, veja como [obter todo o documento por meio de um suplemento para PowerPoint ou Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span><span class="sxs-lookup"><span data-stu-id="01427-150">For more details, see how to [get the whole document from an add-in for PowerPoint or Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span></span>


## <a name="reading-and-writing-custom-xml-parts-of-a-word-document"></a><span data-ttu-id="01427-151">Ler e gravar partes XML personalizadas de um documento do Word</span><span class="sxs-lookup"><span data-stu-id="01427-151">Reading and writing custom XML parts of a Word document</span></span>

<span data-ttu-id="01427-p110">Usando o formato de arquivo Open Office XML e controles de conteúdo, você pode adicionar partes XML personalizadas a um documento do Word e associar elementos nas partes XML a controles de conteúdo no documento. Quando você abre o documento, o Word lê e popula automaticamente os controles de conteúdo associados com dados das partes XML personalizadas. Os usuários também podem gravar dados nos controles de conteúdo. Quando o usuário salvar o documento, os dados nos controles serão salvos nas partes XML associadas. Suplementos de painel de tarefas do Word podem usar a propriedade [Document.customXmlParts](/javascript/api/office/office.document#customxmlparts) e os objetos [CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart) e [CustomXmlNode](/javascript/api/office/office.customxmlnode) para ler e gravar dados dinamicamente no documento.</span><span class="sxs-lookup"><span data-stu-id="01427-p110">Using the Open Office XML file format and content controls, you can add custom XML parts to a Word document and bind elements in the XML parts to content controls in that document. When you open the document, Word reads and automatically populates bound content controls with data from the custom XML parts. Users can also write data into the content controls, and when the user saves the document, the data in the controls will be saved to the bound XML parts. Task pane add-ins for Word, can use the [Document.customXmlParts](/javascript/api/office/office.document#customxmlparts) property,[CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart), and [CustomXmlNode](/javascript/api/office/office.customxmlnode) objects to read and write data dynamically to the document.</span></span>

<span data-ttu-id="01427-p111">Partes XML personalizadas podem ser associadas a namespaces. Para obter dados de partes XML personalizadas em um namespace, use o método [CustomXmlParts.getByNamespaceAsync](/javascript/api/office/office.customxmlparts#getbynamespaceasync-ns--options--callback-).</span><span class="sxs-lookup"><span data-stu-id="01427-p111">Custom XML parts may be associated with namespaces. To get data from custom XML parts in a namespace, use the [CustomXmlParts.getByNamespaceAsync](/javascript/api/office/office.customxmlparts#getbynamespaceasync-ns--options--callback-) method.</span></span>

<span data-ttu-id="01427-p112">Você também pode usar o método [CustomXmlParts.getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-) para acessar partes XML personalizadas por meio de seus GUIDs. Depois de obter uma parte XML personalizada, use o método [CustomXmlPart.getXmlAsync](/javascript/api/office/office.customxmlpart#getxmlasync-options--callback-) para obter os dados XML.</span><span class="sxs-lookup"><span data-stu-id="01427-p112">You can also use the [CustomXmlParts.getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-) method to access custom XML parts by their GUIDs. After getting a custom XML part, use the [CustomXmlPart.getXmlAsync](/javascript/api/office/office.customxmlpart#getxmlasync-options--callback-) method to get the XML data.</span></span>

<span data-ttu-id="01427-160">Para adicionar uma nova parte XML personalizada a um documento, use a `Document.customXmlParts` propriedade para obter as partes XML personalizadas que estão no documento e chame o método [CustomXmlParts. addasync](/javascript/api/office/office.customxmlparts#addasync-xml--options--callback-) .</span><span class="sxs-lookup"><span data-stu-id="01427-160">To add a new custom XML part to a document, use the `Document.customXmlParts` property to get the custom XML parts that are in the document, and call the [CustomXmlParts.addAsync](/javascript/api/office/office.customxmlparts#addasync-xml--options--callback-) method.</span></span>

<span data-ttu-id="01427-161">Para saber mais sobre como trabalhar com partes XML personalizadas em um suplemento de painel de tarefas, consulte [Criar suplementos melhores para o Word com o Office Open XML](../word/create-better-add-ins-for-word-with-office-open-xml.md).</span><span class="sxs-lookup"><span data-stu-id="01427-161">For detailed information about how to work with custom XML parts with a task pane add-in, see [Creating Better Add-ins for Word with Office Open XML](../word/create-better-add-ins-for-word-with-office-open-xml.md).</span></span>


## <a name="persisting-add-in-settings"></a><span data-ttu-id="01427-162">Persistir configurações de suplemento</span><span class="sxs-lookup"><span data-stu-id="01427-162">Persisting add-in settings</span></span>


<span data-ttu-id="01427-163">Muitas vezes, você precisa salvar dados personalizados no suplemento, como preferências do usuário ou o estado do suplemento, e acessar esses dados na próxima vez que o suplemento for aberto.</span><span class="sxs-lookup"><span data-stu-id="01427-163">Often you need to save custom data for your add-in, such as a user's preferences or the add-in's state, and access that data the next time the add-in is opened.</span></span> <span data-ttu-id="01427-164">Você pode usar técnicas de programação comuns para salvar os dados, como cookies do navegador ou armazenamento na Web em HTML 5.</span><span class="sxs-lookup"><span data-stu-id="01427-164">You can use common web programming techniques to save that data, such as browser cookies or HTML 5 web storage.</span></span> <span data-ttu-id="01427-165">Como alternativa, se o suplemento for executado no Excel, no PowerPoint ou no Word, você poderá usar os métodos do objeto [Settings](/javascript/api/office/office.settings).</span><span class="sxs-lookup"><span data-stu-id="01427-165">Alternatively, if your add-in runs in Excel, PowerPoint, or Word, you can use the methods of the [Settings](/javascript/api/office/office.settings) object.</span></span> <span data-ttu-id="01427-166">Os dados criados com o `Settings` objeto são armazenados na planilha, apresentação ou documento no qual o suplemento foi inserido e salvo.</span><span class="sxs-lookup"><span data-stu-id="01427-166">Data created with the `Settings` object is stored in the spreadsheet, presentation, or document that the add-in was inserted into and saved with.</span></span> <span data-ttu-id="01427-167">Esses dados estão disponíveis apenas para o suplemento que os criou.</span><span class="sxs-lookup"><span data-stu-id="01427-167">This data is available to only the add-in that created it.</span></span>

<span data-ttu-id="01427-168">Para evitar viagens de ida e volta ao servidor onde o documento está armazenado, os dados criados com o `Settings` objeto são gerenciados na memória em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="01427-168">To avoid roundtrips to the server where the document is stored, data created with the `Settings` object is managed in memory at run time.</span></span> <span data-ttu-id="01427-169">Dados de configurações salvos anteriormente são carregados na memória quando o suplemento é inicializado, e alterações nesses dados só são salvas de volta para o documento quando você chama o método [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-).</span><span class="sxs-lookup"><span data-stu-id="01427-169">Previously saved settings data is loaded into memory when the add-in is initialized, and changes to that data are only saved back to the document when you call the [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-) method.</span></span> <span data-ttu-id="01427-170">Internamente, os dados são armazenados em um objeto JSON serializado como pares de nome/valor.</span><span class="sxs-lookup"><span data-stu-id="01427-170">Internally, the data is stored in a serialized JSON object as name/value pairs.</span></span> <span data-ttu-id="01427-171">Você usa os métodos [get](/javascript/api/office/office.settings#get-name-), [set](/javascript/api/office/office.settings#set-name--value-) e [remove](/javascript/api/office/office.settings#remove-name-) para o objeto **Settings**, para ler, gravar e excluir itens da cópia dos dados na memória.</span><span class="sxs-lookup"><span data-stu-id="01427-171">You use the [get](/javascript/api/office/office.settings#get-name-), [set](/javascript/api/office/office.settings#set-name--value-), and [remove](/javascript/api/office/office.settings#remove-name-) methods of the **Settings** object, to read, write, and delete items from the in-memory copy of the data.</span></span> <span data-ttu-id="01427-172">A linha de código a seguir mostra como criar uma configuração denominada `themeColor` e definir seu valor como 'verde'.</span><span class="sxs-lookup"><span data-stu-id="01427-172">The following line of code shows how to create a setting named `themeColor` and set its value to 'green'.</span></span>




```js
Office.context.document.settings.set('themeColor', 'green');
```

<span data-ttu-id="01427-173">Como os dados de configurações criados ou excluídos com os `set` `remove` métodos e estão agindo em uma cópia na memória dos dados, você deve chamar `saveAsync` para manter as alterações nos dados de configurações no documento com o qual o suplemento está trabalhando.</span><span class="sxs-lookup"><span data-stu-id="01427-173">Because settings data created or deleted with the `set` and `remove` methods is acting on an in-memory copy of the data, you must call `saveAsync` to persist changes to settings data into the document your add-in is working with.</span></span>

<span data-ttu-id="01427-174">Para obter mais detalhes sobre como trabalhar com dados personalizados usando os métodos do `Settings` objeto, consulte [persistendo o estado e as configurações do suplemento](persisting-add-in-state-and-settings.md).</span><span class="sxs-lookup"><span data-stu-id="01427-174">For more details about working with custom data using the methods of the `Settings` object, see [Persisting add-in state and settings](persisting-add-in-state-and-settings.md).</span></span>


## <a name="reading-properties-of-a-project-document"></a><span data-ttu-id="01427-175">Ler propriedades de um documento do Project</span><span class="sxs-lookup"><span data-stu-id="01427-175">Reading properties of a project document</span></span>

<span data-ttu-id="01427-176">Se o suplemento de painel de tarefas for executado no Project, o suplemento poderá ler dados de alguns dos campos de projeto, recursos e campos de tarefa do projeto ativo.</span><span class="sxs-lookup"><span data-stu-id="01427-176">If your task pane add-in runs in Project, your add-in can read data from some of the project fields, resource, and task fields in the active project.</span></span> <span data-ttu-id="01427-177">Para fazer isso, você usa os métodos e os eventos do objeto [ProjectDocument](/javascript/api/office/office.document) , que estende o `Document` objeto para fornecer funcionalidade adicional específica do projeto.</span><span class="sxs-lookup"><span data-stu-id="01427-177">To do that, you use the methods and events of the [ProjectDocument](/javascript/api/office/office.document) object, which extends the `Document` object to provide additional Project-specific functionality.</span></span>

<span data-ttu-id="01427-178">Para obter exemplos de leitura de dados do Project, consulte [Criar seu primeiro suplemento de painel de tarefas do Project 2013 usando um editor de texto](../project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor.md).</span><span class="sxs-lookup"><span data-stu-id="01427-178">For examples of reading Project data, see [Create your first task pane add-in for Project 2013 by using a text editor](../project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor.md).</span></span>


## <a name="permissions-model-and-governance"></a><span data-ttu-id="01427-179">Modelo de permissões e governança</span><span class="sxs-lookup"><span data-stu-id="01427-179">Permissions model and governance</span></span>

<span data-ttu-id="01427-180">Seu suplemento usa o `Permissions` elemento em seu manifesto para solicitar permissão para acessar o nível de funcionalidade que ele requer da API JavaScript do Office.</span><span class="sxs-lookup"><span data-stu-id="01427-180">Your add-in uses the `Permissions` element in its manifest to request permission to access the level of functionality it requires from the Office JavaScript API.</span></span> <span data-ttu-id="01427-181">Por exemplo, se seu suplemento requer acesso de leitura/gravação ao documento, seu manifesto deve especificar `ReadWriteDocument` como o valor de texto em seu `Permissions` elemento.</span><span class="sxs-lookup"><span data-stu-id="01427-181">For example, if your add-in requires read/write access to the document, its manifest must specify `ReadWriteDocument` as the text value in its `Permissions` element.</span></span> <span data-ttu-id="01427-182">Uma vez existem permissões para proteger a privacidade e a segurança do usuário, como prática recomendada, você deve solicitar o nível mínimo de permissões necessárias para seus recursos.</span><span class="sxs-lookup"><span data-stu-id="01427-182">Because permissions exist to protect a user's privacy and security, as a best practice you should request the minimum level of permissions it needs for its features.</span></span> <span data-ttu-id="01427-183">O exemplo a seguir mostra como solicitar a permissão **ReadDocument** no manifesto de um painel de tarefas.</span><span class="sxs-lookup"><span data-stu-id="01427-183">The following example shows how to request the **ReadDocument** permission in a task pane's manifest.</span></span>


```XML
<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.0"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
 xsi:type="TaskPaneApp">
???<!-- Other manifest elements omitted. -->
  <Permissions>ReadDocument</Permissions>
???
</OfficeApp>

```

<span data-ttu-id="01427-184">Para obter mais informações, consulte [solicitar permissões para uso da API em suplementos](requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="01427-184">For more information, see [Requesting permissions for API use in add-ins](requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span></span>


## <a name="see-also"></a><span data-ttu-id="01427-185">Confira também</span><span class="sxs-lookup"><span data-stu-id="01427-185">See also</span></span>

- [<span data-ttu-id="01427-186">API JavaScript para Office</span><span class="sxs-lookup"><span data-stu-id="01427-186">Office JavaScript API</span></span>](../reference/javascript-api-for-office.md)
- [<span data-ttu-id="01427-187">Referência de esquema para os manifestos dos Suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="01427-187">Schema reference for Office Add-ins manifests</span></span>](../develop/add-in-manifests.md)
- [<span data-ttu-id="01427-188">Solucionar erros de usuários com Suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="01427-188">Troubleshoot user errors with Office Add-ins</span></span>](../testing/testing-and-troubleshooting.md)
