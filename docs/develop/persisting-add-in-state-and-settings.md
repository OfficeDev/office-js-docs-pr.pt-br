---
title: Persistir o estado e as configurações do suplemento
description: Aprenda a persistir dados em aplicativos Web do Office Add-in em execução no ambiente sem estado de um controle do navegador.
ms.date: 03/23/2021
localization_priority: Normal
ms.openlocfilehash: 47f1b9a5000660f13f8bba5e747d0f5ca5e9d6a0
ms.sourcegitcommit: 54fef33bfc7d18a35b3159310bbd8b1c8312f845
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/09/2021
ms.locfileid: "51651076"
---
# <a name="persisting-add-in-state-and-settings"></a><span data-ttu-id="f7ac4-103">Persistir o estado e as configurações do suplemento</span><span class="sxs-lookup"><span data-stu-id="f7ac4-103">Persisting add-in state and settings</span></span>

[!include[information about the common API](../includes/alert-common-api-info.md)]

<span data-ttu-id="f7ac4-p101">Essencialmente, os suplementos do Office são aplicativos Web em execução no ambiente sem estado de um controle de navegador. Como resultado, talvez o suplemento precise persistir dados para manter a continuidade de determinados recursos ou operações entre sessões de uso do suplemento. Por exemplo, o suplemento pode ter configurações personalizadas ou outros valores que precisa salvar e recarregar na próxima vez em que for inicializado, como o modo de exibição preferido ou o local padrão de um usuário. Para fazer isso, você pode:</span><span class="sxs-lookup"><span data-stu-id="f7ac4-p101">Office Add-ins are essentially web applications running in the stateless environment of a browser control. As a result, your add-in may need to persist data to maintain the continuity of certain operations or features across sessions of using your add-in. For example, your add-in may have custom settings or other values that it needs to save and reload the next time it's initialized, such as a user's preferred view or default location. To do that, you can:</span></span>

- <span data-ttu-id="f7ac4-108">Use membros da API JavaScript do Office que armazenam dados como:</span><span class="sxs-lookup"><span data-stu-id="f7ac4-108">Use members of the Office JavaScript API that store data as either:</span></span>
  - <span data-ttu-id="f7ac4-109">Pares de nome/valor em um recipiente de propriedades armazenado em um local que depende do tipo de suplemento.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-109">Name/value pairs in a property bag stored in a location that depends on add-in type.</span></span>
  - <span data-ttu-id="f7ac4-110">XML personalizado armazenado no documento.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-110">Custom XML stored in the document.</span></span>

- <span data-ttu-id="f7ac4-111">Usar técnicas fornecidas pelo controle de navegador subjacente: cookies de navegador ou armazenamento Web HTML5 ([localStorage](https://developer.mozilla.org/docs/Web/API/Window/localStorage) ou [sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage)).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-111">Use techniques provided by the underlying browser control: browser cookies, or HTML5 web storage ([localStorage](https://developer.mozilla.org/docs/Web/API/Window/localStorage) or [sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage)).</span></span>
    > [!NOTE]
    > <span data-ttu-id="f7ac4-112">O usuário pode bloquear técnicas de armazenamento baseadas em navegador, dependendo das configurações escolhidas.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-112">The user can block browser-based storage techniques depending on the settings they choose.</span></span>

<span data-ttu-id="f7ac4-113">Este artigo se concentra em como usar a API JavaScript do Office para manter o estado do add-in para o documento atual.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-113">This article focuses on how to use the Office JavaScript API to persist add-in state to the current document.</span></span> <span data-ttu-id="f7ac4-114">Se você precisar manter o estado entre documentos, como controlar as preferências do usuário em todos os documentos abertos, você precisará usar uma abordagem diferente.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-114">If you need to persist state across documents, such as tracking user preferences across any documents they open, you will need to use a different approach.</span></span> <span data-ttu-id="f7ac4-115">Por exemplo, você pode usar [o SSO](sso-in-office-add-ins.md#using-the-sso-token-as-an-identity) para obter a identidade do usuário e salvar a ID do usuário e suas configurações em um banco de dados online.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-115">For example, you could use [SSO](sso-in-office-add-ins.md#using-the-sso-token-as-an-identity) to obtain the user identity, and then save the user ID and their settings to an online database.</span></span>

## <a name="persisting-add-in-state-and-settings-with-the-office-javascript-api"></a><span data-ttu-id="f7ac4-116">Persistir o estado e as configurações do add-in com a API JavaScript do Office</span><span class="sxs-lookup"><span data-stu-id="f7ac4-116">Persisting add-in state and settings with the Office JavaScript API</span></span>

<span data-ttu-id="f7ac4-117">A API JavaScript do Office fornece os objetos [Settings](/javascript/api/office/office.settings), [RoamingSettings](/javascript/api/outlook/office.roamingsettings)e [CustomProperties](/javascript/api/outlook/office.customproperties) para salvar o estado do complemento entre as sessões, conforme descrito na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-117">The Office JavaScript API provides the [Settings](/javascript/api/office/office.settings), [RoamingSettings](/javascript/api/outlook/office.roamingsettings), and [CustomProperties](/javascript/api/outlook/office.customproperties) objects for saving add-in state across sessions as described in the following table.</span></span> <span data-ttu-id="f7ac4-118">Em todos os casos, os valores de configurações salvos são associados à [Id](../reference/manifest/id.md) do suplemento que os criou.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-118">In all cases, the saved settings values are associated with the [Id](../reference/manifest/id.md) of the add-in that created them.</span></span>

|<span data-ttu-id="f7ac4-119">**Object**</span><span class="sxs-lookup"><span data-stu-id="f7ac4-119">**Object**</span></span>|<span data-ttu-id="f7ac4-120">**Suporte a tipos de suplementos**</span><span class="sxs-lookup"><span data-stu-id="f7ac4-120">**Add-in type support**</span></span>|<span data-ttu-id="f7ac4-121">**Local de armazenamento**</span><span class="sxs-lookup"><span data-stu-id="f7ac4-121">**Storage location**</span></span>|<span data-ttu-id="f7ac4-122">**Suporte a aplicativos do Office**</span><span class="sxs-lookup"><span data-stu-id="f7ac4-122">**Office application support**</span></span>|
|:-----|:-----|:-----|:-----|
|[<span data-ttu-id="f7ac4-123">Configurações</span><span class="sxs-lookup"><span data-stu-id="f7ac4-123">Settings</span></span>](/javascript/api/office/office.settings)|<span data-ttu-id="f7ac4-124">conteúdo e painel de tarefas</span><span class="sxs-lookup"><span data-stu-id="f7ac4-124">content and task pane</span></span>|<span data-ttu-id="f7ac4-125">O documento, planilha ou apresentação com o qual o suplemento está trabalhando.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-125">The document, spreadsheet, or presentation the add-in is working with.</span></span> <span data-ttu-id="f7ac4-126">As configurações de add-in de conteúdo e painel de tarefas estão disponíveis para o complemento que os criou a partir do documento em que são salvos.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-126">Content and task pane add-in settings are available to the add-in that created them from the document where they are saved.</span></span><br/><br/><span data-ttu-id="f7ac4-p105">**Importante:** não armazene senhas e outras IIP (informações de identificação pessoal) confidenciais com o objeto **Settings**. Os dados salvos não ficam visíveis para os usuários finais, mas são armazenados como parte do documento, que pode ser acessado pela leitura direta do formato de arquivo do documento. Você deve limitar o uso de PII pelo suplemento e armazenar quaisquer itens de PII necessários ao suplemento somente no servidor que hospeda o suplemento como um recurso protegido pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-p105">**Important:** Don't store passwords and other sensitive personally identifiable information (PII) with the **Settings** object. The data saved isn't visible to end users, but it is stored as part of the document, which is accessible by reading the document's file format directly. You should limit your add-in's use of PII and store any PII required by your add-in only on the server hosting your add-in as a user-secured resource.</span></span>|<span data-ttu-id="f7ac4-130">Word, Excel ou PowerPoint</span><span class="sxs-lookup"><span data-stu-id="f7ac4-130">Word, Excel, or PowerPoint</span></span><br/><br/> <span data-ttu-id="f7ac4-131">**Observação:** os suplementos de painel de tarefas para o Project 2013 não dão suporte à API **Settings** para o armazenamento do estado ou das configurações do suplemento.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-131">**Note:** Task pane add-ins for Project 2013 don't support the **Settings** API for storing add-in state or settings.</span></span> <span data-ttu-id="f7ac4-132">No entanto, para os complementos em execução no Project (assim como outros aplicativos cliente do Office), você pode usar técnicas como cookies de navegador ou armazenamento da Web.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-132">However, for add-ins running in Project (as well as other Office client applications) you can use techniques such as browser cookies or web storage.</span></span> <span data-ttu-id="f7ac4-133">Para saber mais sobre essas técnicas, confira [Excel-Add-in-JavaScript-PersistCustomSettings](https://github.com/OfficeDev/Excel-Add-in-JavaScript-PersistCustomSettings).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-133">For more information on these techniques, see the [Excel-Add-in-JavaScript-PersistCustomSettings](https://github.com/OfficeDev/Excel-Add-in-JavaScript-PersistCustomSettings).</span></span> |
|[<span data-ttu-id="f7ac4-134">RoamingSettings</span><span class="sxs-lookup"><span data-stu-id="f7ac4-134">RoamingSettings</span></span>](/javascript/api/outlook/office.roamingsettings)|<span data-ttu-id="f7ac4-135">Outlook</span><span class="sxs-lookup"><span data-stu-id="f7ac4-135">Outlook</span></span>|<span data-ttu-id="f7ac4-136">A caixa de correio do servidor Exchange do usuário onde o complemento está instalado.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-136">The user's Exchange server mailbox where the add-in is installed.</span></span> <span data-ttu-id="f7ac4-137">Como essas configurações são armazenadas na caixa de correio do servidor do usuário, elas podem "circular" com o usuário e estão disponíveis para o add-in quando ele está sendo executado no contexto de qualquer aplicativo cliente do Office ou navegador com suporte acessando a caixa de correio desse usuário.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-137">Because these settings are stored in the user's server mailbox, they can "roam" with the user and are available to the add-in when it is running in the context of any supported Office client application or browser accessing that user's mailbox.</span></span><br/><br/> <span data-ttu-id="f7ac4-138">As configurações móveis de suplementos do Outlook estão disponíveis apenas para o suplemento que os criou e somente por meio da caixa de correio em que o suplemento está instalado.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-138">Outlook add-in roaming settings are available only to the add-in that created them, and only from the mailbox where the add-in is installed.</span></span>|<span data-ttu-id="f7ac4-139">Outlook</span><span class="sxs-lookup"><span data-stu-id="f7ac4-139">Outlook</span></span>|
|[<span data-ttu-id="f7ac4-140">CustomProperties</span><span class="sxs-lookup"><span data-stu-id="f7ac4-140">CustomProperties</span></span>](/javascript/api/outlook/office.customproperties)|<span data-ttu-id="f7ac4-141">Outlook</span><span class="sxs-lookup"><span data-stu-id="f7ac4-141">Outlook</span></span>|<span data-ttu-id="f7ac4-p108">A mensagem, o compromisso ou o item de solicitação de reunião com o qual o suplemento está trabalhando. As propriedades personalizadas de itens de suplementos do Outlook estão disponíveis apenas para o suplemento que as criou e apenas por meio do item em que estão salvas.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-p108">The message, appointment, or meeting request item the add-in is working with. Outlook add-in item custom properties are available only to the add-in that created them, and only from the item where they are saved.</span></span>|<span data-ttu-id="f7ac4-144">Outlook</span><span class="sxs-lookup"><span data-stu-id="f7ac4-144">Outlook</span></span>|
|[<span data-ttu-id="f7ac4-145">CustomXmlParts</span><span class="sxs-lookup"><span data-stu-id="f7ac4-145">CustomXmlParts</span></span>](/javascript/api/office/office.customxmlparts)|<span data-ttu-id="f7ac4-146">painel de tarefas</span><span class="sxs-lookup"><span data-stu-id="f7ac4-146">task pane</span></span>|<span data-ttu-id="f7ac4-p109">O documento, planilha ou apresentação com o qual o suplemento está trabalhando. As configurações de suplementos do painel de tarefas estão disponíveis para o suplemento que as criou por meio do documento em que são salvos.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-p109">The document, spreadsheet, or presentation the add-in is working with. Task pane add-in settings are available to the add-in that created them from the document where they are saved.</span></span><br/><br/><span data-ttu-id="f7ac4-p110">**Importante:** não armazene senhas e outras IIP (informações de identificação pessoal) confidenciais em uma parte XML personalizada. objeto. Os dados salvos não ficam visíveis para os usuários finais, mas são armazenados como parte do documento, que pode ser acessado pela leitura direta do formato de arquivo do documento. Você deve limitar o uso de PII pelo suplemento e armazenar quaisquer itens de PII necessários ao suplemento somente no servidor que hospeda o suplemento como um recurso protegido pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-p110">**Important:** Don't store passwords and other sensitive personally identifiable information (PII) in a custom XML part. The data saved isn't visible to end users, but it is stored as part of the document, which is accessible by reading the document's file format directly. You should limit your add-in's use of PII and store any PII required by your add-in only on the server hosting your add-in as a user-secured resource.</span></span>|<span data-ttu-id="f7ac4-152">Word (usando a API Comum javascript do Office) Excel (usando a API JavaScript do Excel específica do aplicativo</span><span class="sxs-lookup"><span data-stu-id="f7ac4-152">Word (using the Office JavaScript Common API) Excel (using the application-specific Excel JavaScript API</span></span>|

## <a name="settings-data-is-managed-in-memory-at-runtime"></a><span data-ttu-id="f7ac4-153">Os dados de configurações são gerenciados na memória no tempo de execução</span><span class="sxs-lookup"><span data-stu-id="f7ac4-153">Settings data is managed in memory at runtime</span></span>

> [!NOTE]
> <span data-ttu-id="f7ac4-154">As duas seções a seguir discutem configurações no contexto da API comum de JavaScript do Office.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-154">The following two sections discuss settings in the context of the Office Common JavaScript API.</span></span> <span data-ttu-id="f7ac4-155">A API JavaScript do Excel específica do aplicativo também fornece acesso às configurações personalizadas.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-155">The application-specific Excel JavaScript API also provides access to the custom settings.</span></span> <span data-ttu-id="f7ac4-156">As APIs do Excel e os padrões de programação são um pouco diferentes.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-156">The Excel APIs and programming patterns are somewhat different.</span></span> <span data-ttu-id="f7ac4-157">Para saber mais, confira [SettingCollection do Excel](/javascript/api/excel/excel.settingcollection).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-157">For more information, see [Excel SettingCollection](/javascript/api/excel/excel.settingcollection).</span></span>

<span data-ttu-id="f7ac4-158">Internamente, os dados no pacote de propriedades acessados com o objeto , ou objetos são armazenados como um objeto JSON (Notação de Objeto JavaScript serializado) que contém pares de `Settings` `CustomProperties` `RoamingSettings` nome/valor.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-158">Internally, the data in the property bag accessed with the `Settings`, `CustomProperties`, or `RoamingSettings` objects is stored as a serialized JavaScript Object Notation (JSON) object that contains name/value pairs.</span></span> <span data-ttu-id="f7ac4-159">O nome (chave) para cada valor deve ser um , e o valor armazenado pode ser `string` um JavaScript `string` , , , ou , mas não uma `number` `date` `object` **função**.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-159">The name (key) for each value must be a `string`, and the stored value can be a JavaScript `string`, `number`, `date`, or `object`, but not a **function**.</span></span>

<span data-ttu-id="f7ac4-160">Este exemplo da estrutura do conjunto de propriedades contém três valores de **cadeia de caracteres** definidos nomeados como `firstName`, `location` e `defaultView`.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-160">This example of the property bag structure contains three defined **string** values named `firstName`,  `location`, and  `defaultView`.</span></span>

```json
{
    "firstName":"Erik",
    "location":"98052",
    "defaultView":"basic"
}
```

<span data-ttu-id="f7ac4-161">Depois que o conjunto de propriedades de configurações é salvo durante a sessão anterior do suplemento, ele pode ser carregado quando o suplemento é inicializado ou a qualquer momento depois disso durante a sessão atual do suplemento.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-161">After the settings property bag is saved during the previous add-in session, it can be loaded when the add-in is initialized or at any point after that during the add-in's current session.</span></span> <span data-ttu-id="f7ac4-162">Durante a sessão, as configurações são gerenciadas inteiramente na memória usando os métodos , e do objeto que corresponde ao tipo de configuração que você está criando `get` `set` ( `remove` **Configurações,** **CustomProperties** ou **RoamingSettings**).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-162">During the session, the settings are managed in entirely in memory using the `get`, `set`, and `remove` methods of the object that corresponds to the kind of settings you are creating (**Settings**, **CustomProperties**, or **RoamingSettings**).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f7ac4-163">Para persistir quaisquer adições, atualizações ou exclusões feitas durante a sessão atual do add-in para o local de armazenamento, você deve chamar o método do objeto correspondente usado para trabalhar com esse tipo de `saveAsync` configurações.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-163">To persist any additions, updates, or deletions made during the add-in's current session to the storage location, you must call the `saveAsync` method of the corresponding object used to work with that kind of settings.</span></span> <span data-ttu-id="f7ac4-164">Os métodos , e operam somente na cópia na `get` memória do pacote de propriedades de `set` `remove` configurações.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-164">The `get`, `set`, and `remove` methods operate only on the in-memory copy of the settings property bag.</span></span> <span data-ttu-id="f7ac4-165">Se o seu add-in estiver fechado sem chamar , quaisquer alterações feitas nas configurações `saveAsync` durante essa sessão serão perdidas.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-165">If your add-in is closed without calling `saveAsync`, any changes made to settings during that session will be lost.</span></span>

## <a name="how-to-save-add-in-state-and-settings-per-document-for-content-and-task-pane-add-ins"></a><span data-ttu-id="f7ac4-166">Como salvar o estado e as configurações do suplemento por documento para suplementos de conteúdo e de painel de tarefas</span><span class="sxs-lookup"><span data-stu-id="f7ac4-166">How to save add-in state and settings per document for content and task pane add-ins</span></span>

<span data-ttu-id="f7ac4-167">Para persistir as configurações de estado ou personalizadas de um suplemento de conteúdo ou de painel de tarefas para Word, Excel ou PowerPoint, use o objeto [Settings](/javascript/api/office/office.settings) e seus métodos.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-167">To persist state or custom settings of a content or task pane add-in for Word, Excel, or PowerPoint, you use the [Settings](/javascript/api/office/office.settings) object and its methods.</span></span> <span data-ttu-id="f7ac4-168">O pacote de propriedades criado com os métodos do objeto estão disponíveis apenas para a instância do conteúdo ou do complemento do painel de tarefas que o criou e somente no documento no qual ele `Settings` é salvo.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-168">The property bag created with the methods of the `Settings` object are available only to the instance of the content or task pane add-in that created it, and only from the document in which it is saved.</span></span>

<span data-ttu-id="f7ac4-169">O objeto é carregado automaticamente como parte do objeto Document e está disponível quando o painel de tarefas ou o complemento de conteúdo `Settings` é ativado. [](/javascript/api/office/office.document)</span><span class="sxs-lookup"><span data-stu-id="f7ac4-169">The `Settings` object is automatically loaded as part of the [Document](/javascript/api/office/office.document) object, and is available when the task pane or content add-in is activated.</span></span> <span data-ttu-id="f7ac4-170">Depois que `Document` o objeto é instaurou, você pode acessar o objeto com a `Settings` propriedade [settings](/javascript/api/office/office.document#settings) do `Document` objeto.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-170">After the `Document` object is instantiated, you can access the `Settings` object with the [settings](/javascript/api/office/office.document#settings) property of the `Document` object.</span></span> <span data-ttu-id="f7ac4-171">Durante o tempo de vida da sessão, você pode apenas usar os métodos , e para ler, gravar ou remover as configurações persistentes e o estado do complemento da cópia na memória do pacote de `Settings.get` `Settings.set` `Settings.remove` propriedades.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-171">During the lifetime of the session, you can just use the `Settings.get`, `Settings.set`, and `Settings.remove` methods to read, write, or remove persisted settings and add-in state from the in-memory copy of the property bag.</span></span>

<span data-ttu-id="f7ac4-172">Como os métodos set e remove operam apenas em relação à cópia na memória do conjunto de propriedades de configurações, para salvar configurações novas ou alteradas no documento ao qual o suplemento está associado, você deve chamar o método [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-172">Because the set and remove methods operate against only the in-memory copy of the settings property bag, to save new or changed settings back to the document the add-in is associated with you must call the [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-) method.</span></span>

### <a name="creating-or-updating-a-setting-value"></a><span data-ttu-id="f7ac4-173">Criar ou atualizar um valor de configuração</span><span class="sxs-lookup"><span data-stu-id="f7ac4-173">Creating or updating a setting value</span></span>

<span data-ttu-id="f7ac4-p117">O exemplo de código a seguir mostra como usar o método [Settings.set](/javascript/api/office/office.settings#set-name--value-) para criar uma configuração chamada `'themeColor'` com um valor `'green'`. O primeiro parâmetro do método set é _name_ (Id) da configuração a ser definida ou criada, que diferencia maiúsculas de minúsculas. O segundo parâmetro é o _value_ da configuração.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-p117">The following code example shows how to use the [Settings.set](/javascript/api/office/office.settings#set-name--value-) method to create a setting called `'themeColor'` with a value `'green'`. The first parameter of the set method is the case-sensitive  _name_ (Id) of the setting to set or create. The second parameter is the _value_ of the setting.</span></span>

```js
Office.context.document.settings.set('themeColor', 'green');
```

 <span data-ttu-id="f7ac4-177">A configuração com o nome especificado é criada se ainda não existir, ou seu valor é atualizado se já existir.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-177">The setting with the specified name is created if it doesn't already exist, or its value is updated if it does exist.</span></span> <span data-ttu-id="f7ac4-178">Use o `Settings.saveAsync` método para manter as configurações novas ou atualizadas no documento.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-178">Use the `Settings.saveAsync` method to persist the new or updated settings to the document.</span></span>

### <a name="getting-the-value-of-a-setting"></a><span data-ttu-id="f7ac4-179">Obter o valor de uma configuração</span><span class="sxs-lookup"><span data-stu-id="f7ac4-179">Getting the value of a setting</span></span>

<span data-ttu-id="f7ac4-180">O exemplo a seguir mostra como usar o método [Settings.get](/javascript/api/office/office.settings#get-name-) para obter o valor de uma configuração chamada "themeColor".</span><span class="sxs-lookup"><span data-stu-id="f7ac4-180">The following example shows how use the [Settings.get](/javascript/api/office/office.settings#get-name-) method to get the value of a setting called "themeColor".</span></span> <span data-ttu-id="f7ac4-181">O único parâmetro do `get` método é o nome sensível a _caso_ da configuração.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-181">The only parameter of the `get` method is the case-sensitive _name_ of the setting.</span></span>

```js
write('Current value for mySetting: ' + Office.context.document.settings.get('themeColor'));

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message;
}
```

 <span data-ttu-id="f7ac4-182">O `get` método retorna o valor que foi salvo anteriormente para o nome de _configuração_ que foi passado.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-182">The `get` method returns the value that was previously saved for the setting _name_ that was passed in.</span></span> <span data-ttu-id="f7ac4-183">Se a configuração não existir, o método retornará **null**.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-183">If the setting doesn't exist, the method returns **null**.</span></span>

### <a name="removing-a-setting"></a><span data-ttu-id="f7ac4-184">Remover uma configuração</span><span class="sxs-lookup"><span data-stu-id="f7ac4-184">Removing a setting</span></span>

<span data-ttu-id="f7ac4-185">O exemplo a seguir mostra como usar o método [Settings.remove](/javascript/api/office/office.settings#remove-name-) para remover uma configuração com o nome "themeColor".</span><span class="sxs-lookup"><span data-stu-id="f7ac4-185">The following example shows how to use the [Settings.remove](/javascript/api/office/office.settings#remove-name-) method to remove a setting with the name "themeColor".</span></span> <span data-ttu-id="f7ac4-186">O único parâmetro do `remove` método é o nome sensível a _caso_ da configuração.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-186">The only parameter of the `remove` method is the case-sensitive _name_ of the setting.</span></span>

```js
Office.context.document.settings.remove('themeColor');
```

<span data-ttu-id="f7ac4-187">Nada acontecerá se a configuração não existir.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-187">Nothing will happen if the setting does not exist.</span></span> <span data-ttu-id="f7ac4-188">Use o `Settings.saveAsync` método para persistir a remoção da configuração do documento.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-188">Use the `Settings.saveAsync` method to persist removal of the setting from the document.</span></span>

### <a name="saving-your-settings"></a><span data-ttu-id="f7ac4-189">Salvar suas configurações</span><span class="sxs-lookup"><span data-stu-id="f7ac4-189">Saving your settings</span></span>

<span data-ttu-id="f7ac4-190">Para salvar adições, alterações ou exclusões que o suplemento fez na cópia na memória do conjunto de propriedades de configurações durante a sessão atual, você deve chamar o método [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-) para armazená-lo no documento.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-190">To save any additions, changes, or deletions your add-in made to the in-memory copy of the settings property bag during the current session, you must call the [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-) method to store them in the document.</span></span> <span data-ttu-id="f7ac4-191">O único parâmetro do método é retorno de chamada , que é uma função de retorno de `saveAsync` chamada com um único parâmetro. </span><span class="sxs-lookup"><span data-stu-id="f7ac4-191">The only parameter of the `saveAsync` method is _callback_, which is a callback function with a single parameter.</span></span>

```js
Office.context.document.settings.saveAsync(function (asyncResult) {
    if (asyncResult.status == Office.AsyncResultStatus.Failed) {
        write('Settings save failed. Error: ' + asyncResult.error.message);
    } else {
        write('Settings saved.');
    }
});
// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message;
}
```

<span data-ttu-id="f7ac4-192">A função anônima passada para o método como o parâmetro `saveAsync` _callback_ é executada quando a operação é concluída.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-192">The anonymous function passed into the `saveAsync` method as the _callback_ parameter is executed when the operation is completed.</span></span> <span data-ttu-id="f7ac4-193">O _parâmetro asyncResult_ do retorno de chamada fornece acesso a um objeto que contém `AsyncResult` o status da operação.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-193">The _asyncResult_ parameter of the callback provides access to an `AsyncResult` object that contains the status of the operation.</span></span> <span data-ttu-id="f7ac4-194">No exemplo, a função verifica a propriedade para ver se a operação de salvar foi bem-sucedida ou falhou e exibe o resultado na página `AsyncResult.status` do complemento.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-194">In the example, the function checks the `AsyncResult.status` property to see if the save operation succeeded or failed, and then displays the result in the add-in's page.</span></span>

## <a name="how-to-save-custom-xml-to-the-document"></a><span data-ttu-id="f7ac4-195">Como salvar XML personalizado no documento</span><span class="sxs-lookup"><span data-stu-id="f7ac4-195">How to save custom XML to the document</span></span>

> [!NOTE]
> <span data-ttu-id="f7ac4-196">Esta seção discute as partes XML no contexto da API comum do JavaScript do Office com suporte no Word.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-196">This section discusses custom XML parts in the context of the Office Common JavaScript API which is supported in Word.</span></span> <span data-ttu-id="f7ac4-197">A API JavaScript do Excel específica do aplicativo também fornece acesso às partes XML personalizadas.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-197">The application-specific Excel JavaScript API also provides access to the custom XML parts.</span></span> <span data-ttu-id="f7ac4-198">As APIs do Excel e os padrões de programação são um pouco diferentes.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-198">The Excel APIs and programming patterns are somewhat different.</span></span> <span data-ttu-id="f7ac4-199">Para saber mais, confira [Excel CustomXmlPart](/javascript/api/excel/excel.customxmlpart).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-199">For more information, see [Excel CustomXmlPart](/javascript/api/excel/excel.customxmlpart).</span></span>

<span data-ttu-id="f7ac4-200">Há uma opção de armazenamento adicional quando você precisa armazenar informações que excedem os limites de tamanho das Configurações do documento ou que tem um caractere estruturado.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-200">There is an additional storage option when you need to store information that exceeds the size limits of the document Settings or which has a structured character.</span></span> <span data-ttu-id="f7ac4-201">Você pode manter a marcação XML personalizada em um suplemento do painel tarefas do Word (e do Excel, mas confira a observação na parte superior desta seção).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-201">You can persist custom XML markup in a task pane add-in for Word (and for Excel, but see the note at the top of this section).</span></span> <span data-ttu-id="f7ac4-202">No Word, use o objeto [CustomXmlPart](/javascript/api/office/office.customxmlpart) e seus métodos (novamente, consulte a observação acima do Excel).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-202">In Word, you use the [CustomXmlPart](/javascript/api/office/office.customxmlpart) object and its methods (again, see the note above for Excel).</span></span> <span data-ttu-id="f7ac4-203">O código a seguir cria um componente XML personalizado e exibe sua ID e seu conteúdo no divs na página.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-203">The following code creates a custom XML part and displays its ID and then its content in divs on the page.</span></span> <span data-ttu-id="f7ac4-204">Observe que deverá haver um atributo `xmlns` na cadeia de caracteres de XML.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-204">Note that there must be an `xmlns` attribute in the XML string.</span></span>

```js
function createCustomXmlPart() {
    const xmlString = "<Reviewers xmlns='http://schemas.contoso.com/review/1.0'><Reviewer>Juan</Reviewer><Reviewer>Hong</Reviewer><Reviewer>Sally</Reviewer></Reviewers>";
    Office.context.document.customXmlParts.addAsync(xmlString,
        (asyncResult) => {
            $("#xml-id").text("Your new XML part's ID: " + asyncResult.value.id);
            asyncResult.value.getXmlAsync(
                (asyncResult) => {
                    $("#xml-blob").text(asyncResult.value);
                }
            );
        }
    );
}
```

<span data-ttu-id="f7ac4-p127">Para recuperar uma parte do XML personalizado, use o método [getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-), mas a ID é um GUID gerado quando parte de XML é criada, portanto, não é possível saber ao codificar qual é a ID. Por esse motivo, ao criar uma parte de XML, é uma prática recomendada armazenar imediatamente a ID da parte de XML como uma configuração e usar uma chave fácil de lembrar. O método a seguir mostra como fazer isso. (Mas confira as seções anteriores deste artigo para obter detalhes e as práticas recomendadas ao trabalhar com configurações personalizadas).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-p127">To retrieve a custom XML part, you use the [getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-) method, but the ID is a GUID that is generated when the XML part is created, so you can't know when coding what the ID is. For that reason, it is a good practice when creating an XML part to immediately store the ID of the XML part as a setting and give it a memorable key. The following method shows how to do this. (But see earlier sections of this article for details and best practices when working with custom settings).</span></span>

 ```js
function createCustomXmlPartAndStoreId() {
    const xmlString = "<Reviewers xmlns='http://schemas.contoso.com/review/1.0'><Reviewer>Juan</Reviewer><Reviewer>Hong</Reviewer><Reviewer>Sally</Reviewer></Reviewers>";
    Office.context.document.customXmlParts.addAsync(xmlString,
        (asyncResult) => {
            Office.context.document.settings.set('ReviewersID', asyncResult.id);
            Office.context.document.settings.saveAsync();
        }
    );
}
```

<span data-ttu-id="f7ac4-209">O código a seguir mostra como recuperar parte do XML obtendo primeiro a sua ID em uma configuração.</span><span class="sxs-lookup"><span data-stu-id="f7ac4-209">The following code shows how to retrieve the XML part by first getting its ID from a setting.</span></span>

 ```js
function getReviewers() {
    const reviewersXmlId = Office.context.document.settings.get('ReviewersID');
    Office.context.document.customXmlParts.getByIdAsync(reviewersXmlId,
        (asyncResult) => {
            asyncResult.value.getXmlAsync(
                (asyncResult) => {
                    $("#xml-blob").text(asyncResult.value);
                }
            );
        }
    );
}
```

## <a name="how-to-save-settings-in-an-outlook-add-in"></a><span data-ttu-id="f7ac4-210">Como salvar configurações em um complemento do Outlook</span><span class="sxs-lookup"><span data-stu-id="f7ac4-210">How to save settings in an Outlook add-in</span></span>

<span data-ttu-id="f7ac4-211">Para obter informações sobre como salvar configurações em um complemento do Outlook, consulte [Manage state and settings for an Outlook add-in](../outlook/manage-state-and-settings-outlook.md).</span><span class="sxs-lookup"><span data-stu-id="f7ac4-211">For information about how to save settings in an Outlook add-in, see [Manage state and settings for an Outlook add-in](../outlook/manage-state-and-settings-outlook.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="f7ac4-212">Confira também</span><span class="sxs-lookup"><span data-stu-id="f7ac4-212">See also</span></span>

- [<span data-ttu-id="f7ac4-213">Entendendo a API de JavaScript do Office</span><span class="sxs-lookup"><span data-stu-id="f7ac4-213">Understanding the Office JavaScript API</span></span>](understanding-the-javascript-api-for-office.md)
- [<span data-ttu-id="f7ac4-214">Suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="f7ac4-214">Outlook add-ins</span></span>](../outlook/outlook-add-ins-overview.md)
- [<span data-ttu-id="f7ac4-215">Gerenciar estado e configurações para um complemento do Outlook</span><span class="sxs-lookup"><span data-stu-id="f7ac4-215">Manage state and settings for an Outlook add-in</span></span>](../outlook/manage-state-and-settings-outlook.md)
- [<span data-ttu-id="f7ac4-216">Excel-Add-in-JavaScript-PersistCustomSettings</span><span class="sxs-lookup"><span data-stu-id="f7ac4-216">Excel-Add-in-JavaScript-PersistCustomSettings</span></span>](https://github.com/OfficeDev/Excel-Add-in-JavaScript-PersistCustomSettings)
