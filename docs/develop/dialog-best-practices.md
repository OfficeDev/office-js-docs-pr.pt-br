---
title: Práticas recomendadas e regras para a API da caixa de diálogo do Office
description: Fornece regras e práticas recomendadas para a API de caixa de diálogo do Office, como as práticas recomendadas para um aplicativo de página única (SPA)
ms.date: 01/29/2020
localization_priority: Normal
ms.openlocfilehash: e684c56768cd2ca7c9b14788206c925808c90b63
ms.sourcegitcommit: 4079903c3cc45b7d8c041509a44e9fc38da399b1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/11/2020
ms.locfileid: "42596596"
---
# <a name="best-practices-and-rules-for-the-office-dialog-api"></a><span data-ttu-id="de3e0-103">Práticas recomendadas e regras para a API da caixa de diálogo do Office</span><span class="sxs-lookup"><span data-stu-id="de3e0-103">Best practices and rules for the Office dialog API</span></span>

<span data-ttu-id="de3e0-104">Este artigo fornece regras, armadilhas e práticas recomendadas para a API de diálogo do Office, incluindo as práticas recomendadas para projetar a interface do usuário de uma caixa de diálogo e usar a API com um aplicativo de página única (SPA)</span><span class="sxs-lookup"><span data-stu-id="de3e0-104">This article provides rules, gotchas, and best practices for the Office dialog API, including best practices for designing the UI of a dialog and using the API with in a single-page application (SPA)</span></span>

> [!NOTE]
> <span data-ttu-id="de3e0-105">Este artigo pressupõe que você esteja familiarizado com as noções básicas de usar a API de caixa de diálogo do Office, conforme descrito em [usar a API de caixa de diálogo do Office em seus suplementos do Office](dialog-api-in-office-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="de3e0-105">This article presupposes that you are familiar with the basics of using the Office dialog API as described in [Use the Office dialog API in your Office Add-ins](dialog-api-in-office-add-ins.md).</span></span>
> 
> <span data-ttu-id="de3e0-106">Consulte também [manipulação de erros e eventos com a caixa de diálogo do Office](dialog-handle-errors-events.md).</span><span class="sxs-lookup"><span data-stu-id="de3e0-106">See also [Handling errors and events with the Office dialog box](dialog-handle-errors-events.md).</span></span>

## <a name="rules-and-gotchas"></a><span data-ttu-id="de3e0-107">Regras e dicas</span><span class="sxs-lookup"><span data-stu-id="de3e0-107">Rules and gotchas</span></span>

- <span data-ttu-id="de3e0-108">A caixa de diálogo só pode navegar para URLs HTTPS, não para HTTP.</span><span class="sxs-lookup"><span data-stu-id="de3e0-108">The dialog box can only navigate to HTTPS URLs, not HTTP.</span></span>
- <span data-ttu-id="de3e0-109">A URL passada para o método [displayDialogAsync](/javascript/api/office/office.ui) deve estar no mesmo domínio que o suplemento em si.</span><span class="sxs-lookup"><span data-stu-id="de3e0-109">The URL passed to the [displayDialogAsync](/javascript/api/office/office.ui) method must be in the exact same domain as the add-in itself.</span></span> <span data-ttu-id="de3e0-110">Ele não pode ser um subdomínio.</span><span class="sxs-lookup"><span data-stu-id="de3e0-110">It cannot be a subdomain.</span></span> <span data-ttu-id="de3e0-111">Mas a página que é passada para ela pode redirecionar para uma página em outro domínio.</span><span class="sxs-lookup"><span data-stu-id="de3e0-111">But the page that is passed to it can redirect to a page in another domain.</span></span>
- <span data-ttu-id="de3e0-112">Uma janela hospedeira, que pode ser um painel de tarefas ou o arquivo de [função](../reference/manifest/functionfile.md) sem interface do usuário de um suplemento, pode ter apenas uma caixa de diálogo aberta por vez.</span><span class="sxs-lookup"><span data-stu-id="de3e0-112">A host window, which can be a task pane or the UI-less [function file](../reference/manifest/functionfile.md) of an add-in command, can have only one dialog box open at a time.</span></span>
- <span data-ttu-id="de3e0-113">Apenas duas APIs do Office podem ser chamadas na caixa de diálogo:</span><span class="sxs-lookup"><span data-stu-id="de3e0-113">Only two Office APIs can be called in the dialog box:</span></span>
  - <span data-ttu-id="de3e0-114">A função [messageParent](/javascript/api/office/office.ui#messageparent-message-) .</span><span class="sxs-lookup"><span data-stu-id="de3e0-114">The [messageParent](/javascript/api/office/office.ui#messageparent-message-) function.</span></span>
  - <span data-ttu-id="de3e0-115">`Office.context.requirements.isSetSupported`(Para obter mais informações, consulte [especificar hosts do Office e requisitos de API](specify-office-hosts-and-api-requirements.md).)</span><span class="sxs-lookup"><span data-stu-id="de3e0-115">`Office.context.requirements.isSetSupported` (For more information, see [Specify Office hosts and API requirements](specify-office-hosts-and-api-requirements.md).)</span></span>
- <span data-ttu-id="de3e0-116">A função [messageParent](/javascript/api/office/office.ui#messageparent-message-) pode ser chamada apenas de uma página no mesmo domínio que o suplemento.</span><span class="sxs-lookup"><span data-stu-id="de3e0-116">The [messageParent](/javascript/api/office/office.ui#messageparent-message-) function can only be called from a page in the exact same domain as the add-in itself.</span></span>

## <a name="best-practices"></a><span data-ttu-id="de3e0-117">Práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="de3e0-117">Best practices</span></span>

### <a name="avoid-overusing-dialog-boxes"></a><span data-ttu-id="de3e0-118">Evitar a superutilização de caixas de diálogo</span><span class="sxs-lookup"><span data-stu-id="de3e0-118">Avoid overusing dialog boxes</span></span>

<span data-ttu-id="de3e0-119">Como a sobreposição de elementos de IU não são recomendáveis, evite abrir uma caixa de diálogo em um painel de tarefas a menos que seu cenário o obrigue a fazer isso.</span><span class="sxs-lookup"><span data-stu-id="de3e0-119">Because overlapping UI elements are discouraged, avoid opening a dialog box from a task pane unless your scenario requires it.</span></span> <span data-ttu-id="de3e0-120">Ao considerar como usar a área de superfície de um painel de tarefas, observe que painéis de tarefas podem ter guias.</span><span class="sxs-lookup"><span data-stu-id="de3e0-120">When you consider how to use the surface area of a task pane, note that task panes can be tabbed.</span></span> <span data-ttu-id="de3e0-121">Por exemplo, confira o exemplo [Suplemento do Excel JavaScriptSalesTracker](https://github.com/OfficeDev/Excel-Add-in-JavaScript-SalesTracker).</span><span class="sxs-lookup"><span data-stu-id="de3e0-121">For an example, see the [Excel Add-in JavaScript SalesTracker](https://github.com/OfficeDev/Excel-Add-in-JavaScript-SalesTracker) sample.</span></span>

### <a name="designing-a-dialog-box-ui"></a><span data-ttu-id="de3e0-122">Criar uma interface do usuário de caixa de diálogo</span><span class="sxs-lookup"><span data-stu-id="de3e0-122">Designing a dialog box UI</span></span>

<span data-ttu-id="de3e0-123">Para obter as práticas recomendadas no design da caixa de diálogo, consulte [caixas de diálogo em suplementos do Office](../design/dialog-boxes.md).</span><span class="sxs-lookup"><span data-stu-id="de3e0-123">For best practices in dialog box design, see [Dialog boxes in Office Add-ins](../design/dialog-boxes.md).</span></span>

### <a name="handling-pop-up-blockers-with-office-on-the-web"></a><span data-ttu-id="de3e0-124">Tratamento de bloqueadores de pop-up com o Office na Web</span><span class="sxs-lookup"><span data-stu-id="de3e0-124">Handling pop-up blockers with Office on the web</span></span>

<span data-ttu-id="de3e0-125">A tentativa de exibir uma caixa de diálogo ao usar o Office na Web pode fazer com que o bloqueador de pop-up do navegador bloqueie a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de3e0-125">Attempting to display a dialog box while using Office on the web may cause the browser's pop-up blocker to block the dialog box.</span></span> <span data-ttu-id="de3e0-126">O Office na Web tem um recurso que permite que as caixas de diálogo do suplemento sejam uma exceção para o bloqueador de pop-ups do navegador.</span><span class="sxs-lookup"><span data-stu-id="de3e0-126">Office on the web has a feature that enables your add-in's dialog boxes to be an exception to the browser's pop-up blocker.</span></span> <span data-ttu-id="de3e0-127">Quando o código chamar o `displayDialogAsync` método, o Office na Web abrirá um prompt semelhante ao seguinte.</span><span class="sxs-lookup"><span data-stu-id="de3e0-127">When your code calls the `displayDialogAsync` method, then Office on the web will open a prompt similar to the following.</span></span>

![O prompt que um suplemento pode gerar para evitar bloqueadores de pop-ups no navegador.](../images/dialog-prompt-before-open.png)

<span data-ttu-id="de3e0-129">Se o usuário escolher **permitir**, a caixa de diálogo do Office será aberta.</span><span class="sxs-lookup"><span data-stu-id="de3e0-129">If the user chooses **Allow**, the Office dialog box opens.</span></span> <span data-ttu-id="de3e0-130">Se o usuário escolher **ignorar**, o prompt será fechado e a caixa de diálogo do Office não será aberta.</span><span class="sxs-lookup"><span data-stu-id="de3e0-130">If the user chooses **Ignore**, the prompt closes and the Office dialog box does not open.</span></span> <span data-ttu-id="de3e0-131">Em vez disso `displayDialogAsync` , o método retorna o erro 12009.</span><span class="sxs-lookup"><span data-stu-id="de3e0-131">Instead, the `displayDialogAsync` method returns error 12009.</span></span> <span data-ttu-id="de3e0-132">O código deve capturar esse erro e fornecer uma experiência alternativa que não requer uma caixa de diálogo ou exibir uma mensagem para o usuário que avisa que o suplemento exige que eles permitam a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de3e0-132">Your code should catch this error and either provide an alternate experience that does not require a dialog, or display a message to the user advising that the add-in requires them to allow the dialog.</span></span> <span data-ttu-id="de3e0-133">(Para saber mais sobre 12009, confira [erros de displayDialogAsync](dialog-handle-errors-events.md#errors-from-displaydialogasync).)</span><span class="sxs-lookup"><span data-stu-id="de3e0-133">(For more about 12009, see [Errors from displayDialogAsync](dialog-handle-errors-events.md#errors-from-displaydialogasync).)</span></span>

<span data-ttu-id="de3e0-134">Se, por qualquer motivo, você deseja desativar esse recurso, o código deve ser recusado. Ele faz essa solicitação com o objeto [dialogoptions](/javascript/api/office/office.dialogoptions) que é passado para o `displayDialogAsync` método.</span><span class="sxs-lookup"><span data-stu-id="de3e0-134">If, for any reason, you want to turn off this feature, then your code must opt out. It makes this request with the [DialogOptions](/javascript/api/office/office.dialogoptions) object that is passed to the `displayDialogAsync` method.</span></span> <span data-ttu-id="de3e0-135">Especificamente, o objeto deve incluir `promptBeforeOpen: false`.</span><span class="sxs-lookup"><span data-stu-id="de3e0-135">Specifically, the object should include `promptBeforeOpen: false`.</span></span> <span data-ttu-id="de3e0-136">Quando essa opção é definida como false, o Office na Web não solicitará que o usuário permita que o suplemento abra uma caixa de diálogo e a caixa de diálogo do Office não será aberta.</span><span class="sxs-lookup"><span data-stu-id="de3e0-136">When this option is set to false, Office on the web will not prompt the user to allow the add-in open a dialog, and the Office dialog will not open.</span></span>

### <a name="do-not-use-the-_host_info-value"></a><span data-ttu-id="de3e0-137">Não usar o valor \_de\_informações do host</span><span class="sxs-lookup"><span data-stu-id="de3e0-137">Do not use the \_host\_info value</span></span>

<span data-ttu-id="de3e0-138">O Office adiciona automaticamente um parâmetro de `_host_info` consulta chamado à URL que é transmitida para `displayDialogAsync`.</span><span class="sxs-lookup"><span data-stu-id="de3e0-138">Office automatically adds a query parameter called `_host_info` to the URL that is passed to `displayDialogAsync`.</span></span> <span data-ttu-id="de3e0-139">Ele é acrescentado após os parâmetros de consulta personalizados, se houver.</span><span class="sxs-lookup"><span data-stu-id="de3e0-139">It is appended after your custom query parameters, if any.</span></span> <span data-ttu-id="de3e0-140">Ele não é acrescentado a quaisquer URLs subsequentes às quais a caixa de diálogo navega.</span><span class="sxs-lookup"><span data-stu-id="de3e0-140">It is not appended to any subsequent URLs that the dialog box navigates to.</span></span> <span data-ttu-id="de3e0-141">A Microsoft pode alterar o conteúdo desse valor ou removê-lo totalmente, portanto seu código não deve lê-lo.</span><span class="sxs-lookup"><span data-stu-id="de3e0-141">Microsoft may change the content of this value, or remove it entirely, so your code should not read it.</span></span> <span data-ttu-id="de3e0-142">O mesmo valor é adicionado ao armazenamento da sessão da caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de3e0-142">The same value is added to the dialog box's session storage.</span></span> <span data-ttu-id="de3e0-143">Novamente, *seu código não deve ser lido nem gravado para esse valor*.</span><span class="sxs-lookup"><span data-stu-id="de3e0-143">Again, *your code should neither read nor write to this value*.</span></span>

### <a name="best-practices-for-using-the-office-dialog-api-in-an-spa"></a><span data-ttu-id="de3e0-144">Práticas recomendadas para usar a API de caixa de diálogo do Office em um SPA</span><span class="sxs-lookup"><span data-stu-id="de3e0-144">Best practices for using the Office dialog API in an SPA</span></span>

<span data-ttu-id="de3e0-145">Se seu suplemento usa o roteamento do lado do cliente, como aplicativos de página única (spas usam) normalmente, você tem a opção de passar a URL de uma rota para o método [displayDialogAsync](/javascript/api/office/office.ui) em vez da URL de uma página HTML separada.</span><span class="sxs-lookup"><span data-stu-id="de3e0-145">If your add-in uses client-side routing, as single-page applications (SPAs) typically do, you have the option to pass the URL of a route to the [displayDialogAsync](/javascript/api/office/office.ui) method instead of the URL of a separate HTML page.</span></span> <span data-ttu-id="de3e0-146">*Recomendamos que você faça isso pelos motivos apresentados abaixo.*</span><span class="sxs-lookup"><span data-stu-id="de3e0-146">*We recommend against doing so for the reasons given below.*</span></span>

> [!NOTE]
> <span data-ttu-id="de3e0-147">Este artigo não é relevante para o roteamento *do lado do servidor* , como em um aplicativo Web baseado em Express.</span><span class="sxs-lookup"><span data-stu-id="de3e0-147">This article is not relevant to *server-side* routing, such as in an Express-based web application.</span></span>

#### <a name="problems-with-spas-and-the-office-dialog-api"></a><span data-ttu-id="de3e0-148">Problemas com o spas usam e a API de caixa de diálogo do Office</span><span class="sxs-lookup"><span data-stu-id="de3e0-148">Problems with SPAs and the Office dialog API</span></span>

<span data-ttu-id="de3e0-149">A caixa de diálogo do Office está em uma nova janela com sua própria instância do mecanismo JavaScript e, portanto, é o contexto de execução completo.</span><span class="sxs-lookup"><span data-stu-id="de3e0-149">The Office dialog box is in a new window with its own instance of the JavaScript engine, and hence it's own complete execution context.</span></span> <span data-ttu-id="de3e0-150">Se você passar uma rota, sua página de base e todos os seus códigos de inicialização e Bootstrap serão executados novamente neste novo contexto, e qualquer variável será definida para seus valores iniciais na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de3e0-150">If you pass a route, your base page and all its initialization and bootstrapping code run again in this new context, and any variables are set to their initial values in the dialog box.</span></span> <span data-ttu-id="de3e0-151">Portanto, essa técnica baixa e inicia uma segunda instância do aplicativo na janela da caixa, que anula parcialmente a finalidade de um SPA.</span><span class="sxs-lookup"><span data-stu-id="de3e0-151">So this technique downloads and launches a second instance of your application in the  box window, which partially defeats the purpose of an SPA.</span></span> <span data-ttu-id="de3e0-152">Além disso, o código que altera as variáveis na janela da caixa de diálogo não altera a versão do painel de tarefas das mesmas variáveis.</span><span class="sxs-lookup"><span data-stu-id="de3e0-152">In addition, code that changes variables in the dialog box window does not change the task pane version of the same variables.</span></span> <span data-ttu-id="de3e0-153">Da mesma forma, a janela da caixa de diálogo tem seu próprio armazenamento de sessão, que não é acessível a partir do código no painel de tarefas.</span><span class="sxs-lookup"><span data-stu-id="de3e0-153">Similarly, the dialog box window has its own session storage, which is not accessible from code in the task pane.</span></span> <span data-ttu-id="de3e0-154">A caixa de diálogo e a página host na `displayDialogAsync` qual o foi chamado têm a aparência de dois clientes diferentes para o seu servidor.</span><span class="sxs-lookup"><span data-stu-id="de3e0-154">The dialog box and the host page on which `displayDialogAsync` was called look like two different clients to your server.</span></span> <span data-ttu-id="de3e0-155">(Para obter um lembrete sobre o que é uma página de host, consulte [abrir uma caixa de diálogo em uma página de host](dialog-api-in-office-add-ins.md#open-a-dialog-box-from-a-host-page).)</span><span class="sxs-lookup"><span data-stu-id="de3e0-155">(For a reminder of what a host page is, see [Open a dialog box from a host page](dialog-api-in-office-add-ins.md#open-a-dialog-box-from-a-host-page).)</span></span>

<span data-ttu-id="de3e0-156">Portanto, se você passou uma rota para o `displayDialogAsync` método, você realmente não tem um spa; Você teria *duas instâncias do mesmo Spa*.</span><span class="sxs-lookup"><span data-stu-id="de3e0-156">So, if you passed a route to the `displayDialogAsync` method, you wouldn't really have an SPA; you'd have *two instances of the same SPA*.</span></span> <span data-ttu-id="de3e0-157">Além disso, grande parte do código na instância do painel de tarefas nunca seria usada nessa instância, e grande parte do código na instância da caixa de diálogo nunca seria usada nessa instância.</span><span class="sxs-lookup"><span data-stu-id="de3e0-157">Moreover, much of the code in the task pane instance would never be used in that instance and much of the code in the dialog box instance would never be used in that instance.</span></span> <span data-ttu-id="de3e0-158">Seria como ter dois SPAs no mesmo grupo.</span><span class="sxs-lookup"><span data-stu-id="de3e0-158">It would be like having two SPAs in the same bundle.</span></span>

#### <a name="microsoft-recommendations"></a><span data-ttu-id="de3e0-159">Recomendações da Microsoft</span><span class="sxs-lookup"><span data-stu-id="de3e0-159">Microsoft recommendations</span></span>

<span data-ttu-id="de3e0-160">Em vez de passar uma rota do lado do cliente `displayDialogAsync` para o método, recomendamos que você siga um destes procedimentos:</span><span class="sxs-lookup"><span data-stu-id="de3e0-160">Instead of passing a client-side route to the `displayDialogAsync` method, we recommend that you do one of the following:</span></span>

* <span data-ttu-id="de3e0-161">Se o código que você deseja executar na caixa de diálogo for suficientemente complexo, crie dois spas usam distintos explicitamente; ou seja, têm duas spas usam em pastas diferentes do mesmo domínio.</span><span class="sxs-lookup"><span data-stu-id="de3e0-161">If the code that you want to run in the dialog box is sufficiently complex, create two different SPAs explicitly; that is, have two SPAs in different folders of the same domain.</span></span> <span data-ttu-id="de3e0-162">Um SPA é executado na caixa de diálogo e o outro na página host da caixa de diálogo `displayDialogAsync` , onde foi chamado.</span><span class="sxs-lookup"><span data-stu-id="de3e0-162">One SPA runs in the dialog box and the other in the dialog box's host page where `displayDialogAsync` was called.</span></span> 
* <span data-ttu-id="de3e0-163">Na maioria dos cenários, só é necessária uma lógica simples na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="de3e0-163">In most scenarios, only simple logic is needed in the dialog box.</span></span> <span data-ttu-id="de3e0-164">Nesses casos, o projeto será bastante simplificado, hospedando uma única página HTML, com JavaScript incorporado ou referenciado, no domínio de seu SPA.</span><span class="sxs-lookup"><span data-stu-id="de3e0-164">In such cases, your project will be greatly simplified by hosting a single HTML page, with embedded or referenced JavaScript, in the domain of your SPA.</span></span> <span data-ttu-id="de3e0-165">Passe a URL da página para o método`displayDialogAsync`.</span><span class="sxs-lookup"><span data-stu-id="de3e0-165">Pass the URL of the page to the `displayDialogAsync` method.</span></span> <span data-ttu-id="de3e0-166">Embora isso signifique que você está deviating da ideia literal de um aplicativo de página única; na verdade, você não tem uma única instância de um SPA ao usar a API de diálogo do Office.</span><span class="sxs-lookup"><span data-stu-id="de3e0-166">While this means that you are deviating from the literal idea of a single-page app; you don't really have a single instance of an SPA when you are using the Office dialog API.</span></span>
