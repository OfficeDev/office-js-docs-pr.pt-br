---
title: Práticas recomendadas e regras para a API da caixa de diálogo do Office
description: Fornece regras e práticas recomendadas para a API de caixa de diálogo do Office, como práticas recomendadas para um aplicativo de página única (SPA)
ms.date: 02/09/2021
localization_priority: Normal
ms.openlocfilehash: 4359d116e9720255278c5b3f543b135013c7e76c
ms.sourcegitcommit: 7cd501d0fdbbd4636bd08647b638dd5ca4c7c630
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/17/2021
ms.locfileid: "50282979"
---
# <a name="best-practices-and-rules-for-the-office-dialog-api"></a><span data-ttu-id="e1d94-103">Práticas recomendadas e regras para a API da caixa de diálogo do Office</span><span class="sxs-lookup"><span data-stu-id="e1d94-103">Best practices and rules for the Office dialog API</span></span>

<span data-ttu-id="e1d94-104">Este artigo fornece regras, conversas e práticas recomendadas para a API de caixa de diálogo do Office, incluindo práticas recomendadas para projetar a interface do usuário de uma caixa de diálogo e usar a API com um aplicativo de página única (SPA)</span><span class="sxs-lookup"><span data-stu-id="e1d94-104">This article provides rules, gotchas, and best practices for the Office dialog API, including best practices for designing the UI of a dialog and using the API with in a single-page application (SPA)</span></span>

> [!NOTE]
> <span data-ttu-id="e1d94-105">Este artigo pressupõe que você está familiarizado com as noções básicas de uso da API de caixa de diálogo do Office, conforme descrito em Usar a API de caixa de diálogo do Office em seus [Complementos do Office.](dialog-api-in-office-add-ins.md)</span><span class="sxs-lookup"><span data-stu-id="e1d94-105">This article presupposes that you are familiar with the basics of using the Office dialog API as described in [Use the Office dialog API in your Office Add-ins](dialog-api-in-office-add-ins.md).</span></span>
> 
> <span data-ttu-id="e1d94-106">Consulte também [Manipulando erros e eventos com a caixa de diálogo do Office.](dialog-handle-errors-events.md)</span><span class="sxs-lookup"><span data-stu-id="e1d94-106">See also [Handling errors and events with the Office dialog box](dialog-handle-errors-events.md).</span></span>

## <a name="rules-and-gotchas"></a><span data-ttu-id="e1d94-107">Regras e dicas</span><span class="sxs-lookup"><span data-stu-id="e1d94-107">Rules and gotchas</span></span>

- <span data-ttu-id="e1d94-108">A caixa de diálogo só pode navegar até URLs HTTPS, não HTTP.</span><span class="sxs-lookup"><span data-stu-id="e1d94-108">The dialog box can only navigate to HTTPS URLs, not HTTP.</span></span>
- <span data-ttu-id="e1d94-109">A URL passada para [o método displayDialogAsync](/javascript/api/office/office.ui) deve estar exatamente no mesmo domínio que o próprio complemento.</span><span class="sxs-lookup"><span data-stu-id="e1d94-109">The URL passed to the [displayDialogAsync](/javascript/api/office/office.ui) method must be in the exact same domain as the add-in itself.</span></span> <span data-ttu-id="e1d94-110">Não pode ser um subdomínio.</span><span class="sxs-lookup"><span data-stu-id="e1d94-110">It cannot be a subdomain.</span></span> <span data-ttu-id="e1d94-111">Mas a página que é passada para ela pode redirecionar para uma página em outro domínio.</span><span class="sxs-lookup"><span data-stu-id="e1d94-111">But the page that is passed to it can redirect to a page in another domain.</span></span>
- <span data-ttu-id="e1d94-112">Uma janela de host, que pode ser um [](../reference/manifest/functionfile.md) painel de tarefas ou o arquivo de função sem interface do usuário de um comando de complemento, pode ter apenas uma caixa de diálogo aberta por vez.</span><span class="sxs-lookup"><span data-stu-id="e1d94-112">A host window, which can be a task pane or the UI-less [function file](../reference/manifest/functionfile.md) of an add-in command, can have only one dialog box open at a time.</span></span>
- <span data-ttu-id="e1d94-113">Somente duas APIs do Office podem ser chamadas na caixa de diálogo:</span><span class="sxs-lookup"><span data-stu-id="e1d94-113">Only two Office APIs can be called in the dialog box:</span></span>
  - <span data-ttu-id="e1d94-114">A [função messageParent.](/javascript/api/office/office.ui#messageparent-message-)</span><span class="sxs-lookup"><span data-stu-id="e1d94-114">The [messageParent](/javascript/api/office/office.ui#messageparent-message-) function.</span></span>
  - <span data-ttu-id="e1d94-115">`Office.context.requirements.isSetSupported`(Para saber mais, confira Especificar [aplicativos do Office e requisitos de API.)](specify-office-hosts-and-api-requirements.md)</span><span class="sxs-lookup"><span data-stu-id="e1d94-115">`Office.context.requirements.isSetSupported` (For more information, see [Specify Office applications and API requirements](specify-office-hosts-and-api-requirements.md).)</span></span>
- <span data-ttu-id="e1d94-116">A [função messageParent](/javascript/api/office/office.ui#messageparent-message-) só pode ser chamada de uma página no mesmo domínio que o próprio complemento.</span><span class="sxs-lookup"><span data-stu-id="e1d94-116">The [messageParent](/javascript/api/office/office.ui#messageparent-message-) function can only be called from a page in the exact same domain as the add-in itself.</span></span>

## <a name="best-practices"></a><span data-ttu-id="e1d94-117">Práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="e1d94-117">Best practices</span></span>

### <a name="avoid-overusing-dialog-boxes"></a><span data-ttu-id="e1d94-118">Evitar o excesso de caixas de diálogo</span><span class="sxs-lookup"><span data-stu-id="e1d94-118">Avoid overusing dialog boxes</span></span>

<span data-ttu-id="e1d94-119">Como a sobreposição de elementos de IU não são recomendáveis, evite abrir uma caixa de diálogo em um painel de tarefas a menos que seu cenário o obrigue a fazer isso.</span><span class="sxs-lookup"><span data-stu-id="e1d94-119">Because overlapping UI elements are discouraged, avoid opening a dialog box from a task pane unless your scenario requires it.</span></span> <span data-ttu-id="e1d94-120">Ao considerar como usar a área de superfície de um painel de tarefas, observe que painéis de tarefas podem ter guias.</span><span class="sxs-lookup"><span data-stu-id="e1d94-120">When you consider how to use the surface area of a task pane, note that task panes can be tabbed.</span></span> <span data-ttu-id="e1d94-121">Para ver um exemplo de um painel de tarefas com guias, confira o exemplo [do JavaScript SalesTracker para o](https://github.com/OfficeDev/Excel-Add-in-JavaScript-SalesTracker) Complemento do Excel.</span><span class="sxs-lookup"><span data-stu-id="e1d94-121">For an example of a tabbed task pane, see the [Excel Add-in JavaScript SalesTracker](https://github.com/OfficeDev/Excel-Add-in-JavaScript-SalesTracker) sample.</span></span>

### <a name="designing-a-dialog-box-ui"></a><span data-ttu-id="e1d94-122">Projetando uma interface do usuário de caixa de diálogo</span><span class="sxs-lookup"><span data-stu-id="e1d94-122">Designing a dialog box UI</span></span>

<span data-ttu-id="e1d94-123">Para saber as práticas recomendadas no design da caixa de diálogo, confira [Caixas de diálogo nos Complementos do Office.](../design/dialog-boxes.md)</span><span class="sxs-lookup"><span data-stu-id="e1d94-123">For best practices in dialog box design, see [Dialog boxes in Office Add-ins](../design/dialog-boxes.md).</span></span>

### <a name="handling-pop-up-blockers-with-office-on-the-web"></a><span data-ttu-id="e1d94-124">Tratamento de bloqueadores de pop-up com o Office na Web</span><span class="sxs-lookup"><span data-stu-id="e1d94-124">Handling pop-up blockers with Office on the web</span></span>

<span data-ttu-id="e1d94-125">Tentar exibir uma caixa de diálogo ao usar o Office na Web pode fazer com que o bloqueador de pop-ups do navegador bloqueie a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e1d94-125">Attempting to display a dialog box while using Office on the web may cause the browser's pop-up blocker to block the dialog box.</span></span> <span data-ttu-id="e1d94-126">O Office na Web tem um recurso que permite que as caixas de diálogo do seu complemento sejam uma exceção ao bloqueador de pop-ups do navegador.</span><span class="sxs-lookup"><span data-stu-id="e1d94-126">Office on the web has a feature that enables your add-in's dialog boxes to be an exception to the browser's pop-up blocker.</span></span> <span data-ttu-id="e1d94-127">Quando seu código chamar o `displayDialogAsync` método, o Office na Web abrirá um prompt semelhante ao seguinte.</span><span class="sxs-lookup"><span data-stu-id="e1d94-127">When your code calls the `displayDialogAsync` method, then Office on the web will open a prompt similar to the following.</span></span>

![Screenshot showing the prompt with a brief description and Allow and Ignore buttons that an add-in can generate to avoid in-browser pop-up blockers](../images/dialog-prompt-before-open.png)

<span data-ttu-id="e1d94-129">Se o usuário escolher Permitir, **a** caixa de diálogo do Office será aberta.</span><span class="sxs-lookup"><span data-stu-id="e1d94-129">If the user chooses **Allow**, the Office dialog box opens.</span></span> <span data-ttu-id="e1d94-130">Se o usuário escolher **Ignorar**, o prompt será fechado e a caixa de diálogo do Office não será aberta.</span><span class="sxs-lookup"><span data-stu-id="e1d94-130">If the user chooses **Ignore**, the prompt closes and the Office dialog box does not open.</span></span> <span data-ttu-id="e1d94-131">Em vez disso, `displayDialogAsync` o método retorna o erro 12009.</span><span class="sxs-lookup"><span data-stu-id="e1d94-131">Instead, the `displayDialogAsync` method returns error 12009.</span></span> <span data-ttu-id="e1d94-132">Seu código deve capturar esse erro e fornecer uma experiência alternativa que não exija uma caixa de diálogo ou exibir uma mensagem para o usuário avisando que o complemento exige que ele permita a caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e1d94-132">Your code should catch this error and either provide an alternate experience that does not require a dialog, or display a message to the user advising that the add-in requires them to allow the dialog.</span></span> <span data-ttu-id="e1d94-133">(Para obter mais sobre 12009, consulte [Erros de displayDialogAsync](dialog-handle-errors-events.md#errors-from-displaydialogasync).)</span><span class="sxs-lookup"><span data-stu-id="e1d94-133">(For more about 12009, see [Errors from displayDialogAsync](dialog-handle-errors-events.md#errors-from-displaydialogasync).)</span></span>

<span data-ttu-id="e1d94-134">Se, por qualquer motivo, você quiser desativar esse recurso, seu código deverá re optá-lo. Ela faz essa solicitação com o [objeto DialogOptions](/javascript/api/office/office.dialogoptions) que é passado para o `displayDialogAsync` método.</span><span class="sxs-lookup"><span data-stu-id="e1d94-134">If, for any reason, you want to turn off this feature, then your code must opt out. It makes this request with the [DialogOptions](/javascript/api/office/office.dialogoptions) object that is passed to the `displayDialogAsync` method.</span></span> <span data-ttu-id="e1d94-135">Especificamente, o objeto deve incluir `promptBeforeOpen: false` .</span><span class="sxs-lookup"><span data-stu-id="e1d94-135">Specifically, the object should include `promptBeforeOpen: false`.</span></span> <span data-ttu-id="e1d94-136">Quando essa opção for definida como falsa, o Office na Web não solicitará que o usuário permita que o complemento abra uma caixa de diálogo e a caixa de diálogo do Office não será aberta.</span><span class="sxs-lookup"><span data-stu-id="e1d94-136">When this option is set to false, Office on the web will not prompt the user to allow the add-in open a dialog, and the Office dialog will not open.</span></span>

### <a name="do-not-use-the-_host_info-value"></a><span data-ttu-id="e1d94-137">Não use o valor \_ de \_ informações do host</span><span class="sxs-lookup"><span data-stu-id="e1d94-137">Do not use the \_host\_info value</span></span>

<span data-ttu-id="e1d94-138">O Office adiciona automaticamente um parâmetro de `_host_info` consulta chamado para a URL que é passada para `displayDialogAsync` .</span><span class="sxs-lookup"><span data-stu-id="e1d94-138">Office automatically adds a query parameter called `_host_info` to the URL that is passed to `displayDialogAsync`.</span></span> <span data-ttu-id="e1d94-139">Ele é anexado após os parâmetros de consulta personalizados, se algum.</span><span class="sxs-lookup"><span data-stu-id="e1d94-139">It is appended after your custom query parameters, if any.</span></span> <span data-ttu-id="e1d94-140">Ele não é anexado a quaisquer URLs subsequentes para as que a caixa de diálogo navega.</span><span class="sxs-lookup"><span data-stu-id="e1d94-140">It is not appended to any subsequent URLs that the dialog box navigates to.</span></span> <span data-ttu-id="e1d94-141">A Microsoft pode alterar o conteúdo desse valor ou removê-lo completamente, para que seu código não o leia.</span><span class="sxs-lookup"><span data-stu-id="e1d94-141">Microsoft may change the content of this value, or remove it entirely, so your code should not read it.</span></span> <span data-ttu-id="e1d94-142">O mesmo valor é adicionado ao armazenamento da sessão da caixa de diálogo (ou seja, a [propriedade Window.sessionStorage).](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage)</span><span class="sxs-lookup"><span data-stu-id="e1d94-142">The same value is added to the dialog box's session storage (that is, the [Window.sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage) property).</span></span> <span data-ttu-id="e1d94-143">Novamente, *seu código não deve ler nem gravar nesse valor.*</span><span class="sxs-lookup"><span data-stu-id="e1d94-143">Again, *your code should neither read nor write to this value*.</span></span>

### <a name="opening-another-dialog-immediately-after-closing-one"></a><span data-ttu-id="e1d94-144">Abrir outra caixa de diálogo imediatamente após fechar uma</span><span class="sxs-lookup"><span data-stu-id="e1d94-144">Opening another dialog immediately after closing one</span></span>

<span data-ttu-id="e1d94-145">Você não pode ter mais de uma caixa de diálogo aberta em uma determinada página host, portanto, seu código deve chamar [Dialog.close](/javascript/api/office/office.dialog#close__) em uma caixa de diálogo aberta antes de chamar para `displayDialogAsync` abrir outra caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e1d94-145">You can't have more than one dialog open from a given host page, so your code should call [Dialog.close](/javascript/api/office/office.dialog#close__) on an open dialog before it calls `displayDialogAsync` to open another dialog.</span></span> <span data-ttu-id="e1d94-146">O `close` método é assíncrono.</span><span class="sxs-lookup"><span data-stu-id="e1d94-146">The `close` method is asynchronous.</span></span> <span data-ttu-id="e1d94-147">Por esse motivo, se você chamar imediatamente após uma chamada de , a primeira caixa de diálogo poderá não ter sido totalmente fechada quando o Office tentar `displayDialogAsync` `close` abrir a segunda.</span><span class="sxs-lookup"><span data-stu-id="e1d94-147">For this reason, if you call `displayDialogAsync` immediately after a call of `close`, the first dialog may not have completely closed when Office attempts to open the second.</span></span> <span data-ttu-id="e1d94-148">Se isso acontecer, o Office retornará um erro [12007:](dialog-handle-errors-events.md#12007) "A operação falhou porque este complemento já tem uma caixa de diálogo ativa".</span><span class="sxs-lookup"><span data-stu-id="e1d94-148">If that happens, Office will return a [12007](dialog-handle-errors-events.md#12007) error: "The operation failed because this add-in already has an active dialog."</span></span>

<span data-ttu-id="e1d94-149">O método não aceita um parâmetro de retorno de chamada e não retorna um objeto Promise para que ele não possa ser aguardado com a palavra-chave ou `close` `await` com um `then` método.</span><span class="sxs-lookup"><span data-stu-id="e1d94-149">The `close` method doesn't accept a callback parameter, and it doesn't return a Promise object so it cannot be awaited with either the `await` keyword or with a `then` method.</span></span> <span data-ttu-id="e1d94-150">Por esse motivo, sugerimos a técnica a seguir quando você precisar abrir uma nova caixa de diálogo imediatamente após fechar uma caixa de diálogo: encapsular o código para abrir a nova caixa de diálogo em um método e projetar o método para chamar a si mesmo recursivamente se a chamada de retorno `displayDialogAsync` `12007` .</span><span class="sxs-lookup"><span data-stu-id="e1d94-150">For this reason, we suggest the following technique when you need to open a new dialog immediately after closing a dialog: encapsulate the code to open the new dialog in a method and design the method to recursively call itself if the call of `displayDialogAsync` returns `12007`.</span></span> <span data-ttu-id="e1d94-151">Apresentamos um exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="e1d94-151">The following is an example.</span></span>

```javascript
function openFirstDialog() {
  Office.context.ui.displayDialogAsync("https://MyDomain/firstDialog.html", { width: 50, height: 50},
     (result) => {
      if(result.status === Office.AsyncResultStatus.Succeeded) {
        const dialog = result.value;
        dialog.close();
        openSecondDialog();
      }
      else {
         // Handle errors
      }
    }
  );
}
 
function openSecondDialog() {
  Office.context.ui.displayDialogAsync("https://MyDomain/secondDialog.html", { width: 50, height: 50},
    (result) => {
      if(result.status === Office.AsyncResultStatus.Failed) {
        if (result.error.code === 12007) {
          openSecondDialog(); // Recursive call
        }
        else {
         // Handle other errors
        }
      }
    }
  );
}
```

<span data-ttu-id="e1d94-152">Como alternativa, você pode forçar o código a pausar antes que ele tente abrir a segunda caixa de diálogo usando o [método setTimeout.](https://www.w3schools.com/jsref/met_win_settimeout.asp)</span><span class="sxs-lookup"><span data-stu-id="e1d94-152">Alternatively, you could force the code to pause before it tries to open the second dialog by using the [setTimeout](https://www.w3schools.com/jsref/met_win_settimeout.asp) method.</span></span> <span data-ttu-id="e1d94-153">Apresentamos um exemplo a seguir.</span><span class="sxs-lookup"><span data-stu-id="e1d94-153">The following is an example.</span></span>

```javascript
function openFirstDialog() {
  Office.context.ui.displayDialogAsync("https://MyDomain/firstDialog.html", { width: 50, height: 50},
     (result) => {
      if(result.status === Office.AsyncResultStatus.Succeeded) {
        const dialog = result.value;
        dialog.close();
        setTimeout(() => { 
          Office.context.ui.displayDialogAsync("https://MyDomain/secondDialog.html", { width: 50, height: 50},
             (result) => { /* callback body */ }
          );
        }, 1000);
      }
      else {
         // Handle errors
      }
    }
  );
}
```

### <a name="best-practices-for-using-the-office-dialog-api-in-an-spa"></a><span data-ttu-id="e1d94-154">Práticas recomendadas para usar a API de caixa de diálogo do Office em um SPA</span><span class="sxs-lookup"><span data-stu-id="e1d94-154">Best practices for using the Office dialog API in an SPA</span></span>

<span data-ttu-id="e1d94-155">Se o seu complemento usa o roteamento do lado do cliente, como os aplicativos de página única (SPAs) normalmente fazem, você tem a opção de passar a URL de uma rota para o método [displayDialogAsync](/javascript/api/office/office.ui) em vez da URL de uma página HTML separada.</span><span class="sxs-lookup"><span data-stu-id="e1d94-155">If your add-in uses client-side routing, as single-page applications (SPAs) typically do, you have the option to pass the URL of a route to the [displayDialogAsync](/javascript/api/office/office.ui) method instead of the URL of a separate HTML page.</span></span> <span data-ttu-id="e1d94-156">*Não recomendamos isso pelos motivos abaixo.*</span><span class="sxs-lookup"><span data-stu-id="e1d94-156">*We recommend against doing so for the reasons given below.*</span></span>

> [!NOTE]
> <span data-ttu-id="e1d94-157">Este artigo não é relevante para *o roteamento* do lado do servidor, como em um aplicativo Web baseado em Express.</span><span class="sxs-lookup"><span data-stu-id="e1d94-157">This article is not relevant to *server-side* routing, such as in an Express-based web application.</span></span>

#### <a name="problems-with-spas-and-the-office-dialog-api"></a><span data-ttu-id="e1d94-158">Problemas com SPAs e a API de caixa de diálogo do Office</span><span class="sxs-lookup"><span data-stu-id="e1d94-158">Problems with SPAs and the Office dialog API</span></span>

<span data-ttu-id="e1d94-159">A caixa de diálogo do Office está em uma nova janela com sua própria instância do mecanismo JavaScript e, portanto, é seu próprio contexto de execução completo.</span><span class="sxs-lookup"><span data-stu-id="e1d94-159">The Office dialog box is in a new window with its own instance of the JavaScript engine, and hence it's own complete execution context.</span></span> <span data-ttu-id="e1d94-160">Se você passar uma rota, sua página base e todo o código de inicialização e inicialização serão executados novamente nesse novo contexto, e todas as variáveis serão definidas com seus valores iniciais na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e1d94-160">If you pass a route, your base page and all its initialization and bootstrapping code run again in this new context, and any variables are set to their initial values in the dialog box.</span></span> <span data-ttu-id="e1d94-161">Portanto, essa técnica baixa e inicia uma segunda instância do seu aplicativo na janela da caixa, o que anuncia parcialmente a finalidade de um SPA.</span><span class="sxs-lookup"><span data-stu-id="e1d94-161">So this technique downloads and launches a second instance of your application in the  box window, which partially defeats the purpose of an SPA.</span></span> <span data-ttu-id="e1d94-162">Além disso, o código que altera variáveis na janela da caixa de diálogo não altera a versão do painel de tarefas das mesmas variáveis.</span><span class="sxs-lookup"><span data-stu-id="e1d94-162">In addition, code that changes variables in the dialog box window does not change the task pane version of the same variables.</span></span> <span data-ttu-id="e1d94-163">Da mesma forma, a janela da caixa de diálogo tem seu próprio armazenamento de sessão (a [propriedade Window.sessionStorage),](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage) que não é acessível a partir do código no painel de tarefas.</span><span class="sxs-lookup"><span data-stu-id="e1d94-163">Similarly, the dialog box window has its own session storage (the [Window.sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage) property), which is not accessible from code in the task pane.</span></span> <span data-ttu-id="e1d94-164">A caixa de diálogo e a página host na qual `displayDialogAsync` foi chamada parecem dois clientes diferentes para seu servidor.</span><span class="sxs-lookup"><span data-stu-id="e1d94-164">The dialog box and the host page on which `displayDialogAsync` was called look like two different clients to your server.</span></span> <span data-ttu-id="e1d94-165">(Para um lembrete do que é uma página host, consulte [Abrir uma caixa de diálogo em uma página host.)](dialog-api-in-office-add-ins.md#open-a-dialog-box-from-a-host-page)</span><span class="sxs-lookup"><span data-stu-id="e1d94-165">(For a reminder of what a host page is, see [Open a dialog box from a host page](dialog-api-in-office-add-ins.md#open-a-dialog-box-from-a-host-page).)</span></span>

<span data-ttu-id="e1d94-166">Portanto, se você passar uma rota para o método, não terá realmente um SPA; você teria duas `displayDialogAsync` *instâncias do mesmo SPA.*</span><span class="sxs-lookup"><span data-stu-id="e1d94-166">So, if you passed a route to the `displayDialogAsync` method, you wouldn't really have an SPA; you'd have *two instances of the same SPA*.</span></span> <span data-ttu-id="e1d94-167">Além disso, grande parte do código na instância do painel de tarefas nunca seria usada nessa instância e grande parte do código na instância da caixa de diálogo nunca seria usada nessa instância.</span><span class="sxs-lookup"><span data-stu-id="e1d94-167">Moreover, much of the code in the task pane instance would never be used in that instance and much of the code in the dialog box instance would never be used in that instance.</span></span> <span data-ttu-id="e1d94-168">Seria como ter dois SPAs no mesmo grupo.</span><span class="sxs-lookup"><span data-stu-id="e1d94-168">It would be like having two SPAs in the same bundle.</span></span>

#### <a name="microsoft-recommendations"></a><span data-ttu-id="e1d94-169">Recomendações da Microsoft</span><span class="sxs-lookup"><span data-stu-id="e1d94-169">Microsoft recommendations</span></span>

<span data-ttu-id="e1d94-170">Em vez de passar uma rota do lado do cliente para o método, recomendamos `displayDialogAsync` que você faça um dos seguintes:</span><span class="sxs-lookup"><span data-stu-id="e1d94-170">Instead of passing a client-side route to the `displayDialogAsync` method, we recommend that you do one of the following:</span></span>

* <span data-ttu-id="e1d94-171">Se o código que você deseja executar na caixa de diálogo for suficientemente complexo, crie dois SPAs diferentes explicitamente; ou seja, ter dois SPAs em pastas diferentes do mesmo domínio.</span><span class="sxs-lookup"><span data-stu-id="e1d94-171">If the code that you want to run in the dialog box is sufficiently complex, create two different SPAs explicitly; that is, have two SPAs in different folders of the same domain.</span></span> <span data-ttu-id="e1d94-172">Um SPA é executado na caixa de diálogo e o outro na página host da caixa de diálogo onde `displayDialogAsync` foi chamado.</span><span class="sxs-lookup"><span data-stu-id="e1d94-172">One SPA runs in the dialog box and the other in the dialog box's host page where `displayDialogAsync` was called.</span></span> 
* <span data-ttu-id="e1d94-173">Na maioria dos cenários, apenas a lógica simples é necessária na caixa de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e1d94-173">In most scenarios, only simple logic is needed in the dialog box.</span></span> <span data-ttu-id="e1d94-174">Nesses casos, seu projeto será bastante simplificado hospedando uma única página HTML, com JavaScript incorporado ou referenciado, no domínio de seu SPA.</span><span class="sxs-lookup"><span data-stu-id="e1d94-174">In such cases, your project will be greatly simplified by hosting a single HTML page, with embedded or referenced JavaScript, in the domain of your SPA.</span></span> <span data-ttu-id="e1d94-175">Passe a URL da página para o método`displayDialogAsync`.</span><span class="sxs-lookup"><span data-stu-id="e1d94-175">Pass the URL of the page to the `displayDialogAsync` method.</span></span> <span data-ttu-id="e1d94-176">Isso significa que você está desviando da ideia literal de um aplicativo de página única; na verdade, você não tem uma única instância de um SPA quando está usando a API de caixa de diálogo do Office.</span><span class="sxs-lookup"><span data-stu-id="e1d94-176">While this means that you are deviating from the literal idea of a single-page app; you don't really have a single instance of an SPA when you are using the Office dialog API.</span></span>
