---
title: Modelo de objeto de API JavaScript para Office
description: ''
ms.date: 07/27/2018
ms.openlocfilehash: 2947ae2bf0da4f1a0e5151ae8d6d8a723cf6d4b9
ms.sourcegitcommit: 60fd8a3ac4a6d66cb9e075ce7e0cde3c888a5fe9
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 12/28/2018
ms.locfileid: "27458017"
---
# <a name="office-javascript-api-object-model"></a><span data-ttu-id="3a40a-102">Modelo de objeto de API JavaScript para Office</span><span class="sxs-lookup"><span data-stu-id="3a40a-102">Office JavaScript API object model</span></span>
<span data-ttu-id="3a40a-103">Suplementos de JavaScript do Office oferecem acesso às funcionalidades subjacentes do host.</span><span class="sxs-lookup"><span data-stu-id="3a40a-103">Office JavaScript add-ins give access to the host’s underlying functionality.</span></span> <span data-ttu-id="3a40a-104">A maioria desse acesso percorre alguns objetos importantes.</span><span class="sxs-lookup"><span data-stu-id="3a40a-104">Most of this access goes through a few important objects.</span></span> <span data-ttu-id="3a40a-105">O objeto [contexto](#context-object) oferece acesso ao tempo de execução ambiente depois de inicialização.</span><span class="sxs-lookup"><span data-stu-id="3a40a-105">The [Context](#context-object) object gives access to the runtime environment after initialization.</span></span> <span data-ttu-id="3a40a-106">O objeto[documento](#document-object) oferece o controle do usuário a um documento do Excel, PowerPoint ou Word.</span><span class="sxs-lookup"><span data-stu-id="3a40a-106">The [Document](#document-object) object gives the user control over an Excel, PowerPoint, or Word document.</span></span> <span data-ttu-id="3a40a-107">O objeto [caixa de correio](#mailbox-object) oferece um acesso ao suplemento do Outlook para mensagens e perfis de usuário.</span><span class="sxs-lookup"><span data-stu-id="3a40a-107">The [Mailbox](#mailbox-object) object gives an Outlook add-in access to messages and user profiles.</span></span> <span data-ttu-id="3a40a-108">Noções básicas sobre as relações entre esses objetos gerais é a base de um suplemento JavaScript.</span><span class="sxs-lookup"><span data-stu-id="3a40a-108">Understanding the relationships between these high-level objects is the foundation of a JavaScript add-in.</span></span>

## <a name="context-object"></a><span data-ttu-id="3a40a-109">Objeto de contexto</span><span class="sxs-lookup"><span data-stu-id="3a40a-109">Context Object</span></span>

<span data-ttu-id="3a40a-110">**Aplica-se a:** todos os tipos de suplementos</span><span class="sxs-lookup"><span data-stu-id="3a40a-110">**Applies to:** All add-in types</span></span>

<span data-ttu-id="3a40a-111">Quando um suplemento é [inicializado](https://docs.microsoft.com/office/dev/add-ins/develop/understanding-the-javascript-api-for-office#initializing-your-add-in), ele possui diversos objetos diferentes com os quais pode interagir no ambiente do tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="3a40a-111">When an add-in is [initialized](https://docs.microsoft.com/office/dev/add-ins/develop/understanding-the-javascript-api-for-office#initializing-your-add-in), it has many different objects that it can interact with in the runtime environment.</span></span> <span data-ttu-id="3a40a-112">O contexto do tempo de execução do suplemento é refletido na API por meio do objeto [Contexto](https://docs.microsoft.com/javascript/api/office/office.context).</span><span class="sxs-lookup"><span data-stu-id="3a40a-112">The add-in's runtime context is reflected in the API by the [Context](https://docs.microsoft.com/javascript/api/office/office.context) object.</span></span> <span data-ttu-id="3a40a-113">O**Contexto** é o principal objeto que fornece acesso aos objetos mais importantes da API, como os objetos [Documento](https://docs.microsoft.com/javascript/api/office/office.document) e [Caixa de correio](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox) que, por sua vez, fornecem acesso ao conteúdo do documento e da caixa de correio.</span><span class="sxs-lookup"><span data-stu-id="3a40a-113">When an add-in is initialized, it has many different objects that it can interact with in the runtime environment. The add-in's runtime context is reflected in the API by the **Context** object. The Context is the main object that provides access to the most important objects of the API, such as the [Document](https://docs.microsoft.com/javascript/api/office/office.document) and [Mailbox](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox) objects, which in turn provide access to document and mailbox content.</span></span>

<span data-ttu-id="3a40a-p103">Por exemplo, nos suplementos do painel de tarefas e de conteúdo, é possível usar a propriedade [documento](https://docs.microsoft.com/javascript/api/office/office.context#document) do objeto **Context** para acessar as propriedades e os métodos do objeto **Document**. Isso permite interagir com o conteúdo de documentos do Word, planilhas do Excel ou tarefas do Project. Do mesmo modo, com os suplementos do Outlook, você pode usar a propriedade [mailbox](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox) do objeto **Context** para acessar as propriedades e os métodos do objeto **Mailbox** e interagir com a mensagem, a solicitação de reunião ou o conteúdo do compromisso.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p103">For example, in task pane or content add-ins, you can use the [document](https://docs.microsoft.com/javascript/api/office/office.context#document) property of the **Context** object to access the properties and methods of the **Document** object to interact with the content of Word documents, Excel worksheets, or Project schedules. Similarly, in Outlook add-ins, you can use the [mailbox](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox) property of the **Context** object to access the properties and methods of the **Mailbox** object to interact with the message, meeting request, or appointment content.</span></span>

<span data-ttu-id="3a40a-116">O objeto **Contexto** também fornece acesso às propriedades [contentLanguage](https://docs.microsoft.com/javascript/api/office/office.context#contentlanguage) e [displayLanguage](https://docs.microsoft.com/javascript/api/office/office.context#displaylanguage) que permitem determinar a localidade (idioma) usada no documento ou no item, ou pelo aplicativo host.</span><span class="sxs-lookup"><span data-stu-id="3a40a-116">The  **Context** object also provides access to the [contentLanguage](https://docs.microsoft.com/javascript/api/office/office.context#contentlanguage) and [displayLanguage](https://docs.microsoft.com/javascript/api/office/office.context#displaylanguage) properties that let you determine the locale (language) used in the document or item, or by the host application.</span></span> <span data-ttu-id="3a40a-117">A propriedade [roamingSettings](https://docs.microsoft.com/javascript/api/office/office.context#roamingsettings) permite que você acesse os membros do objeto [RoamingSettings](https://docs.microsoft.com/javascript/api/office/office.context#roamingsettings), que armazena configurações específicas para o suplemento para caixas de correio de usuários individuais.</span><span class="sxs-lookup"><span data-stu-id="3a40a-117">The [roamingSettings](https://docs.microsoft.com/javascript/api/office/office.context#roamingsettings) property lets you access the members of the [RoamingSettings](https://docs.microsoft.com/javascript/api/office/office.context#roamingsettings) object, which stores settings specific to your add-in for individual users' mailboxes.</span></span> <span data-ttu-id="3a40a-118">Por fim, o objeto **Contexto** fornece uma propriedade [ui](https://docs.microsoft.com/javascript/api/office/office.ui) que permite que o suplemento inicie caixas de diálogo pop-up.</span><span class="sxs-lookup"><span data-stu-id="3a40a-118">Finally, the **Context** object provides a [ui](https://docs.microsoft.com/javascript/api/office/office.ui) property that enables your add-in to launch pop-up dialogs.</span></span>


## <a name="document-object"></a><span data-ttu-id="3a40a-119">Objeto Document</span><span class="sxs-lookup"><span data-stu-id="3a40a-119">Document object</span></span>

<span data-ttu-id="3a40a-120">**Aplica-se a:** tipos de suplemento de conteúdo e painel de tarefas</span><span class="sxs-lookup"><span data-stu-id="3a40a-120">**Applies to:** Content and task pane add-in types</span></span>

<span data-ttu-id="3a40a-p105">Para interagir com dados do documento no Excel, PowerPoint e Word, a API fornece o objeto [Document](https://docs.microsoft.com/javascript/api/office/office.document). Você pode usar objetos membros de **Document** para acessar dados das seguintes maneiras:</span><span class="sxs-lookup"><span data-stu-id="3a40a-p105">To interact with document data in Excel, PowerPoint, and Word, the API provides the [Document](https://docs.microsoft.com/javascript/api/office/office.document) object. You can use **Document** object members to access data from the following ways:</span></span>

- <span data-ttu-id="3a40a-123">Ler e gravar as seleções ativas na forma de texto, células contíguas (matrizes) ou tabelas.</span><span class="sxs-lookup"><span data-stu-id="3a40a-123">Read and write to active selections in the form of text, contiguous cells (matrices), or tables.</span></span>
    
- <span data-ttu-id="3a40a-124">Dados tabulares (matrizes ou tabelas).</span><span class="sxs-lookup"><span data-stu-id="3a40a-124">Tabular data (matrices or tables).</span></span>
    
- <span data-ttu-id="3a40a-125">Associações (criadas com os métodos "add" do objeto **Bindings**).</span><span class="sxs-lookup"><span data-stu-id="3a40a-125">Bindings (created with the "add" methods of the  **Bindings** object).</span></span>
    
- <span data-ttu-id="3a40a-126">Partes XML personalizadas (somente para Word).</span><span class="sxs-lookup"><span data-stu-id="3a40a-126">Custom XML parts (only for Word).</span></span>
    
- <span data-ttu-id="3a40a-127">Configurações ou estado do suplemento persistido por suplemento no documento.</span><span class="sxs-lookup"><span data-stu-id="3a40a-127">Settings or add-in state persisted per add-in on the document.</span></span>
    
<span data-ttu-id="3a40a-p106">Você também pode usar o objeto **Document** para interagir com os dados nos documentos do Project. A funcionalidade específica do Project para a API está documentada nos membros da classe abstrata [ProjectDocument](https://docs.microsoft.com/javascript/api/office/office.document). Para saber mais sobre a criação de suplementos de painel de tarefas, consulte [Suplementos de painel de tarefas para o Project](../project/project-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="3a40a-p106">You can also use the  **Document** object to interact with data in Project documents. The Project-specific functionality of the API is documented in the members [ProjectDocument](https://docs.microsoft.com/javascript/api/office/office.document) abstract class. For more information about creating task pane add-ins for Project, see [Task pane add-ins for Project](../project/project-add-ins.md).</span></span>

<span data-ttu-id="3a40a-131">Todas essas formas de acesso a dados têm início em uma instância do objeto abstrato **Document**.</span><span class="sxs-lookup"><span data-stu-id="3a40a-131">All these forms of data access start from an instance of the abstract  **Document** object.</span></span>

<span data-ttu-id="3a40a-p107">Você pode acessar uma instância do objeto **Document** quando o suplemento de painel de tarefas ou de conteúdo for iniciado com a propriedade [document](https://docs.microsoft.com/javascript/api/office/office.context#document) do objeto **Context**. O objeto **Document** define funções comuns do acesso a dados compartilhadas em documentos do Word e do Excel, além de fornecer acesso ao objeto **CustomXmlParts** para documentos do Word.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p107">You can access an instance of the  **Document** object when the task pane or content add-in is initialized by using the [document](https://docs.microsoft.com/javascript/api/office/office.context#document) property of the **Context** object. The **Document** object defines common data access functions shared across Word and Excel documents, and also provides access to the **CustomXmlParts** object for Word documents.</span></span>

<span data-ttu-id="3a40a-134">O objeto **Document** permite que os desenvolvedores acessem o conteúdo de documentos de quatro maneiras:</span><span class="sxs-lookup"><span data-stu-id="3a40a-134">The  **Document** object supports four ways for developers to access document contents:</span></span>


- <span data-ttu-id="3a40a-135">Acesso baseado em seleção</span><span class="sxs-lookup"><span data-stu-id="3a40a-135">Selection-based access</span></span>
    
- <span data-ttu-id="3a40a-136">Acesso baseado em associação</span><span class="sxs-lookup"><span data-stu-id="3a40a-136">Binding-based access</span></span>
    
- <span data-ttu-id="3a40a-137">Acesso baseado em partes personalizadas do XML (apenas para Word)</span><span class="sxs-lookup"><span data-stu-id="3a40a-137">Custom XML part-based access (Word only)</span></span>
    
- <span data-ttu-id="3a40a-138">Acesso baseado em documento (somente para Word e PowerPoint)</span><span class="sxs-lookup"><span data-stu-id="3a40a-138">Entire document-based access (PowerPoint and Word only)</span></span>
    
<span data-ttu-id="3a40a-139">Para ajudá-lo a entender como os métodos de acesso de dados baseados na seleção e na associação funcionam, explicaremos como as APIs de acesso aos dados proporcionam acesso consistente aos dados de diferentes aplicativos do Office.</span><span class="sxs-lookup"><span data-stu-id="3a40a-139">To help you understand how selection- and binding-based data access methods work, we will first explain how the data-access APIs provide consistent data access across different Office applications.</span></span>


### <a name="consistent-data-access-across-office-applications"></a><span data-ttu-id="3a40a-140">Acesso consistente aos dados entre aplicativos do Office</span><span class="sxs-lookup"><span data-stu-id="3a40a-140">Consistent data access across Office applications</span></span>

 <span data-ttu-id="3a40a-141">**Aplica-se a:** tipos de suplemento de conteúdo e painel de tarefas</span><span class="sxs-lookup"><span data-stu-id="3a40a-141">**Applies to:** Content and task pane add-in types</span></span>

<span data-ttu-id="3a40a-142">Para criar extensões que funcionam perfeitamente em diferentes documentos do Office, a API JavaScript para Office destaca as particularidades de todos os aplicativos do Office por meio de tipos de dados comuns e da habilidade de forçar diferentes conteúdos de documento para três tipos comuns de dados.</span><span class="sxs-lookup"><span data-stu-id="3a40a-142">To create extensions that seamlessly work across different Office documents, the JavaScript API for Office abstracts away the particularities of each Office application through common data types and the ability to coerce different document contents into three common data types.</span></span>


#### <a name="common-data-types"></a><span data-ttu-id="3a40a-143">Tipo comuns de dados</span><span class="sxs-lookup"><span data-stu-id="3a40a-143">Common data types</span></span>

<span data-ttu-id="3a40a-p108">Nos acessos a dados baseados em seleção e em associação, os conteúdos dos documentos são expostos por meio dos tipos de dados comuns a todos os aplicativos compatíveis do Office. No Office 2013, há suporte para três tipos de dados principais:</span><span class="sxs-lookup"><span data-stu-id="3a40a-p108">In both selection-based and binding-based data access, document contents are exposed through data types that are common across all the supported Office applications. In Office 2013, three main data types are supported:</span></span>



|<span data-ttu-id="3a40a-146">**Tipo de dados**</span><span class="sxs-lookup"><span data-stu-id="3a40a-146">**Data type**</span></span>|<span data-ttu-id="3a40a-147">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="3a40a-147">**Description**</span></span>|<span data-ttu-id="3a40a-148">**Suporte ao aplicativo de host**</span><span class="sxs-lookup"><span data-stu-id="3a40a-148">**Host application support**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="3a40a-149">Texto</span><span class="sxs-lookup"><span data-stu-id="3a40a-149">Text</span></span>|<span data-ttu-id="3a40a-150">Fornece uma representação, em uma cadeia de caracteres, dos dados na seleção ou associação.</span><span class="sxs-lookup"><span data-stu-id="3a40a-150">Provides a string representation of the data in the selection or binding.</span></span>|<span data-ttu-id="3a40a-p109">No Excel 2013, no Project 2013 e no PowerPoint 2013, há suporte apenas para texto sem formatação. No Word 2013, há suporte para três formatos de texto: texto sem formatação, HTML e OOXML (Office Open XML). Quando o texto é selecionado em uma célula no Excel, os métodos baseados em seleção realizam os processos de leitura e gravação para todo o conteúdo da célula, mesmo que apenas uma parte do texto esteja selecionada na célula. Quando texto é selecionado no Word e no PowerPoint, os métodos baseados em seleção realizam os processos de leitura e gravação apenas para os caracteres selecionados. O Project 2013 e o PowerPoint 2013 dão suporte apenas ao acesso a dados com base em seleção.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p109">In Excel 2013, Project 2013, and PowerPoint 2013, only plain text is supported. In Word 2013, three text formats are supported: plain text, HTML, and Office Open XML (OOXML). When text is selected in a cell in Excel, selection-based methods read and write to the entire contents of the cell, even if only a portion of the text is selected in the cell. When text is selected in Word and PowerPoint, selection-based methods read and write only to the run of characters that are selected. Project 2013 and PowerPoint 2013 support only selection-based data access.</span></span>|
|<span data-ttu-id="3a40a-156">Matriz</span><span class="sxs-lookup"><span data-stu-id="3a40a-156">Matrix</span></span>|<span data-ttu-id="3a40a-p110">Fornece os dados na seleção ou associação como uma **Array** bidimensional, que, no JavaScript, é implementada como uma matriz de matrizes. Por exemplo, duas linhas de valores **string** em duas colunas seriam ` [['a', 'b'], ['c', 'd']]`, e uma única coluna com três linhas seria `[['a'], ['b'], ['c']]`.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p110">Provides the data in the selection or binding as a two dimensional **Array**, which in JavaScript is implemented as an array of arrays. For example, two rows of **string** values in two columns would be ` [['a', 'b'], ['c', 'd']]`, and a single column of three rows would be `[['a'], ['b'], ['c']]`.</span></span>|<span data-ttu-id="3a40a-159">Há suporte ao acesso a dados de matriz apenas no Excel 2013 e no Word 2013.</span><span class="sxs-lookup"><span data-stu-id="3a40a-159">Matrix data access is supported only in Excel 2013 and Word 2013.</span></span>|
|<span data-ttu-id="3a40a-160">Tabela</span><span class="sxs-lookup"><span data-stu-id="3a40a-160">Table</span></span>|<span data-ttu-id="3a40a-p111">Fornece os dados na seleção ou associação como um objeto [TableData](https://docs.microsoft.com/javascript/api/office/office.tabledata). O objeto **TableData** expõe os dados por meio de propriedades **headers** e **rows**.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p111">Provides the data in the selection or binding as a [TableData](https://docs.microsoft.com/javascript/api/office/office.tabledata) object. The **TableData** object exposes the data through the **headers** and **rows** properties.</span></span>|<span data-ttu-id="3a40a-163">Há suporte ao acesso a dados de tabela apenas no Excel 2013 e no Word 2013.</span><span class="sxs-lookup"><span data-stu-id="3a40a-163">Table data access is supported only in Excel 2013 and Word 2013.</span></span>|

#### <a name="data-type-coercion"></a><span data-ttu-id="3a40a-164">Coerção de tipo de dados</span><span class="sxs-lookup"><span data-stu-id="3a40a-164">Data type coercion</span></span>

<span data-ttu-id="3a40a-p112">Os métodos de acesso de dados nos objetos **Document** e [Binding](https://docs.microsoft.com/javascript/api/office/office.binding) permitem especificar o tipo desejado de dados por meio do parâmetro _coercionType_ desses métodos e os valores de enumeração [CoercionType](https://docs.microsoft.com/javascript/api/office/office.coerciontype) correspondentes. Independentemente da forma real da associação, os diferentes aplicativos do Office dão suporte aos tipos de dados comuns ao tentar forçar os dados a usarem o tipo de dados solicitado. Por exemplo, se uma tabela ou um parágrafo do Word for selecionado, o desenvolvedor pode escolher se deseja lê-lo como texto sem formatação, Office Open XML ou tabela, e a implementação da API manipula as conversões de dados e as transformações necessárias.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p112">The data access methods on the **Document** and [Binding](https://docs.microsoft.com/javascript/api/office/office.binding) objects support specifying the desired data type using the _coercionType_ parameter of these methods, and corresponding [CoercionType](https://docs.microsoft.com/javascript/api/office/office.coerciontype) enumeration values. Regardless of the actual shape of the binding, the different Office applications support the common data types by trying to coerce the data into the requested data type. For example, if a Word table or paragraph is selected, the developer can specify to read it as plain text, HTML, Office Open XML, or a table, and the API implementation handles the necessary transformations and data conversions.</span></span>


> [!TIP]
> <span data-ttu-id="3a40a-p113">**Quando devo usar a matriz ou a tabela coercionType para o acesso aos dados?** Se for preciso que os dados tabulares cresçam dinamicamente quando linhas e colunas são adicionadas e você precisar trabalhar com os cabeçalhos da tabela, use o tipo de dados da tabela (especificando o parâmetro _coercionType_ de um método de acesso a dados do objeto **Document** ou **Binding** como `"table"` ou **Office.CoercionType.Table**). A adição de linhas e colunas na estrutura de dados tem suporte nos dados de tabela e matriz, mas o acréscimo de linhas e colunas só tem suporte para dados de tabela. Se você não planeja adicionar linhas e colunas, e os dados não exigem a funcionalidade do cabeçalho, use o tipo de dados de matriz (especificando o parâmetro _coercionType_ do método de acesso a dados como `"matrix"` ou **Office.CoercionType.Matrix**), que fornece um modelo mais simples para interagir com os dados.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p113">**When should you use the matrix versus table coercionType for data access?** If you need your tabular data to grow dynamically when rows and columns are added, and you must work with table headers, you should use the table data type (by specifying the _coercionType_ parameter of a **Document** or **Binding** object data access method as `"table"` or **Office.CoercionType.Table**). Adding rows and columns within the data structure is supported in both table and matrix data, but appending rows and columns is supported only for table data. If you aren't planning on adding rows and columns, and your data doesn't require header functionality, then you should use the matrix data type (by specifying the  _coercionType_ parameter of the data access method as `"matrix"` or **Office.CoercionType.Matrix**), which provides a simpler model of interacting with the data.</span></span>

<span data-ttu-id="3a40a-172">Se os dados não puderem ser forçados para o tipo especificado, a propriedade [AsyncResult.status](https://docs.microsoft.com/javascript/api/office/office.asyncresult.error) presente nos retornos de chamada retorna `"failed"`, e você pode usar a propriedade [AsyncResult.error](https://docs.microsoft.com/javascript/api/office/office.asyncresult.context) para acessar um objeto [Error](https://docs.microsoft.com/javascript/api/office/office.error) com informações sobre o motivo pelo qual a chamada de método falhou.</span><span class="sxs-lookup"><span data-stu-id="3a40a-172">If the data can't be coerced to the specified type, the [AsyncResult.status](https://docs.microsoft.com/javascript/api/office/office.asyncresult.error) property in the callback returns `"failed"`, and you can use the [AsyncResult.error](https://docs.microsoft.com/javascript/api/office/office.asyncresult.context) property to access an [Error](https://docs.microsoft.com/javascript/api/office/office.error) object with information about why the method call failed.</span></span>


## <a name="working-with-selections-using-the-document-object"></a><span data-ttu-id="3a40a-173">Trabalhar com seleções que usam o objeto Document</span><span class="sxs-lookup"><span data-stu-id="3a40a-173">Working with selections using the Document object</span></span>


<span data-ttu-id="3a40a-p114">O objeto **Document** expõe métodos que permitem ler e gravar a seleção atual do usuário de uma maneira "obter e definir". Para fazer isso, o objeto **Document** fornece os métodos **getSelectedDataAsync** e **setSelectedDataAsync**.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p114">The  **Document** object exposes methods that let you to read and write to the user's current selection in a "get and set" fashion. To do that, the **Document** object provides the **getSelectedDataAsync** and **setSelectedDataAsync** methods.</span></span>

<span data-ttu-id="3a40a-176">Para obter exemplos de códigos que demostram como realizar tarefas com seleções, consulte [Ler e gravar dados na seleção ativa em um documento ou uma planilha](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span><span class="sxs-lookup"><span data-stu-id="3a40a-176">For code examples that demonstrate how to perform tasks with selections, see [Read and write data to the active selection in a document or spreadsheet](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span></span>


## <a name="working-with-bindings-using-the-bindings-and-binding-objects"></a><span data-ttu-id="3a40a-177">Trabalhar com associações usando os objetos Bindings e Binding</span><span class="sxs-lookup"><span data-stu-id="3a40a-177">Working with bindings using the Bindings and Binding objects</span></span>


<span data-ttu-id="3a40a-p115">O acesso a dados baseado em associação habilita os suplementos de conteúdo e painel de tarefas a acessarem de forma consistente determinada região de um documento ou uma planilha por meio de um identificador vinculado a uma associação. Primeiro, o suplemento precisa estabelecer a associação chamando um dos métodos que vinculam uma parte do documento a um identificador exclusivo: [addFromPromptAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-), [addFromSelectionAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-) ou [addFromNamedItemAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-). Depois que a associação é estabelecida, o suplemento pode usar o identificador fornecido para acessar os dados contidos na região vinculada do documento ou da planilha. A criação de associações fornece o seguinte valor ao suplemento:</span><span class="sxs-lookup"><span data-stu-id="3a40a-p115">Binding-based data access enables content and task pane add-ins to consistently access a particular region of a document or spreadsheet through an identifier associated with a binding. The add-in first needs to establish the binding by calling one of the methods that associates a portion of the document with a unique identifier: [addFromPromptAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-), [addFromSelectionAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-), or [addFromNamedItemAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-). After the binding is established, the add-in can use the provided identifier to access the data contained in the associated region of the document or spreadsheet. Creating bindings provides the following value to your add-in:</span></span>


- <span data-ttu-id="3a40a-182">Permite o acesso a estruturas comuns de dados em aplicativos compatíveis do Office, como: tabelas, intervalos ou texto (uma execução contígua de caracteres).</span><span class="sxs-lookup"><span data-stu-id="3a40a-182">Permits access to common data structures across supported Office applications, such as: tables, ranges, or text (a contiguous run of characters).</span></span>
    
- <span data-ttu-id="3a40a-183">Habilita operações de leitura/gravação sem exigir que o usuário realize uma seleção.</span><span class="sxs-lookup"><span data-stu-id="3a40a-183">Enables read/write operations without requiring the user to make a selection.</span></span>
    
- <span data-ttu-id="3a40a-p116">Estabelece uma relação entre o suplemento e os dados presentes no documento. As associações estão presentes no documento e podem ser acessadas em um momento posterior.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p116">Establishes a relationship between the add-in and the data in the document. Bindings are persisted in the document, and can be accessed at a later time.</span></span>
    
<span data-ttu-id="3a40a-p117">A criação de uma associação também permite que você se inscreva em eventos de alteração de seleção e de dados que apresentem um escopo definido para essa região específica do documento ou da planilha. Isso significa que o suplemento só é notificado sobre alterações que ocorrem dentro da região associada, e não sobre alterações gerais que ocorrem em todo o documento ou planilha.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p117">Establishing a binding also allows you to subscribe to data and selection change events that are scoped to that particular region of the document or spreadsheet. This means that the add-in is only notified of changes that happen within the bound region as opposed to general changes across the whole document or spreadsheet.</span></span>

<span data-ttu-id="3a40a-p118">O objeto [Bindings](https://docs.microsoft.com/javascript/api/office/office.bindings) expõe um método [getAllAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#getallasync-options--callback-), que dá acesso ao conjunto de todas as associações estabelecidas no documento ou planilha. Uma associação individual pode ser acessada por sua ID. Para isso, use os métodos [Bindings.getBindingByIdAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#getbyidasync-id--options--callback-) ou [Office.select](https://docs.microsoft.com/javascript/api/office). Você pode estabelecer novas associações e remover as associações existentes usando um dos seguintes métodos para o objeto **Bindings**: [addFromSelectionAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-), [addFromPromptAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-), [addFromNamedItemAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-) ou [releaseByIdAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-).</span><span class="sxs-lookup"><span data-stu-id="3a40a-p118">The [Bindings](https://docs.microsoft.com/javascript/api/office/office.bindings) object exposes a [getAllAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#getallasync-options--callback-) method that gives access to the set of all bindings established on the document or spreadsheet. An individual binding can be accessed by its ID using either the [Bindings.getBindingByIdAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#getbyidasync-id--options--callback-) or [Office.select](https://docs.microsoft.com/javascript/api/office) methods. You can establish new bindings as well as remove existing ones by using one of the following methods of the **Bindings** object: [addFromSelectionAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-), [addFromPromptAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-), [addFromNamedItemAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-), or [releaseByIdAsync](https://docs.microsoft.com/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-).</span></span>

<span data-ttu-id="3a40a-191">Há três tipos diferentes de associações que podem ser especificadas com o parâmetro _bindingType_ durante a criação de uma nova associação com os métodos **addFromSelectionAsync**, **addFromPromptAsync** ou **addFromNamedItemAsync**:</span><span class="sxs-lookup"><span data-stu-id="3a40a-191">There are three different types of bindings that you specify with the  _bindingType_ parameter when you create a binding with the **addFromSelectionAsync**, **addFromPromptAsync** or **addFromNamedItemAsync** methods:</span></span>



|<span data-ttu-id="3a40a-192">**Tipo de associação**</span><span class="sxs-lookup"><span data-stu-id="3a40a-192">**Binding type**</span></span>|<span data-ttu-id="3a40a-193">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="3a40a-193">**Description**</span></span>|<span data-ttu-id="3a40a-194">**Suporte ao aplicativo de host**</span><span class="sxs-lookup"><span data-stu-id="3a40a-194">**Host application support**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="3a40a-195">Associação de texto</span><span class="sxs-lookup"><span data-stu-id="3a40a-195">Text binding</span></span>|<span data-ttu-id="3a40a-196">Associa a uma região do documento que pode ser representada como um texto.</span><span class="sxs-lookup"><span data-stu-id="3a40a-196">Binds to a region of the document that can be represented as text.</span></span>|<span data-ttu-id="3a40a-p119">No Word, a maioria das seleções contíguas são válidas, enquanto no Excel apenas as seleções de células únicas podem ser usadas para uma associação de texto. No Excel, só há suporte para texto sem formatação. No Word, há suporte para três formatos: texto sem formatação, HTML e Open XML do Office.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p119">In Word, most contiguous selections are valid, while in Excel only single cell selections can be the target of a text binding. In Excel, only plain text is supported. In Word, three formats are supported: plain text, HTML, and Open XML for Office.</span></span>|
|<span data-ttu-id="3a40a-200">Associação de matriz</span><span class="sxs-lookup"><span data-stu-id="3a40a-200">Matrix binding</span></span>|<span data-ttu-id="3a40a-p120">Associa a uma região fixa de um documento que contém dados tabulares sem cabeçalhos. Os dados de uma associação de matriz são gravados ou lidos como uma **Array** bidimensional, que é implementada como uma matriz de matrizes no JavaScript. Por exemplo, duas linhas de valores **string** em duas colunas podem ser gravadas ou lidas como ` [['a', 'b'], ['c', 'd']]`, e uma única coluna de três linhas pode ser gravada ou lida como `[['a'], ['b'], ['c']]`.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p120">Binds to a fixed region of a document that contains tabular data without headers. Data in a matrix binding is written or read as a two dimensional **Array**, which in JavaScript is implemented as an array of arrays. For example, two rows of **string** values in two columns can be written or read as ` [['a', 'b'], ['c', 'd']]`, and a single column of three rows can be written or read as `[['a'], ['b'], ['c']]`.</span></span>|<span data-ttu-id="3a40a-p121">No Excel, qualquer seleção contígua de células pode ser usada para estabelecer uma associação de matriz. No Word, apenas as tabelas dão suporte à associação de matriz.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p121">In Excel, any contiguous selection of cells can be used to establish a matrix binding. In Word, only tables support matrix binding.</span></span>|
|<span data-ttu-id="3a40a-206">Associação de tabelas</span><span class="sxs-lookup"><span data-stu-id="3a40a-206">Table binding</span></span>|<span data-ttu-id="3a40a-p122">Associa a uma região de um documento que contém uma tabela com cabeçalhos. Os dados em uma associação de tabela são gravados ou lidos como um objeto [TableData](https://docs.microsoft.com/javascript/api/office/office.tabledata). O objeto **TableData** expõe os dados por meio das propriedades **headers** e **rows**.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p122">Binds to a region of a document that contains a table with headers. Data in a table binding is written or read as a [TableData](https://docs.microsoft.com/javascript/api/office/office.tabledata) object. The **TableData** object exposes the data through the **headers** and **rows** properties.</span></span>|<span data-ttu-id="3a40a-p123">Qualquer tabela do Excel ou Word pode ser a base para uma associação de tabela. Após estabelecer uma associação de tabelas, as linhas ou colunas novas que um usuário adicionar à tabela são automaticamente incluídas na associação. </span><span class="sxs-lookup"><span data-stu-id="3a40a-p123">Any Excel or Word table can be the basis for a table binding. After you establish a table binding, each new row or column a user adds to the table is automatically included in the binding.</span></span> |

<br/>

<span data-ttu-id="3a40a-p124">Depois que uma associação é criada usando um dos três métodos "add" do objeto **Bindings**, é possível trabalhar com os dados e as propriedades da associação usando os métodos do objeto correspondente: [MatrixBinding](https://docs.microsoft.com/javascript/api/office/office.matrixbinding), [TableBinding](https://docs.microsoft.com/javascript/api/office/office.tablebinding) ou [TextBinding](https://docs.microsoft.com/javascript/api/office/office.textbinding). Esses três objetos herdam os métodos [getDataAsync](https://docs.microsoft.com/javascript/api/office/office.binding#getdataasync-options--callback-) e [setDataAsync](https://docs.microsoft.com/javascript/api/office/office.binding#setdataasync-data--options--callback-) do objeto **Binding**, o que o habilita a interagir com os dados associados.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p124">After a binding is created by using one of the three "add" methods of the  **Bindings** object, you can work with the binding's data and properties by using the methods of the corresponding object: [MatrixBinding](https://docs.microsoft.com/javascript/api/office/office.matrixbinding), [TableBinding](https://docs.microsoft.com/javascript/api/office/office.tablebinding), or [TextBinding](https://docs.microsoft.com/javascript/api/office/office.textbinding). All three of these objects inherit the [getDataAsync](https://docs.microsoft.com/javascript/api/office/office.binding#getdataasync-options--callback-) and [setDataAsync](https://docs.microsoft.com/javascript/api/office/office.binding#setdataasync-data--options--callback-) methods of the **Binding** object that enable to you interact with the bound data.</span></span>

<span data-ttu-id="3a40a-214">Para obter exemplos de códigos que demonstram como realizar tarefas com associações, consulte [Associar a regiões em um documento ou uma planilha](bind-to-regions-in-a-document-or-spreadsheet.md).</span><span class="sxs-lookup"><span data-stu-id="3a40a-214">For code examples that demonstrate how to perform tasks with bindings, see [Bind to regions in a document or spreadsheet](bind-to-regions-in-a-document-or-spreadsheet.md).</span></span>


## <a name="working-with-custom-xml-parts-using-the-customxmlparts-and-customxmlpart-objects"></a><span data-ttu-id="3a40a-215">Trabalhar com partes XML personalizadas usando os objetos CustomXmlParts e CustomXmlPart</span><span class="sxs-lookup"><span data-stu-id="3a40a-215">Working with custom XML parts using the CustomXmlParts and CustomXmlPart objects</span></span>


 <span data-ttu-id="3a40a-216">**Aplica-se a:** suplementos de painel de tarefas para Word</span><span class="sxs-lookup"><span data-stu-id="3a40a-216">**Applies to:** Task pane add-ins for Word</span></span>

<span data-ttu-id="3a40a-217">Os objetos [CustomXmlParts](https://docs.microsoft.com/javascript/api/office/office.customxmlparts) e [CustomXmlPart](https://docs.microsoft.com/javascript/api/office/office.customxmlpart) da API fornecem acesso a partes XML personalizadas de documentos do Word, que permitem a manipulação orientada por XML de conteúdo do documento.</span><span class="sxs-lookup"><span data-stu-id="3a40a-217">The [CustomXmlParts](https://docs.microsoft.com/javascript/api/office/office.customxmlparts) and [CustomXmlPart](https://docs.microsoft.com/javascript/api/office/office.customxmlpart) objects of the API provide access to custom XML parts in Word documents, which enable XML-driven manipulation of the contents of the document. For demonstrations of working with the CustomXmlParts and CustomXmlPart objects, see the Word-Add-in-Work-with-custom-XML-parts code sample.</span></span> <span data-ttu-id="3a40a-218">Para demonstrações de como trabalhar com objetos **CustomXmlParts** e **CustomXmlPart** confira o [ exemplo de código Word-Add-in-Work-with-custom-XML-parts ](https://github.com/OfficeDev/Word-Add-in-Work-with-custom-XML-parts).</span><span class="sxs-lookup"><span data-stu-id="3a40a-218">For demonstrations of working with the **CustomXmlParts** and **CustomXmlPart** objects, see the [Word-add-in-Work-with-custom-XML-parts](https://github.com/OfficeDev/Word-Add-in-Work-with-custom-XML-parts) code sample.</span></span>


## <a name="working-with-the-entire-document-using-the-getfileasync-method"></a><span data-ttu-id="3a40a-219">Trabalhar com o documento inteiro usando o método getFileAsync</span><span class="sxs-lookup"><span data-stu-id="3a40a-219">Working with the entire document using the getFileAsync method</span></span>


 <span data-ttu-id="3a40a-220">**Aplica-se a:** suplementos de painel de tarefas para Word e PowerPoint</span><span class="sxs-lookup"><span data-stu-id="3a40a-220">**Applies to:** Task pane add-ins for Word and PowerPoint</span></span>

<span data-ttu-id="3a40a-p126">O método [Document.getFileAsync](https://docs.microsoft.com/javascript/api/office/office.document#getfileasync-filetype--options--callback-) e os membros dos objetos [File](https://docs.microsoft.com/javascript/api/office/office.file) e [Slice](https://docs.microsoft.com/javascript/api/office/office.slice) fornecem a funcionalidade necessária para obter documentos inteiros do Word e PowerPoint em fatias (frações) de até 4 MB por vez. Para saber mais, consulte [Obter todo o documento por meio de um suplemento para PowerPoint ou Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span><span class="sxs-lookup"><span data-stu-id="3a40a-p126">The [Document.getFileAsync](https://docs.microsoft.com/javascript/api/office/office.document#getfileasync-filetype--options--callback-) method and members of the [File](https://docs.microsoft.com/javascript/api/office/office.file) and [Slice](https://docs.microsoft.com/javascript/api/office/office.slice) objects to provide functionality for getting entire Word and PowerPoint document files in slices (chunks) of up to 4 MB at a time. For more information, see [Get the whole document from an add-in for PowerPoint or Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span></span>


## <a name="mailbox-object"></a><span data-ttu-id="3a40a-223">Objeto Mailbox</span><span class="sxs-lookup"><span data-stu-id="3a40a-223">Mailbox object</span></span>

<span data-ttu-id="3a40a-224">**Aplica-se a:** suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="3a40a-224">**Applies to:** Outlook add-ins</span></span>

<span data-ttu-id="3a40a-p127">Os suplementos do Outlook usam principalmente um subconjunto da API exposta no objeto [Mailbox](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox). Para acessar os objetos e membros específicos para suplementos do Outlook, como o objeto [Item](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox), use a propriedade [mailbox](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox) do objeto **Context** para acessar o objeto **Mailbox**, conforme exibido na linha de código abaixo.</span><span class="sxs-lookup"><span data-stu-id="3a40a-p127">Outlook add-ins primarily use a subset of the API exposed through the [Mailbox](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox) object. To access the objects and members specifically for use in Outlook add-ins, such as the [Item](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox) object, you use the [mailbox](https://docs.microsoft.com/javascript/api/outlook/Office.mailbox) property of the **Context** object to access the **Mailbox** object, as shown in the following line of code.</span></span>




```js
// Access the Item object.
var item = Office.context.mailbox.item;

```

<span data-ttu-id="3a40a-227">Além disso, os suplementos do Outlook podem usar os seguintes objetos:</span><span class="sxs-lookup"><span data-stu-id="3a40a-227">Additionally, Outlook add-ins can use the following objects:</span></span>


-  <span data-ttu-id="3a40a-228">Objeto **Office**: para inicialização.</span><span class="sxs-lookup"><span data-stu-id="3a40a-228">**Office** object: for initialization.</span></span>
    
-  <span data-ttu-id="3a40a-229">Objeto **Context**: para acesso a propriedades de conteúdo e idioma de exibição.</span><span class="sxs-lookup"><span data-stu-id="3a40a-229">**Context** object: for access to content and display language properties.</span></span>
    
-  <span data-ttu-id="3a40a-230">Objeto **RoamingSettings**: para salvar as configurações personalizadas do suplemento do Outlook na caixa de correio do usuário em que o suplemento está instalado.</span><span class="sxs-lookup"><span data-stu-id="3a40a-230">**RoamingSettings** object: for saving Outlook add-in-specific custom settings to the user's mailbox where the add-in is installed.</span></span>
    
<span data-ttu-id="3a40a-231">Para obter informações sobre como usar o JavaScript em suplementos do Outlook, confira [Suplementos do Outlook ](https://docs.microsoft.com/outlook/add-ins/).</span><span class="sxs-lookup"><span data-stu-id="3a40a-231">For information about using JavaScript in Outlook add-ins, see [Outlook add-ins](https://docs.microsoft.com/outlook/add-ins/).</span></span>