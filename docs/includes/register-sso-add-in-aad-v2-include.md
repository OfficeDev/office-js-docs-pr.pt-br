

1. <span data-ttu-id="a55ec-101">Acesse a página [Portal do Azure - Registros de aplicativo](https://go.microsoft.com/fwlink/?linkid=2083908) para registrar o seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a55ec-101">Navigate to the [Azure portal - App registrations](https://go.microsoft.com/fwlink/?linkid=2083908) page to register your app.</span></span>

1. <span data-ttu-id="a55ec-102">Entre com as credenciais de ***administrador*** em sua locação do Office 365.</span><span class="sxs-lookup"><span data-stu-id="a55ec-102">Sign in with the ***admin*** credentials to your Office 365 tenancy.</span></span> <span data-ttu-id="a55ec-103">Por exemplo, MeuNome@contoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="a55ec-103">For example, MyName@contoso.onmicrosoft.com.</span></span>

1. <span data-ttu-id="a55ec-104">Selecione **Novo registro**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-104">Select **New registration**.</span></span> <span data-ttu-id="a55ec-105">Na página **Registrar um aplicativo**, defina os valores da seguinte forma.</span><span class="sxs-lookup"><span data-stu-id="a55ec-105">On the **Register an application** page, set the values as follows.</span></span>

    * <span data-ttu-id="a55ec-106">Definir **Nome** ao **$SUPLEMENTO-NOME$**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-106">Set **Name** to **$ADD-IN-NAME$**.</span></span>
    * <span data-ttu-id="a55ec-107">Defina **Tipos de conta com suporte** para **Contas em qualquer diretório organizacional e contas pessoais da Microsoft (por exemplo, Skype, Xbox, Outlook.com)**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-107">Set **Supported account types** to **Accounts in any organizational directory and personal Microsoft accounts (e.g. Skype, Xbox, Outlook.com)**.</span></span>
    * <span data-ttu-id="a55ec-108">Deixe o **URI de Redirecionamento** vazio.</span><span class="sxs-lookup"><span data-stu-id="a55ec-108">Leave **Redirect URI** empty.</span></span>
    * <span data-ttu-id="a55ec-109">Escolha **Registrar**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-109">Choose **Register**.</span></span>

1. <span data-ttu-id="a55ec-110">Na página **$SUPLEMENTO-NOME$**, copie e salve os valores para a **ID do aplicativo (cliente)** e a **ID do diretório (locatário)**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-110">On the **$ADD-IN-NAME$** page, copy and save the values for the **Application (client) ID** and the **Directory (tenant) ID**.</span></span> <span data-ttu-id="a55ec-111">Use ambos os valores nos procedimentos posteriores.</span><span class="sxs-lookup"><span data-stu-id="a55ec-111">You'll use both of them in later procedures.</span></span>

    > [!NOTE]
    > <span data-ttu-id="a55ec-112">Essa ID é o valor "audience" (público) quando outros aplicativos, como o aplicativo host do Office (por exemplo, PowerPoint, Word, Excel), buscam o acesso autorizado ao aplicativo.</span><span class="sxs-lookup"><span data-stu-id="a55ec-112">This ID is the "audience" value when other applications, such as the Office host application (e.g., PowerPoint, Word, Excel), seek authorized access to the application.</span></span> <span data-ttu-id="a55ec-113">Também é a "ID do cliente" do aplicativo quando ela, por sua vez, busca acesso autorizado ao Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="a55ec-113">It is also the "client ID" of the application when it, in turn, seeks authorized access to Microsoft Graph.</span></span>

1. <span data-ttu-id="a55ec-114">Selecione **Certificados e segredos** sob **Gerenciar**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-114">Select **Certificates & secrets** under **Manage**.</span></span> <span data-ttu-id="a55ec-115">Selecione o botão **Novo segredo do cliente**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-115">Select the **New client secret** button.</span></span> <span data-ttu-id="a55ec-116">Insira um valor para **Descrição** e, em seguida, selecione uma opção adequada para **Expira** e escolha **Adicionar**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-116">Enter a value for **Description** then select an appropriate option for **Expires** and choose **Add**.</span></span> <span data-ttu-id="a55ec-117">*Copiar o valor de segredo do cliente imediatamente e salvá-lo com a ID de aplicativo* antes de prosseguir, pois ele será necessário em um procedimento posterior.</span><span class="sxs-lookup"><span data-stu-id="a55ec-117">*Copy the client secret value immediately and save it with the application ID* before proceeding as you'll need it in a later procedure.</span></span>

1. <span data-ttu-id="a55ec-118">Selecionar **Expor uma API** em **Gerenciar**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-118">Select **Expose an API** under **Manage**.</span></span> <span data-ttu-id="a55ec-119">Selecione o link **Definir** para gerar o URI da ID de Aplicativo no formato "api: / / $App ID GUID$".</span><span class="sxs-lookup"><span data-stu-id="a55ec-119">Select the **Set** link to generate the Application ID URI in the form "api://$App ID GUID$".</span></span> <span data-ttu-id="a55ec-120">Inserir o **$FQDN-WITHOUT-PROTOCOL$** (com uma barra "/" acrescentada ao final) entre as duas barras e o GUID.</span><span class="sxs-lookup"><span data-stu-id="a55ec-120">Insert the **$FQDN-WITHOUT-PROTOCOL$** (with a forward slash "/" appended to the end) between the double forward slashes and the GUID.</span></span> <span data-ttu-id="a55ec-121">A ID inteira deve ter o formulário `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$`; por exemplo `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span><span class="sxs-lookup"><span data-stu-id="a55ec-121">The entire ID should have the form `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$`; for example `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.</span></span>

    > [!NOTE]
    > <span data-ttu-id="a55ec-122">Você pode receber um erro impreciso nesse momento, dizendo "O URI da ID de aplicativo deve ser um URI válido começando HTTPS, API, URN, MS APPX.</span><span class="sxs-lookup"><span data-stu-id="a55ec-122">You may get an inaccurate error at this point saying "The application ID URI must be a valid URI starting with HTTPS, API, URN, MS-APPX.</span></span> <span data-ttu-id="a55ec-123">Ele não pode terminar com uma barra."</span><span class="sxs-lookup"><span data-stu-id="a55ec-123">It must not end in a slash."</span></span> <span data-ttu-id="a55ec-124">Se a ID atende às condições mencionadas, ignore o erro e salve suas alterações.</span><span class="sxs-lookup"><span data-stu-id="a55ec-124">If the ID meets the stated conditions, ignore the error and save your change.</span></span>

    > [!NOTE]
    > <span data-ttu-id="a55ec-125">Se você receber um erro dizendo que o domínio já pertence a alguém, mas você é o seu proprietário, siga o procedimento em [Início Rápido: Adicionar um domínio personalizado ao Azure Active Directory](/azure/active-directory/add-custom-domain) para registrá-lo e, em seguida, repita esta etapa.</span><span class="sxs-lookup"><span data-stu-id="a55ec-125">If you get an error saying that the domain is already owned but you own it, follow the procedure at [Quickstart: Add a custom domain name to Azure Active Directory](/azure/active-directory/add-custom-domain) to register it, and then repeat this step.</span></span> <span data-ttu-id="a55ec-126">(Esse erro também poderá ocorrer se você não estiver conectado com as credenciais de administrador no locatário do Office 365.</span><span class="sxs-lookup"><span data-stu-id="a55ec-126">(This error can also occur if you are not signed in with credentials of an admin in the Office 365 tenancy.</span></span> <span data-ttu-id="a55ec-127">(Confira a etapa 2.)</span><span class="sxs-lookup"><span data-stu-id="a55ec-127">See step 2.</span></span> <span data-ttu-id="a55ec-128">Saia e entre novamente com credenciais de administrador e repita o processo da etapa 3.)</span><span class="sxs-lookup"><span data-stu-id="a55ec-128">Sign out and sign in again with admin credentials and repeat the process from step 3.)</span></span>

1. <span data-ttu-id="a55ec-129">Selecione o botão **Adicionar um escopo**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-129">Select the **Add a scope** button.</span></span> <span data-ttu-id="a55ec-130">No painel que se abre, insira `access_as_user` como o **Nome de escopo**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-130">In the panel that opens, enter `access_as_user` as the **Scope name**.</span></span>

1. <span data-ttu-id="a55ec-131">Definir **Quem pode consentir?** aos **Administradores e usuários**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-131">Set **Who can consent?** to **Admins and users**.</span></span>

1. <span data-ttu-id="a55ec-132">Preencha os campos para configurar a solicitação de consentimento de administrador e usuário com valores apropriados ao `access_as_user` escopo que permite que o aplicativo de host do Office use os seus APIs de suplemento da web com os mesmos direitos que o usuário atual.</span><span class="sxs-lookup"><span data-stu-id="a55ec-132">Fill in the fields for configuring the admin and user consent prompts with values that are appropriate for the `access_as_user` scope which enables the Office host application to use your add-in's web APIs with the same rights as the current user.</span></span> <span data-ttu-id="a55ec-133">Sugestões:</span><span class="sxs-lookup"><span data-stu-id="a55ec-133">Suggestions:</span></span>

    - <span data-ttu-id="a55ec-134">**Título de autorização de administrador:** Office pode funcionar como o usuário.</span><span class="sxs-lookup"><span data-stu-id="a55ec-134">**Admin consent title:** Office can act as the user.</span></span>
    - <span data-ttu-id="a55ec-135">**Descrição de autorização de administrador:** Permite ao Office chamar os APIs de suplemento da web com os mesmos direitos que o usuário atual.</span><span class="sxs-lookup"><span data-stu-id="a55ec-135">**Admin consent description:** Enable Office to call the add-in's web APIs with the same rights as the current user.</span></span>
    - <span data-ttu-id="a55ec-136">**Título de autorização de usuário:** O Office pode funcionar como se fosse você.</span><span class="sxs-lookup"><span data-stu-id="a55ec-136">**User consent title:** Office can act as you.</span></span>
    - <span data-ttu-id="a55ec-137">**Descrição de autorização de administrador:** Permite ao Office chamar os APIs de suplemento da web com os mesmos direitos que você possui.</span><span class="sxs-lookup"><span data-stu-id="a55ec-137">**Admin consent description:** Enable Office to call the add-in's web APIs with the same rights that you have.</span></span>

1. <span data-ttu-id="a55ec-138">Verifique se o **Estado** está definido como **Habilitado**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-138">Ensure that **State** is set to **Enabled**.</span></span>

1. <span data-ttu-id="a55ec-139">Selecione **Adicionar escopo**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-139">Select **Add scope**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="a55ec-140">A parte de domínio do **Nome de escopo** exibidos logo abaixo do campo de texto deve corresponder automaticamente ao **URI de ID do aplicativo** definidos na etapa anterior com `/access_as_user` acrescentado ao final; por exemplo, `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`.</span><span class="sxs-lookup"><span data-stu-id="a55ec-140">The domain part of the **Scope name** displayed just below the text field should automatically match the **Application ID URI** set in the previous step, with `/access_as_user` appended to the end; for example, `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`.</span></span>

1. <span data-ttu-id="a55ec-141">Na seção **Aplicativos clientes autorizados**, você identifica os aplicativos que deseja autorizar para o aplicativo da Web do seu suplemento.</span><span class="sxs-lookup"><span data-stu-id="a55ec-141">In the **Authorized client applications** section, you identify the applications that you want to authorize to your add-in's web application.</span></span> <span data-ttu-id="a55ec-142">Cada uma das seguintes IDs precisa ser pré-autorizada.</span><span class="sxs-lookup"><span data-stu-id="a55ec-142">Each of the following IDs needs to be pre-authorized.</span></span>
  
    * <span data-ttu-id="a55ec-143">`d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)</span><span class="sxs-lookup"><span data-stu-id="a55ec-143">`d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)</span></span>
    * <span data-ttu-id="a55ec-144">`ea5a67f6-b6f3-4338-b240-c655ddc3cc8e` (Microsoft Office)</span><span class="sxs-lookup"><span data-stu-id="a55ec-144">`ea5a67f6-b6f3-4338-b240-c655ddc3cc8e` (Microsoft Office)</span></span>
    * <span data-ttu-id="a55ec-145">`57fb890c-0dab-4253-a5e0-7188c88b2bb4`(Office na Web)</span><span class="sxs-lookup"><span data-stu-id="a55ec-145">`57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office on the web)</span></span>
    * <span data-ttu-id="a55ec-146">`bc59ab01-8403-45c6-8796-ac3ef710b3e3`(Outlook na Web)</span><span class="sxs-lookup"><span data-stu-id="a55ec-146">`bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Outlook on the web)</span></span>

    <span data-ttu-id="a55ec-147">Para cada ID, siga estas etapas:</span><span class="sxs-lookup"><span data-stu-id="a55ec-147">For each ID, take these steps:</span></span>

      <span data-ttu-id="a55ec-148">a.</span><span class="sxs-lookup"><span data-stu-id="a55ec-148">a.</span></span> <span data-ttu-id="a55ec-149">Selecione o botão **Adicionar um aplicativo cliente** e, no painel que se abre, defina o **ID do cliente** para o respectivo GUID e marque a caixa `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user`.</span><span class="sxs-lookup"><span data-stu-id="a55ec-149">Select **Add a client application** button then, in the panel that opens, set the **Client ID** to the respective GUID and check the box for `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user`.</span></span>

      <span data-ttu-id="a55ec-150">b.</span><span class="sxs-lookup"><span data-stu-id="a55ec-150">b.</span></span> <span data-ttu-id="a55ec-151">Selecione **Adicionar aplicativo**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-151">Select **Add application**.</span></span>

1. <span data-ttu-id="a55ec-152">Selecione **Autenticação** em **Gerenciar**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-152">Select **Authentication** under **Manage**.</span></span> <span data-ttu-id="a55ec-153">Na seção **URIs de redirecionamento**, selecione **Web** no **Tipo** de lista suspensa, em seguida, defina o valor do**URI de redirecionamento** para `https://$FQDN-WITHOUT-PROTOCOL$`.</span><span class="sxs-lookup"><span data-stu-id="a55ec-153">In the **Redirect URIs** section, select **Web** in the **Type** dropdown then set the **Redirect URI** value to `https://$FQDN-WITHOUT-PROTOCOL$`.</span></span>

1. <span data-ttu-id="a55ec-154">Na parte superior da página, selecione **Salvar**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-154">Select **Save** at the top of the form.</span></span>

1. <span data-ttu-id="a55ec-155">Selecione **Permissões para API** em **Gerenciar** e selecione **Adicionar uma permissão**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-155">Select **API permissions** under **Manage** and select **Add a permission**.</span></span> <span data-ttu-id="a55ec-156">No painel que se abre, escolha **Microsoft Graph** e, em seguida, escolha **Permissões delegadas**.</span><span class="sxs-lookup"><span data-stu-id="a55ec-156">On the panel that opens, choose **Microsoft Graph** and then choose **Delegated permissions**.</span></span>

1. <span data-ttu-id="a55ec-157">Use a caixa de pesquisa **Selecionar permissões** para procurar as permissões que o seu suplemento precisa.</span><span class="sxs-lookup"><span data-stu-id="a55ec-157">Use the **Select permissions** search box to search for the permissions your add-in needs.</span></span> <span data-ttu-id="a55ec-158">Eis alguns exemplos.</span><span class="sxs-lookup"><span data-stu-id="a55ec-158">The following are examples.</span></span>

    * <span data-ttu-id="a55ec-159">Files.Read.All</span><span class="sxs-lookup"><span data-stu-id="a55ec-159">Files.Read.All</span></span>
    * <span data-ttu-id="a55ec-160">offline_access</span><span class="sxs-lookup"><span data-stu-id="a55ec-160">offline_access</span></span>
    * <span data-ttu-id="a55ec-161">openid</span><span class="sxs-lookup"><span data-stu-id="a55ec-161">openid</span></span>
    * <span data-ttu-id="a55ec-162">perfil</span><span class="sxs-lookup"><span data-stu-id="a55ec-162">profile</span></span>

    > [!NOTE]
    > <span data-ttu-id="a55ec-163">A permissão `User.Read` pode já estar listada por padrão.</span><span class="sxs-lookup"><span data-stu-id="a55ec-163">The `User.Read` permission may already be listed by default.</span></span> <span data-ttu-id="a55ec-164">É uma boa prática não pedir permissões desnecessárias, por isso recomendamos desmarcar a caixa para essa permissão se o suplemento não precisar dela.</span><span class="sxs-lookup"><span data-stu-id="a55ec-164">It is a good practice not to ask for permissions that are not needed, so we recommend that you uncheck the box for this permission if your add-in does not actually need it.</span></span>

1. <span data-ttu-id="a55ec-165">Marque a caixa de seleção para cada permissão como aparece (observe que as permissões não permanecem visíveis na lista ao selecionar cada uma delas).</span><span class="sxs-lookup"><span data-stu-id="a55ec-165">Select the check box for each permission as it appears (note that the permissions will not remain visible in the list as you select each one).</span></span> <span data-ttu-id="a55ec-166">Depois de selecionar as permissões que o suplemento precisa, selecione o botão **Adicionar permissões** na parte inferior do painel.</span><span class="sxs-lookup"><span data-stu-id="a55ec-166">After selecting the permissions that your add-in needs, select the **Add permissions** button at the bottom of the panel.</span></span>
