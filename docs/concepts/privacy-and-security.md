---
title: Privacidade e segurança para suplementos do Office
description: Saiba mais sobre os aspectos de privacidade e segurança da plataforma de suplementos do Office.
ms.date: 09/14/2020
localization_priority: Normal
ms.openlocfilehash: 4e17463ee7293c74d905238904baef1344a6e6b3
ms.sourcegitcommit: 7f25a4a15c91e173c11c2cea03bfb605d4d5a98d
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/14/2020
ms.locfileid: "47652577"
---
# <a name="privacy-and-security-for-office-add-ins"></a><span data-ttu-id="56d1b-103">Privacidade e segurança para suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="56d1b-103">Privacy and security for Office Add-ins</span></span>

## <a name="understanding-the-add-in-runtime"></a><span data-ttu-id="56d1b-104">Noções básicas sobre o tempo de execução do suplemento</span><span class="sxs-lookup"><span data-stu-id="56d1b-104">Understanding the add-in runtime</span></span>

<span data-ttu-id="56d1b-105">Os suplementos do Office são protegidos por um ambiente de tempo de execução de suplemento, um modelo de permissões com várias camadas e administradores de desempenho.</span><span class="sxs-lookup"><span data-stu-id="56d1b-105">Office Add-ins are secured by an add-in runtime environment, a multiple-tier permissions model, and performance governors.</span></span> <span data-ttu-id="56d1b-106">Essa estrutura protege a experiência do usuário das seguintes maneiras.</span><span class="sxs-lookup"><span data-stu-id="56d1b-106">This framework protects the user's experience in the following ways.</span></span>

- <span data-ttu-id="56d1b-107">O acesso ao quadro da interface do usuário do aplicativo cliente do Office é gerenciado.</span><span class="sxs-lookup"><span data-stu-id="56d1b-107">Access to the Office client application's UI frame is managed.</span></span>

- <span data-ttu-id="56d1b-108">Só é permitido o acesso indireto ao thread de interface do usuário do aplicativo cliente do Office.</span><span class="sxs-lookup"><span data-stu-id="56d1b-108">Only indirect access to the Office client application's UI thread is allowed.</span></span>

- <span data-ttu-id="56d1b-109">As interações modais não são permitidas-por exemplo, as chamadas para JavaScript `alert` , `confirm` e `prompt` funções não são permitidas porque são modais.</span><span class="sxs-lookup"><span data-stu-id="56d1b-109">Modal interactions aren't allowed - for example, calls to JavaScript `alert`, `confirm`, and `prompt` functions aren't allowed because they're modal.</span></span>

<span data-ttu-id="56d1b-110">Além disso, a estrutura de tempo de execução fornece os seguintes benefícios para garantir que um suplemento do Office não possa danificar o ambiente do usuário.</span><span class="sxs-lookup"><span data-stu-id="56d1b-110">Further, the runtime framework provides the following benefits to ensure that an Office Add-in can't damage the user's environment.</span></span>

- <span data-ttu-id="56d1b-111">Isola o processo no qual o suplemento é executado.</span><span class="sxs-lookup"><span data-stu-id="56d1b-111">Isolates the process the add-in runs in.</span></span>

- <span data-ttu-id="56d1b-112">Não exige substituição de .dll ou de .exe ou de componentes ActiveX.</span><span class="sxs-lookup"><span data-stu-id="56d1b-112">Doesn't require .dll or .exe replacement or ActiveX components.</span></span>

- <span data-ttu-id="56d1b-113">Facilita a instalação e a desinstalação do suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-113">Makes add-ins easy to install and uninstall.</span></span>

<span data-ttu-id="56d1b-114">E o uso de memória, CPU e recursos de rede por suplementos do Office é governável para garantir que o bom desempenho e a confiabilidade sejam mantidos.</span><span class="sxs-lookup"><span data-stu-id="56d1b-114">Also, the use of memory, CPU, and network resources by Office Add-ins is governable to ensure that good performance and reliability are maintained.</span></span>

<span data-ttu-id="56d1b-115">As seções a seguir descrevem brevemente como a arquitetura de tempo de execução dá suporte a suplementos em execução em clientes do Office em dispositivos Windows, em dispositivos Mac OS X e navegadores da web.</span><span class="sxs-lookup"><span data-stu-id="56d1b-115">The following sections briefly describe how the runtime architecture supports running add-ins in Office clients on Windows-based devices, on OS X Mac devices, and in web browsers.</span></span>

### <a name="clients-on-windows-and-os-x-devices"></a><span data-ttu-id="56d1b-116">Clientes para dispositivos Windows e OS X</span><span class="sxs-lookup"><span data-stu-id="56d1b-116">Clients on Windows and OS X devices</span></span>

<span data-ttu-id="56d1b-p102">Em clientes com suporte para dispositivos de área de trabalho e de tablet, como Excel no Windows e Outlook no Windows e no Mac, há suporte aos suplementos do Office por meio da integração de um componente no processo, o tempo de execução de suplementos do Office, que gerencia o ciclo de vida do suplemento e habilita a interoperabilidade entre o suplemento e o aplicativo cliente. A página da web do suplemento em si é hospedada fora do processo. Como mostrado na figura 1, em um dispositivo Windows para área de trabalho ou tablet, [a página da Web do suplemento é hospedada em um controle do Internet Explorer ou Microsoft Edge](browsers-used-by-office-web-add-ins.md) que, por sua vez, é hospedado em um processo de tempo de execução de suplemento que fornece segurança e isolamento de desempenho.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p102">In supported clients for desktop and tablet devices, such as Excel on Windows, and Outlook on Windows and Mac, Office Add-ins are supported by integrating an in-process component, the Office Add-ins runtime, which manages the add-in lifecycle and enables interoperability between the add-in and the client application. The add-in webpage itself is hosted out-of-process. As shown in figure 1, on a Windows desktop or tablet device, [the add-in webpage is hosted inside an Internet Explorer or Microsoft Edge control](browsers-used-by-office-web-add-ins.md) which, in turn, is hosted inside an add-in runtime process that provides security and performance isolation.</span></span>

<span data-ttu-id="56d1b-p103">Nos computadores com o Windows, o Modo Protegido no Internet Explorer deve estar habilitado para a Zona de Site Restrito. Isso é normalmente ativado por padrão. Se estiver desabilitado, [ocorrerá um erro](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer) ao tentar iniciar um suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p103">On Windows desktops, Protected Mode in Internet Explorer must be enabled for the Restricted Site Zone. This is typically enabled by default. If it is disabled, an [error will occur](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer) when you try to launch an add-in.</span></span>

<span data-ttu-id="56d1b-123">*Figura 1. Ambiente de execução dos Suplementos do Office nos clientes Windows para área de trabalho e tablet*</span><span class="sxs-lookup"><span data-stu-id="56d1b-123">*Figure 1. Office Add-ins runtime environment in Windows-based desktop and tablet clients*</span></span>

![Infraestrutura de cliente avançado](../images/dk2-agave-overview-02.png)

<span data-ttu-id="56d1b-125">Como mostrado na figura a seguir, em um computador de mesa Mac OS X, a página da Web do suplemento é hospedada em um processo de host de tempo de execução WebKit em área restrita que ajuda a fornecer um nível semelhante de segurança e proteção de desempenho.</span><span class="sxs-lookup"><span data-stu-id="56d1b-125">As shown in the following figure, on an OS X Mac desktop, the add-in web page is hosted inside a sandboxed WebKit runtime host process which helps provide similar level of security and performance protection.</span></span>

<span data-ttu-id="56d1b-126">*Figura 2. Ambiente de execução dos Suplementos do Office nos clientes Mac OS X*</span><span class="sxs-lookup"><span data-stu-id="56d1b-126">*Figure 2. Office Add-ins runtime environment in OS X Mac clients*</span></span>

![Apps for Office runtime environment on OS X Mac](../images/dk2-agave-overview-mac-02.png)

<span data-ttu-id="56d1b-128">O tempo de execução de Suplementos do Office gerencia a comunicação entre processos, a conversão de eventos e chamadas à API JavaScript em itens nativos, bem como o suporte de comunicação remota da interface do usuário para habilitar o suplemento a ser processado dentro do documento, em um painel de tarefas ou de forma adjacente a uma mensagem de e-mail, solicitação de reunião ou compromisso.</span><span class="sxs-lookup"><span data-stu-id="56d1b-128">The Office Add-ins runtime manages interprocess communication, the translation of JavaScript API calls and events into native ones, as well as UI remoting support to enable the add-in to be rendered inside the document, in a task pane, or adjacent to an email message, meeting request, or appointment.</span></span>

### <a name="web-clients"></a><span data-ttu-id="56d1b-129">Clientes Web</span><span class="sxs-lookup"><span data-stu-id="56d1b-129">Web clients</span></span>

<span data-ttu-id="56d1b-130">Em clientes Web com suporte, os suplementos do Office são hospedados em um **iframe** que é executado usando o atributo de **área restrita** do HTML5.</span><span class="sxs-lookup"><span data-stu-id="56d1b-130">In supported Web clients, Office Add-ins are hosted in an **iframe** that runs using the HTML5 **sandbox** attribute.</span></span> <span data-ttu-id="56d1b-131">Não são permitidos componentes ActiveX nem a navegação na página principal do cliente Web.</span><span class="sxs-lookup"><span data-stu-id="56d1b-131">ActiveX components or navigating the main page of the web client are not allowed.</span></span> <span data-ttu-id="56d1b-132">O suporte a Suplementos do Office é habilitado em clientes Web por meio da integração da API JavaScript para Office.</span><span class="sxs-lookup"><span data-stu-id="56d1b-132">Office Add-ins support is enabled in the web clients by the integration of the JavaScript API for Office.</span></span> <span data-ttu-id="56d1b-133">De maneira semelhante aos aplicativos cliente de área de trabalho, a API JavaScript gerencia o ciclo de vida do suplemento e a interoperabilidade entre o suplemento e o cliente Web.</span><span class="sxs-lookup"><span data-stu-id="56d1b-133">In a similar way to the desktop client applications, the JavaScript API manages the add-in lifecycle and interoperability between the add-in and the web client.</span></span> <span data-ttu-id="56d1b-134">Essa interoperabilidade é implementada por meio de uma infraestrutura especial de comunicação de mensagens de publicação entre quadros.</span><span class="sxs-lookup"><span data-stu-id="56d1b-134">This interoperability is implemented by using a special cross-frame post message communication infrastructure.</span></span> <span data-ttu-id="56d1b-135">A mesma biblioteca JavaScript (Office.js) que é usada em clientes de área de trabalho está disponível para interagir com o cliente Web.</span><span class="sxs-lookup"><span data-stu-id="56d1b-135">The same JavaScript library (Office.js) that is used on desktop clients is available to interact with the web client.</span></span> <span data-ttu-id="56d1b-136">A figura a seguir mostra a infraestrutura que oferece suporte a suplementos no Office em execução no navegador, e os componentes relevantes (o cliente da Web, o **iframe**, o tempo de execução de suplementos do Office e a API JavaScript para Office) que são necessários para dar suporte a eles.</span><span class="sxs-lookup"><span data-stu-id="56d1b-136">The following figure shows the infrastructure that supports add-ins in Office running in the browser, and the relevant components (the web client, **iframe**, Office Add-ins runtime, and JavaScript API for Office) that are required to support them.</span></span>


<span data-ttu-id="56d1b-137">*Figura 3. Infraestrutura que dá suporte aos Suplementos do Office nos clientes Web do Office*</span><span class="sxs-lookup"><span data-stu-id="56d1b-137">*Figure 3. Infrastructure that supports Office Add-ins in Office web clients*</span></span>

![Infraestrutura do cliente Web](../images/dk2-agave-overview-03.png)

## <a name="add-in-integrity-in-appsource"></a><span data-ttu-id="56d1b-139">Integridade do suplemento no AppSource</span><span class="sxs-lookup"><span data-stu-id="56d1b-139">Add-in integrity in AppSource</span></span>

<span data-ttu-id="56d1b-140">Você pode disponibilizar seus suplementos do Office para o público publicando-os no AppSource.</span><span class="sxs-lookup"><span data-stu-id="56d1b-140">You can make your Office Add-ins available to the public by publishing them to AppSource.</span></span> <span data-ttu-id="56d1b-141">O AppSource impõe as seguintes medidas para manter a integridade dos suplementos.</span><span class="sxs-lookup"><span data-stu-id="56d1b-141">AppSource enforces the following measures to maintain the integrity of add-ins.</span></span>

- <span data-ttu-id="56d1b-142">Requer que o servidor host de um Suplemento do Office sempre use o protocolo SSL para se comunicar.</span><span class="sxs-lookup"><span data-stu-id="56d1b-142">Requires the host server of an Office Add-in to always use Secure Sockets Layer (SSL) to communicate.</span></span>

- <span data-ttu-id="56d1b-143">Requer que um desenvolvedor forneça uma prova de identidade, um acordo contratual e uma política de privacidade compatível para enviar suplementos.</span><span class="sxs-lookup"><span data-stu-id="56d1b-143">Requires a developer to provide proof of identity, a contractual agreement, and a compliant privacy policy to submit add-ins.</span></span>

- <span data-ttu-id="56d1b-144">Garante que a origem dos suplementos seja acessível no modo somente leitura.</span><span class="sxs-lookup"><span data-stu-id="56d1b-144">Ensures that the source of add-ins is accessible in read-only mode.</span></span>

- <span data-ttu-id="56d1b-145">Dá suporte a um sistema de revisão pelo usuário para os suplementos disponíveis para promover uma comunidade autovigilante.</span><span class="sxs-lookup"><span data-stu-id="56d1b-145">Supports a user-review system for available add-ins to promote a self-policing community.</span></span>

## <a name="optional-connected-experiences"></a><span data-ttu-id="56d1b-146">Experiências conectadas opcionais</span><span class="sxs-lookup"><span data-stu-id="56d1b-146">Optional connected experiences</span></span>

<span data-ttu-id="56d1b-147">Usuários finais e administradores de ti podem desativar [experiências conectadas opcionais em](/deployoffice/privacy/optional-connected-experiences) clientes móveis e de área de trabalho do Office.</span><span class="sxs-lookup"><span data-stu-id="56d1b-147">End users and IT admins can turn off [optional connected experiences in Office](/deployoffice/privacy/optional-connected-experiences) desktop and mobile clients.</span></span> <span data-ttu-id="56d1b-148">Para suplementos do Office, o impacto da desativação da configuração de **experiências opcional conectada** é que os usuários não podem mais acessar suplementos ou a Office Store por meio desses clientes.</span><span class="sxs-lookup"><span data-stu-id="56d1b-148">For Office Add-ins, the impact of disabling the **Optional connected experiences** setting is that users can no longer access add-ins or the Office Store through these clients.</span></span> <span data-ttu-id="56d1b-149">No entanto, determinados suplementos da Microsoft considerados essenciais ou críticos para os negócios, e suplementos implantados pelo administrador de ti da organização por meio da [implantação centralizada](../publish/centralized-deployment.md) ainda estarão disponíveis.</span><span class="sxs-lookup"><span data-stu-id="56d1b-149">However, certain Microsoft add-ins that are considered essential or business-critical, and add-ins deployed by an organization's IT admin through [Centralized Deployment](../publish/centralized-deployment.md) will still be available.</span></span> <span data-ttu-id="56d1b-150">Além disso, os suplementos e a loja permanecem disponíveis no Outlook na Web, independentemente do status da configuração.</span><span class="sxs-lookup"><span data-stu-id="56d1b-150">Additionally, add-ins and the Store remain available in Outlook on the web, regardless of the status of the setting.</span></span>

<span data-ttu-id="56d1b-151">Para saber mais sobre o comportamento específico do Outlook, confira [privacidade, permissões e segurança para suplementos do Outlook](../outlook/privacy-and-security.md#optional-connected-experiences).</span><span class="sxs-lookup"><span data-stu-id="56d1b-151">For more about Outlook-specific behavior, see [Privacy, permissions, and security for Outlook add-ins](../outlook/privacy-and-security.md#optional-connected-experiences).</span></span>

<span data-ttu-id="56d1b-152">Observe que, se um administrador de ti desabilitar o [uso de experiências conectadas no Office](/deployoffice/privacy/manage-privacy-controls#policy-setting-for-most-connected-experiences), ele terá o mesmo efeito em suplementos que desativam apenas experiências opcionais conectadas.</span><span class="sxs-lookup"><span data-stu-id="56d1b-152">Note that if an IT admin disables the [use of connected experiences in Office](/deployoffice/privacy/manage-privacy-controls#policy-setting-for-most-connected-experiences), it has the same effect on add-ins as turning off just optional connected experiences.</span></span>

## <a name="addressing-end-users-privacy-concerns"></a><span data-ttu-id="56d1b-153">Lidar com as preocupações de privacidade dos usuários finais</span><span class="sxs-lookup"><span data-stu-id="56d1b-153">Addressing end users' privacy concerns</span></span>

<span data-ttu-id="56d1b-154">Esta seção descreve a proteção oferecida pela plataforma de Suplementos do Office da perspectiva do cliente (usuário final) e fornece as diretrizes sobre como dar suporte às expectativas dos usuários e como manipular com segurança as PII (informações de identificação pessoal) dos usuários.</span><span class="sxs-lookup"><span data-stu-id="56d1b-154">This section describes the protection offered by the Office Add-ins platform from the customer's (end user's) perspective, and provides guidelines for how to support users' expectations and how to securely handle users' personally identifiable information (PII).</span></span>

### <a name="end-users-perspective"></a><span data-ttu-id="56d1b-155">Perspectiva dos usuários finais</span><span class="sxs-lookup"><span data-stu-id="56d1b-155">End users' perspective</span></span>

<span data-ttu-id="56d1b-p107">Os Suplementos do Office são criados usando tecnologias da Web que são executadas em um controle de navegador ou **iframe**. Por causa disso, o uso de suplementos é semelhante à navegação em sites da Web na Internet ou intranet. Os suplementos podem ser externos a uma organização (se você adquirir o suplemento do AppSource) ou internos (se você adquirir o suplemento de um catálogo de suplementos do Exchange Server, catálogo de aplicativos do SharePoint ou compartilhamento de arquivos na rede de uma organização). Os suplementos têm acesso limitado à rede, e a maioria dos suplementos pode ler ou gravar no documento ativo ou no item de email. A plataforma de suplemento aplica certas restrições antes de um usuário ou administrador instalar ou iniciar um suplemento. Mas, como acontece com qualquer modelo de extensibilidade, os usuários devem ser cautelosos antes de iniciar um complemento desconhecido.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p107">Office Add-ins are built using web technologies that run in a browser control or **iframe**. Because of this, using add-ins is similar to browsing to web sites on the Internet or intranet. Add-ins can be external to an organization (if you acquire the add-in from AppSource) or internal (if you acquire the add-in from an Exchange Server add-in catalog, SharePoint app catalog, or file share on an organization's network). Add-ins have limited access to the network and most add-ins can read or write to the active document or mail item. The add-in platform applies certain constraints before a user or administrator installs or starts an add-in. But as with any extensibility model, users should be cautious before starting an unknown add-in.</span></span>

<span data-ttu-id="56d1b-162">A plataforma de suplemento aborda as preocupações de privacidade dos usuários finais das seguintes maneiras.</span><span class="sxs-lookup"><span data-stu-id="56d1b-162">The add-in platform addresses end users' privacy concerns in the following ways.</span></span>

- <span data-ttu-id="56d1b-163">Os dados comunicados com o servidor Web que hospeda um suplemento de conteúdo, do Outlook ou de painel de tarefas, bem como a comunicação entre o suplemento e quaisquer serviços Web que ele usa, devem ser criptografados usando o protocolo SSL.</span><span class="sxs-lookup"><span data-stu-id="56d1b-163">Data communicated with the web server that hosts a content, Outlook or task pane add-in as well as communication between the add-in and any web services it uses must be encrypted using the Secure Socket Layer (SSL) protocol.</span></span>

- <span data-ttu-id="56d1b-p108">Antes de instalar um suplemento do AppSource, o usuário pode exibir a política de privacidade e os requisitos desse suplemento. Além disso, os suplementos do Outlook que interagem com caixas de correio dos usuários expõem as permissões específicas das quais precisam. O usuário pode examinar os termos de uso, as permissões solicitadas e a política de privacidade antes de instalar um suplemento do Outlook.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p108">Before a user installs an add-in from AppSource, the user can view the privacy policy and requirements of that add-in. In addition, Outlook add-ins that interact with users' mailboxes surface the specific permissions that they require; the user can review the terms of use, requested permissions and privacy policy before installing an Outlook add-in.</span></span>

- <span data-ttu-id="56d1b-166">Ao compartilhar um documento, os usuários também compartilham suplementos que foram inseridos no documento ou associados a ele.</span><span class="sxs-lookup"><span data-stu-id="56d1b-166">When sharing a document, users also share add-ins that have been inserted in or associated with that document.</span></span> <span data-ttu-id="56d1b-167">Se um usuário abrir um documento que contenha um suplemento que o usuário não tenha usado anteriormente, o aplicativo cliente do Office solicitará que o usuário Conceda permissão para que o suplemento seja executado no documento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-167">If a user opens a document that contains an add-in that the user hasn't used before, the Office client application prompts the user to grant permission for the add-in to run in the document.</span></span> <span data-ttu-id="56d1b-168">Em um ambiente organizacional, o aplicativo cliente do Office também solicita o usuário se o documento vier de uma fonte externa.</span><span class="sxs-lookup"><span data-stu-id="56d1b-168">In an organizational environment, the Office client application also prompts the user if the document comes from an external source.</span></span>

- <span data-ttu-id="56d1b-169">Os usuários podem habilitar ou desabilitar o acesso ao AppSource.</span><span class="sxs-lookup"><span data-stu-id="56d1b-169">Users can enable or disable the access to AppSource.</span></span> <span data-ttu-id="56d1b-170">Para suplementos de conteúdo e de painel de tarefas, os usuários gerenciam o acesso a suplementos e catálogos confiáveis da **central de confiabilidade** no cliente do Office do host (aberto nas opções de **arquivo**configurações da central de confiabilidade da central de confiabilidade dos  >  **Options**  >  **Trust Center**  >  **Trust Center Settings**  >  **catálogos de suplementos confiáveis**).</span><span class="sxs-lookup"><span data-stu-id="56d1b-170">For content and task pane add-ins, users manage access to trusted add-ins and catalogs from the **Trust Center** on the host Office client (opened from **File** > **Options** > **Trust Center** > **Trust Center Settings** > **Trusted Add-in Catalogs**).</span></span> <span data-ttu-id="56d1b-171">Para os suplementos do Outlook, os usos podem gerenciar suplementos escolhendo o botão **gerenciar suplementos** : no Outlook no Windows, escolha **arquivo**  >  **gerenciar suplementos**. No Outlook no Mac, escolha o botão **gerenciar suplementos** na barra de suplementos.</span><span class="sxs-lookup"><span data-stu-id="56d1b-171">For Outlook add-ins, uses can manage add-ins by choosing the **Manage Add-ins** button: in Outlook on Windows, choose **File** > **Manage Add-ins**. In Outlook on Mac, choose the **Manage Add-ins** button on the add-in bar.</span></span> <span data-ttu-id="56d1b-172">No Outlook na Web, escolha o menu **Configurações** (ícone de engrenagem) > **Gerenciar suplementos**. Os administradores também podem gerenciar este acesso [usando a política de grupo](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office).</span><span class="sxs-lookup"><span data-stu-id="56d1b-172">In Outlook on the web, choose the **Settings** menu (gear icon) > **Manage add-ins**. Administrators can also manage this access [by using group policy](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office).</span></span>

- <span data-ttu-id="56d1b-173">O design da plataforma de suplementos fornece segurança e desempenho aos usuários finais das seguintes maneiras.</span><span class="sxs-lookup"><span data-stu-id="56d1b-173">The design of the add-in platform provides security and performance for end users in the following ways.</span></span>

  - <span data-ttu-id="56d1b-174">Um suplemento do Office é executado em um controle de navegador da Web hospedado em um ambiente de tempo de execução do suplemento separado do aplicativo cliente do Office.</span><span class="sxs-lookup"><span data-stu-id="56d1b-174">An Office Add-in runs in a web browser control that is hosted in an add-in runtime environment separate from the Office client application.</span></span> <span data-ttu-id="56d1b-175">Esse design oferece isolamento de segurança e desempenho do aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="56d1b-175">This design provides both security and performance isolation from the client application.</span></span>

  - <span data-ttu-id="56d1b-176">A execução em um controle de navegador da Web permite que o suplemento faça quase tudo que uma página da Web regular em execução em um navegador pode fazer, mas, ao mesmo tempo, restringe o suplemento a observar a política de mesma origem para o isolamento de domínio e as zonas segurança.</span><span class="sxs-lookup"><span data-stu-id="56d1b-176">Running in a web browser control allows the add-in to do almost anything a regular web page running in a browser can do but, at the same time, restricts the add-in to observe the same-origin policy for domain isolation and security zones.</span></span>

<span data-ttu-id="56d1b-p112">Os suplementos do Outlook fornecem recursos adicionais de segurança e desempenho por meio do monitoramento de uso de recursos específicos do suplemento do Outlook. Para saber mais, consulte [Privacidade, permissões e segurança de suplementos do Outlook](../outlook/privacy-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="56d1b-p112">Outlook add-ins provide additional security and performance features through Outlook add-in specific resource usage monitoring. For more information, see [Privacy, permissions, and security for Outlook add-ins](../outlook/privacy-and-security.md).</span></span>

### <a name="developer-guidelines-to-handle-pii"></a><span data-ttu-id="56d1b-179">Diretrizes de desenvolvedor para lidar com PII</span><span class="sxs-lookup"><span data-stu-id="56d1b-179">Developer guidelines to handle PII</span></span>

<span data-ttu-id="56d1b-180">A seguir, lista algumas diretrizes de proteção de PII específicas para você como desenvolvedor de suplementos do Office.</span><span class="sxs-lookup"><span data-stu-id="56d1b-180">The following lists some specific PII protection guidelines for you as a developer of Office Add-ins.</span></span>

- <span data-ttu-id="56d1b-p113">O objeto [Settings](/javascript/api/office/office.settings) destina-se a persistir configurações e dados de estado de suplementos entre sessões para um suplemento de conteúdo ou de painel de tarefas, mas não armazena senhas e outros itens de PII confidenciais no objeto **Settings**. Os dados no objeto **Settings** não ficam visíveis para os usuários finais, mas são armazenados como parte do formato de arquivo do documento, que está prontamente acessível. Você deve limitar o uso de PII pelo suplemento e armazenar quaisquer itens de PII necessários ao suplemento no servidor que hospeda o suplemento como um recurso protegido pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p113">The [Settings](/javascript/api/office/office.settings) object is intended for persisting add-in settings and state data across sessions for a content or task pane add-in, but don't store passwords and other sensitive PII in the **Settings** object. The data in the **Settings** object isn't visible to end users, but it is stored as part of the document's file format which is readily accessible. You should limit your add-in's use of PII and store any PII required by your add-in on the server hosting your add-in as a user-secured resource.</span></span>

- <span data-ttu-id="56d1b-p114">O uso de alguns aplicativos pode revelar itens de PII. Armazene com segurança os dados de identidade, local, horas de acesso e outras credenciais dos usuários para que os dados não sejam disponibilizados para outros usuários do suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p114">Using some applications can reveal PII. Make sure that you securely store data for your users' identity, location, access times, and any other credentials so that data won't become available to other users of the add-in.</span></span>

- <span data-ttu-id="56d1b-p115">Se o suplemento estiver disponível no AppSource, o requisito do AppSource por HTTPS protegerá os itens de PII transmitidos entre o servidor Web e o dispositivo ou computador cliente. No entanto, se você retransmitir esses dados para outros servidores, observe o mesmo nível de proteção.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p115">If your add-in is available in AppSource, the AppSource requirement for HTTPS protects PII transmitted between your web server and the client computer or device. However, if you re-transmit that data to other servers, make sure you observe the same level of protection.</span></span>

- <span data-ttu-id="56d1b-p116">Se você armazenar itens de PII dos usuários, revele esse fato e forneça uma maneira para que os usuários os inspecionem e excluam. Se você enviar o suplemento ao AppSource, poderá indicar na política de privacidade os dados que coleta e como eles são usados.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p116">If you store users' PII, make sure you reveal that fact, and provide a way for users to inspect and delete it. If you submit your add-in to AppSource, you can outline the data you collect and how it's used in the privacy statement.</span></span>

## <a name="developers-permission-choices-and-security-practices"></a><span data-ttu-id="56d1b-190">Opções de permissão e práticas de segurança de desenvolvedores</span><span class="sxs-lookup"><span data-stu-id="56d1b-190">Developers' permission choices and security practices</span></span>

<span data-ttu-id="56d1b-191">Siga estas diretrizes gerais para dar suporte ao modelo de segurança de Suplementos do Office e analisar detalhadamente cada tipo de suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-191">Follow these general guidelines to support the security model of Office Add-ins, and drill down on more details for each add-in type.</span></span>

### <a name="permissions-choices"></a><span data-ttu-id="56d1b-192">Opções de permissões</span><span class="sxs-lookup"><span data-stu-id="56d1b-192">Permissions choices</span></span>

<span data-ttu-id="56d1b-193">A plataforma de suplementos fornece um modelo de permissões que o suplemento usa para declarar o nível de acesso aos dados de um usuário de que necessita para seus recursos.</span><span class="sxs-lookup"><span data-stu-id="56d1b-193">The add-in platform provides a permissions model that your add-in uses to declare the level of access to a user's data that it requires for its features.</span></span> <span data-ttu-id="56d1b-194">Cada nível de permissão corresponde ao subconjunto da API JavaScript para Office que o suplemento tem permissão para usar para seus recursos.</span><span class="sxs-lookup"><span data-stu-id="56d1b-194">Each permission level corresponds to the subset of the JavaScript API for Office your add-in is allowed to use for its features.</span></span> <span data-ttu-id="56d1b-195">Por exemplo, a permissão **WriteDocument** para suplementos de painel de tarefas e de conteúdo permite o acesso ao método [Document. setSelectedDataAsync](/javascript/api/office/office.document) que permite que um suplemento grave no documento do usuário, mas não permite o acesso a qualquer um dos métodos de leitura de dados do documento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-195">For example, the **WriteDocument** permission for content and task pane add-ins allows access to the [Document.setSelectedDataAsync](/javascript/api/office/office.document) method that lets an add-in write to the user's document, but doesn't allow access to any of the methods for reading data from the document.</span></span> <span data-ttu-id="56d1b-196">Esse nível de permissão faz sentido para suplementos que só precisam gravar em um documento, como um suplemento em que o usuário pode consultar dados para inserir em seu documento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-196">This permission level makes sense for add-ins that only need to write to a document, such as an add-in where the user can query for data to insert into their document.</span></span>

<span data-ttu-id="56d1b-p118">Como prática recomendada, você deve solicitar permissões com base no princípio de _menor privilégio_. Ou seja, você deve solicitar permissão para acessar apenas o subconjunto mínimo da API que o suplemento requer para funcionar corretamente. Por exemplo, se o suplemento precisa apenas ler dados no documento de um usuário para seus recursos, você não deve solicitar mais do que a permissão **ReadDocument**. (Porém, lembre-se de que a solicitação de permissões insuficientes fará com que a plataforma de suplementos bloqueie o uso de algumas APIs pelo suplemento e gerará erros em tempo de execução.)</span><span class="sxs-lookup"><span data-stu-id="56d1b-p118">As a best practice, you should request permissions based on the principle of  _least privilege_. That is, you should request permission to access only the minimum subset of the API that your add-in requires to function correctly. For example, if your add-in needs only to read data in a user's document for its features, you should request no more than the **ReadDocument** permission. (But, keep in mind that requesting insufficient permissions will result in the add-in platform blocking your add-in's use of some APIs and will generate errors at run time.)</span></span>

<span data-ttu-id="56d1b-201">Você especifica permissões no manifesto do suplemento, conforme mostrado no exemplo abaixo nesta seção, e os usuários finais podem ver o nível de permissão solicitado de um suplemento antes de decidirem instalar ou ativar o suplemento pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="56d1b-201">You specify permissions in the manifest of your add-in, as shown in the example in this section below, and end users can see the requested permission level of an add-in before they decide to install or activate the add-in for the first time.</span></span> <span data-ttu-id="56d1b-202">Além disso, os suplementos do Outlook que solicitam a permissão **ReadWriteMailbox** exigem privilégio de administrador explícito para instalar o.</span><span class="sxs-lookup"><span data-stu-id="56d1b-202">Additionally, Outlook add-ins that request the **ReadWriteMailbox** permission require explicit administrator privilege to install.</span></span>

<span data-ttu-id="56d1b-203">O exemplo a seguir mostra como um suplemento de painel de tarefas especifica a permissão **ReadDocument** em seu manifesto.</span><span class="sxs-lookup"><span data-stu-id="56d1b-203">The following example shows how a task pane add-in specifies the **ReadDocument** permission in its manifest.</span></span> <span data-ttu-id="56d1b-204">Para manter as permissões em destaque, outros elementos no manifesto não são exibidos.</span><span class="sxs-lookup"><span data-stu-id="56d1b-204">To keep permissions as the focus, other elements in the manifest aren't displayed.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
           xmlns:ver="http://schemas.microsoft.com/office/appforoffice/1.0"
           xsi:type="TaskPaneApp">

... <!-- To keep permissions as the focus, not displaying other elements. -->
  <Permissions>ReadDocument</Permissions>
...
</OfficeApp>
```

<span data-ttu-id="56d1b-205">Para saber mais sobre permissões para suplementos de painel de tarefas e de conteúdo, consulte [Solicitar permissões para uso da API em suplementos ](../develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="56d1b-205">For more information about permissions for task pane and content add-ins, see [Requesting permissions for API use in add-ins](../develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span></span>

<span data-ttu-id="56d1b-206">Para obter mais informações sobre permissões para suplementos do Outlook, consulte os tópicos a seguir.</span><span class="sxs-lookup"><span data-stu-id="56d1b-206">For more information about permissions for Outlook add-ins, see the following topics.</span></span>

- [<span data-ttu-id="56d1b-207">Privacidade, permissões e segurança de suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="56d1b-207">Privacy, permissions, and security for Outlook add-ins</span></span>](../outlook/privacy-and-security.md)

- [<span data-ttu-id="56d1b-208">Noções básicas sobre permissões de suplemento do Outlook</span><span class="sxs-lookup"><span data-stu-id="56d1b-208">Understanding Outlook add-in permissions</span></span>](../outlook/understanding-outlook-add-in-permissions.md)

### <a name="same-origin-policy"></a><span data-ttu-id="56d1b-209">Política de mesma origem</span><span class="sxs-lookup"><span data-stu-id="56d1b-209">Same origin policy</span></span>

<span data-ttu-id="56d1b-210">Como os suplementos do Office são páginas da Web que são executadas em um controle de navegador da Web, eles devem seguir a política de mesma origem imposta pelo navegador.</span><span class="sxs-lookup"><span data-stu-id="56d1b-210">Because Office Add-ins are webpages that run in a web browser control, they must follow the same-origin policy enforced by the browser.</span></span> <span data-ttu-id="56d1b-211">Por padrão, uma página da Web em um domínio não pode fazer chamadas de serviço Web [XMLHttpRequest](https://www.w3.org/TR/XMLHttpRequest/) para outro domínio que não seja aquele em que está hospedado.</span><span class="sxs-lookup"><span data-stu-id="56d1b-211">By default, a webpage in one domain can't make [XmlHttpRequest](https://www.w3.org/TR/XMLHttpRequest/) web service calls to another domain other than the one where it is hosted.</span></span>

<span data-ttu-id="56d1b-212">Uma maneira de superar essa limitação é usar JSON/P--fornecer um proxy para o serviço Web, incluindo uma marca de **script** com um atributo **src** que aponta para um script hospedado em outro domínio.</span><span class="sxs-lookup"><span data-stu-id="56d1b-212">One way to overcome this limitation is to use JSON/P -- provide a proxy for the web service by including a **script** tag with a **src** attribute that points to some script hosted on another domain.</span></span> <span data-ttu-id="56d1b-213">Você pode criar as marcas**script** via programação gerando de forma dinâmica a URL para a qual apontar o atributo **src** e passando parâmetros à URL por meio de parâmetros da consulta de URI.</span><span class="sxs-lookup"><span data-stu-id="56d1b-213">You can programmatically create the **script** tags, dynamically creating the URL to which to point the **src** attribute, and passing parameters to the URL via URI query parameters.</span></span> <span data-ttu-id="56d1b-214">Os provedores de serviços Web criam e hospedam o código JavaScript em URLs específicas e retornam scripts diferentes, dependendo dos parâmetros de consulta de URI.</span><span class="sxs-lookup"><span data-stu-id="56d1b-214">Web service providers create and host JavaScript code at specific URLs, and return different scripts depending on the URI query parameters.</span></span> <span data-ttu-id="56d1b-215">Em seguida, esses scripts serão executados onde estiverem inseridos e funcionarão como esperado.</span><span class="sxs-lookup"><span data-stu-id="56d1b-215">These scripts then execute where they are inserted and work as expected.</span></span>

<span data-ttu-id="56d1b-216">A seguir há um exemplo de JSON/P no exemplo de suplemento do Outlook.</span><span class="sxs-lookup"><span data-stu-id="56d1b-216">The following is an example of JSON/P in the Outlook add-in example.</span></span> 

```js
// Dynamically create an HTML SCRIPT element that obtains the details for the specified video.
function loadVideoDetails(videoIndex) {
    // Dynamically create a new HTML SCRIPT element in the webpage.
    var script = document.createElement("script");
    // Specify the URL to retrieve the indicated video from a feed of a current list of videos,
    // as the value of the src attribute of the SCRIPT element. 
    script.setAttribute("src", "https://gdata.youtube.com/feeds/api/videos/" + 
        videos[videoIndex].Id + "?alt=json-in-script&amp;callback=videoDetailsLoaded");
    // Insert the SCRIPT element at the end of the HEAD section.
    document.getElementsByTagName('head')[0].appendChild(script);
}
```

<span data-ttu-id="56d1b-p123">O Exchange e o SharePoint fornecem proxies do lado do cliente para habilitar o acesso de domínio cruzado. Em geral, a política de mesma origem em uma intranet não é tão estrita como na Internet. Para saber mais, confira [Política de mesma origem, parte 1: sem exibição](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking) e [Como lidar com limitações de política de mesma origem nos Suplementos do Office](../develop/addressing-same-origin-policy-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="56d1b-p123">Exchange and SharePoint provide client-side proxies to enable cross-domain access. In general, same origin policy on an intranet isn't as strict as on the Internet. For more information, see [Same Origin Policy Part 1: No Peeking](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking) and [Addressing same-origin policy limitations in Office Add-ins](../develop/addressing-same-origin-policy-limitations.md).</span></span>

### <a name="tips-to-prevent-malicious-cross-site-scripting"></a><span data-ttu-id="56d1b-220">Dicas para evitar scripts mal-intencionados entre sites</span><span class="sxs-lookup"><span data-stu-id="56d1b-220">Tips to prevent malicious cross-site scripting</span></span>

<span data-ttu-id="56d1b-221">Um usuário mal-intencionado pode atacar a origem de um suplemento inserindo um script mal-intencionado por meio do documento ou de campos no suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-221">An ill-intentioned user could attack the origin of an add-in by entering malicious script through the document or fields in the add-in.</span></span> <span data-ttu-id="56d1b-222">Um desenvolvedor deve processar a entrada do usuário para evitar a execução de JavaScript de um usuário mal-intencionado em seu domínio.</span><span class="sxs-lookup"><span data-stu-id="56d1b-222">A developer should process user input to avoid executing a malicious user's JavaScript within their domain.</span></span> <span data-ttu-id="56d1b-223">Veja a seguir algumas práticas recomendadas a serem seguidas para lidar com a entrada do usuário a partir de um documento ou de uma mensagem de email ou por meio de campos em um suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-223">The following are some good practices to follow to handle user input from a document or mail message, or via fields in an add-in.</span></span>


- <span data-ttu-id="56d1b-224">Em vez da propriedade DOM [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML), use as propriedades [innerText](https://developer.mozilla.org/docs/Web/API/Node/innerText) e [textContent](https://developer.mozilla.org/docs/DOM/Node.textContent) quando apropriado.</span><span class="sxs-lookup"><span data-stu-id="56d1b-224">Instead of the DOM property [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML), use the [innerText](https://developer.mozilla.org/docs/Web/API/Node/innerText) and [textContent](https://developer.mozilla.org/docs/DOM/Node.textContent) properties where appropriate.</span></span> <span data-ttu-id="56d1b-225">Siga este procedimento para obter suporte para o Internet Explorer e o Firefox entre navegadores.</span><span class="sxs-lookup"><span data-stu-id="56d1b-225">Do the following for Internet Explorer and Firefox cross-browser support.</span></span>

    ```js
     var text = x.innerText || x.textContent
    ```

    <span data-ttu-id="56d1b-226">Para obter informações sobre as diferenças entre **InnerText** e **textcontent**, consulte [node. textcontent](https://developer.mozilla.org/docs/DOM/Node.textContent).</span><span class="sxs-lookup"><span data-stu-id="56d1b-226">For information about the differences between **innerText** and **textContent**, see [Node.textContent](https://developer.mozilla.org/docs/DOM/Node.textContent).</span></span> <span data-ttu-id="56d1b-227">Para saber mais sobre a compatibilidade de DOM entre navegadores comuns, consulte [Compatibilidade de DOM W3C ‒ HTML](https://www.quirksmode.org/dom/w3c_html.html#t07).</span><span class="sxs-lookup"><span data-stu-id="56d1b-227">For more information about DOM compatibility across common browsers, see [W3C DOM Compatibility - HTML](https://www.quirksmode.org/dom/w3c_html.html#t07).</span></span>

- <span data-ttu-id="56d1b-228">Se você precisar usar **InnerHtml**, certifique-se de que a entrada do usuário não contenha conteúdo mal-intencionado antes de passá-la para **InnerHtml**.</span><span class="sxs-lookup"><span data-stu-id="56d1b-228">If you must use **innerHTML**, make sure the user's input doesn't contain malicious content before passing it to **innerHTML**.</span></span> <span data-ttu-id="56d1b-229">Para obter mais informações e um exemplo de como usar o **InnerHtml** com segurança, consulte Propriedade [InnerHtml](https://developer.mozilla.org/docs/Web/API/Element/innerHTML) .</span><span class="sxs-lookup"><span data-stu-id="56d1b-229">For more information and an example of how to use **innerHTML** safely, see [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML) property.</span></span>

- <span data-ttu-id="56d1b-230">Se estiver usando jQuery, use o método [.text()](https://api.jquery.com/text/) em vez do método [.html()](https://api.jquery.com/html/).</span><span class="sxs-lookup"><span data-stu-id="56d1b-230">If you are using jQuery, use the [.text()](https://api.jquery.com/text/) method instead of the [.html()](https://api.jquery.com/html/) method.</span></span>

- <span data-ttu-id="56d1b-231">Use o método [toStaticHTML](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference) para remover atributos e elementos HTML dinâmicos da entrada dos usuários antes de passá-la para **innerHTML**.</span><span class="sxs-lookup"><span data-stu-id="56d1b-231">Use the [toStaticHTML](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference) method to remove any dynamic HTML elements and attributes in users' input before passing it to **innerHTML**.</span></span>

- <span data-ttu-id="56d1b-232">Use a função [encodeURIComponent](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuricomponent) ou [encodeURI](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuri) para codificar texto que se destina a ser uma URL que vem da entrada do usuário ou a contém.</span><span class="sxs-lookup"><span data-stu-id="56d1b-232">Use the [encodeURIComponent](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuricomponent) or [encodeURI](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuri) function to encode text that is intended to be a URL that comes from or contains user input.</span></span>

- <span data-ttu-id="56d1b-233">Consulte [Desenvolver suplementos seguros](/previous-versions/windows/apps/hh849625(v=win.10)) para obter mais práticas recomendadas para criar soluções Web mais seguras.</span><span class="sxs-lookup"><span data-stu-id="56d1b-233">See [Developing secure add-ins](/previous-versions/windows/apps/hh849625(v=win.10)) for more best practices to create more secure web solutions.</span></span>

### <a name="tips-to-prevent-clickjacking"></a><span data-ttu-id="56d1b-234">Dicas para impedir "clickjacking"</span><span class="sxs-lookup"><span data-stu-id="56d1b-234">Tips to prevent "Clickjacking"</span></span>

<span data-ttu-id="56d1b-235">Como os suplementos do Office são renderizados em um iframe ao executar em um navegador com aplicativos cliente do Office, use as seguintes dicas para minimizar o risco de [clickjacking](https://en.wikipedia.org/wiki/Clickjacking) --uma técnica usada por hackers para enganar os usuários na revelação de informações confidenciais.</span><span class="sxs-lookup"><span data-stu-id="56d1b-235">Because Office Add-ins are rendered in an iframe when running in a browser with Office client applications, use the following tips to minimize the risk of [clickjacking](https://en.wikipedia.org/wiki/Clickjacking) -- a technique used by hackers to fool users into revealing confidential information.</span></span>

<span data-ttu-id="56d1b-p128">Em primeiro lugar, identifique ações confidenciais que o suplemento pode executar. Elas incluem ações que um usuário não autorizado pode usar de forma mal-intencionada, como iniciar uma transação financeira ou publicar dados confidenciais. Por exemplo, o suplemento pode permitir que o usuário envie um pagamento a um destinatário definido pelo usuário.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p128">First, identify sensitive actions that your add-in can perform. These include any actions that an unauthorized user could use with malicious intent, such as initiating a financial transaction or publishing sensitive data. For example, your add-in might let the user send a payment to a user-defined recipient.</span></span>

<span data-ttu-id="56d1b-p129">Segundo, para ações confidenciais, o suplemento deve confirmar com o usuário antes de executar a ação. A confirmação deve detalhar o efeito que a ação terá. Também deve detalhar como o usuário pode impedir a ação, se necessário, escolhendo um botão específico marcado como "Não Permitir" ou ignorando a confirmação.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p129">Second, for sensitive actions, your add-in should confirm with the user before it executes the action. This confirmation should detail what effect the action will have. It should also detail how the user can prevent the action, if necessary, whether by choosing a specific button marked "Don't Allow" or by ignoring the confirmation.</span></span>

<span data-ttu-id="56d1b-242">Terceiro, para garantir que nenhum possível hacker possa ocultar ou mascarar a confirmação, você deve exibi-la fora do contexto do suplemento (ou seja, não em uma caixa de diálogo HTML).</span><span class="sxs-lookup"><span data-stu-id="56d1b-242">Third, to ensure that no potential attacker can hide or mask the confirmation, you should display it outside the context of the add-in (that is, not in an HTML dialog box).</span></span>

<span data-ttu-id="56d1b-243">Veja a seguir alguns exemplos de como você pode obter a confirmação.</span><span class="sxs-lookup"><span data-stu-id="56d1b-243">The following are some examples of how you could get confirmation.</span></span>

- <span data-ttu-id="56d1b-244">Envie um e-mail ao usuário com um link de confirmação.</span><span class="sxs-lookup"><span data-stu-id="56d1b-244">Send an email to the user that contains a confirmation link.</span></span>

- <span data-ttu-id="56d1b-245">Envie uma mensagem de texto ao usuário com um código de confirmação para ele inserir no suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-245">Send a text message to the user that includes a confirmation code that the user can enter in the add-in.</span></span>

- <span data-ttu-id="56d1b-p130">Abra um diálogo de confirmação em uma nova janela do navegador para uma página que não possa ser exibida em iframe. Geralmente, esse é o padrão usado por páginas de login. Use a [API de diálogo](../develop/dialog-api-in-office-add-ins.md) para criar um novo diálogo.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p130">Open a confirmation dialog in a new browser window to a page that cannot be iframed. This is typically the pattern that is used by login pages. Use the [dialog api](../develop/dialog-api-in-office-add-ins.md) to create a new dialog.</span></span>

<span data-ttu-id="56d1b-p131">Verifique também se o endereço usado para entrar em contato com o usuário não pode ter sido fornecido por um possível hacker. Por exemplo, para confirmações de pagamento, use o endereço arquivado na conta autorizada do usuário.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p131">Also, ensure that the address you use for contacting the user couldn't have been provided by a potential attacker. For example, for payment confirmations use the address on file for the authorized user's account.</span></span>

### <a name="other-security-practices"></a><span data-ttu-id="56d1b-251">Outras práticas de segurança</span><span class="sxs-lookup"><span data-stu-id="56d1b-251">Other security practices</span></span>

<span data-ttu-id="56d1b-252">Os desenvolvedores também devem anotar as práticas de segurança a seguir.</span><span class="sxs-lookup"><span data-stu-id="56d1b-252">Developers should also take note of the following security practices.</span></span>

- <span data-ttu-id="56d1b-253">Os desenvolvedores não devem usar controles ActiveX em Suplementos do Office, pois os controles ActiveX não dão suporte à natureza de plataforma cruzada da plataforma de suplementos.</span><span class="sxs-lookup"><span data-stu-id="56d1b-253">Developers shouldn't use ActiveX controls in Office Add-ins as ActiveX controls don't support the cross-platform nature of the add-in platform.</span></span>

- <span data-ttu-id="56d1b-p132">Os suplementos de conteúdo e de painel de tarefas assumem o uso das mesmas configurações de SSL que o navegador usa por padrão e permitem que a maioria do conteúdo seja fornecido apenas por SSL. Os suplementos do Outlook exigem que todo o conteúdo seja fornecido por SSL. Os desenvolvedores devem especificar no elemento **SourceLocation** do manifesto do suplemento uma URL que use HTTPS, para identificar o local do arquivo HTML para o suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p132">Content and task pane add-ins assume the same SSL settings that the browser uses by default, and allows most content to be delivered only by SSL. Outlook add-ins require all content to be delivered by SSL. Developers must specify in the **SourceLocation** element of the add-in manifest a URL that uses HTTPS, to identify the location of the HTML file for the add-in.</span></span>

    <span data-ttu-id="56d1b-257">Para certificar-se de que os suplementos não estão fornecendo conteúdo usando HTTP, ao testar suplementos, os desenvolvedores devem se certificar de que as configurações a seguir estão selecionadas em **Opções da Internet** no **painel de controle** e que nenhum aviso de segurança aparece em seus cenários de teste.</span><span class="sxs-lookup"><span data-stu-id="56d1b-257">To make sure add-ins aren't delivering content by using HTTP, when testing add-ins, developers should make sure the following settings are selected in **Internet Options** in **Control Panel** and no security warnings appear in their test scenarios.</span></span>

    - <span data-ttu-id="56d1b-258">Certifique-se de que a configuração de segurança, **Exibir conteúdo misto**, para a zona da **Internet** esteja definida como **avisar**.</span><span class="sxs-lookup"><span data-stu-id="56d1b-258">Make sure the security setting, **Display mixed content**, for the **Internet** zone is set to **Prompt**.</span></span> <span data-ttu-id="56d1b-259">Você pode fazer isso selecionando o seguinte em **Opções da Internet**: na **guia Segurança** , selecione a zona da **Internet** , selecione **nível personalizado**, rolar para procurar por **Exibir conteúdo misto**e selecione **avisar** se ainda não estiver selecionado.</span><span class="sxs-lookup"><span data-stu-id="56d1b-259">You can do that by selecting the following in **Internet Options**: on the **Security** tab, select the **Internet** zone, select **Custom level**, scroll to look for **Display mixed content**, and select **Prompt** if it isn't already selected.</span></span>

    - <span data-ttu-id="56d1b-260">Verifique se a opção **Avisar ao alterar o modo de segurança** está marcada na guia **Avançado** da caixa de diálogo **Opções da Internet**.</span><span class="sxs-lookup"><span data-stu-id="56d1b-260">Make sure **Warn if Changing between Secure and not secure mode** is selected in the **Advanced** tab of the **Internet Options** dialog box.</span></span>

- <span data-ttu-id="56d1b-p134">Para garantir que os suplementos não usem excessivamente os recursos de memória ou do núcleo da CPU e causem a negação de serviço em um computador cliente, a plataforma de suplementos estabelece limites de uso de recursos. Como parte dos testes, os desenvolvedores devem verificar se o desempenho de um suplemento está dentro dos limites de uso de recursos.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p134">To make sure that add-ins don't use excessive CPU core or memory resources and cause any denial of service on a client computer, the add-in platform establishes resource usage limits. As part of testing, developers should verify whether an add-in performs within the resource usage limits.</span></span>

- <span data-ttu-id="56d1b-263">Antes de publicar um suplemento, os desenvolvedores devem verificar se as informações de identificação pessoal expostas nos arquivos do suplemento estão seguras.</span><span class="sxs-lookup"><span data-stu-id="56d1b-263">Before publishing an add-in, developers should make sure that any personal identifiable information that they expose in their add-in files is secure.</span></span>

- <span data-ttu-id="56d1b-p135">Os desenvolvedores não devem inserir chaves usadas para acessar APIs ou serviços de terceiros (como o Bing, Google ou Facebook) diretamente nas páginas HTML do suplemento. Em vez disso, devem criar um serviço Web personalizado ou armazenar as chaves em alguma outra forma de armazenamento seguro na Web, que podem então chamar para passar o valor de chave ao suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-p135">Developers shouldn't embed keys that they use to access third-party APIs or services (such as Bing, Google, or Facebook) directly in the HTML pages of their add-in. Instead, they should create a custom web service or store the keys in some other form of secure web storage that they can then call to pass the key value to their add-in.</span></span>

- <span data-ttu-id="56d1b-266">Os desenvolvedores devem fazer o seguinte ao enviar um suplemento para o AppSource.</span><span class="sxs-lookup"><span data-stu-id="56d1b-266">Developers should do the following when submitting an add-in to AppSource.</span></span>

  - <span data-ttu-id="56d1b-267">Hospedar o suplemento que estão enviando em um servidor Web que dê suporte a SSL.</span><span class="sxs-lookup"><span data-stu-id="56d1b-267">Host the add-in they are submitting on a web server that supports SSL.</span></span>
  - <span data-ttu-id="56d1b-268">Produzir uma declaração com uma política de privacidade compatível.</span><span class="sxs-lookup"><span data-stu-id="56d1b-268">Produce a statement outlining a compliant privacy policy.</span></span>
  - <span data-ttu-id="56d1b-269">Estar preparados para assinar um acordo contratual ao enviar o suplemento.</span><span class="sxs-lookup"><span data-stu-id="56d1b-269">Be ready to sign a contractual agreement upon submitting the add-in.</span></span>

<span data-ttu-id="56d1b-p136">Além das regras de uso de recursos, os desenvolvedores de suplementos do Outlook também devem verificar se os suplementos estão de acordo com os limites para a especificação de regras de ativação e se usam a API JavaScript. Para saber mais, confira [Limites de ativação e API JavaScript para suplementos do Outlook](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="56d1b-p136">Other than resource usage rules, developers for Outlook add-ins should also make sure their add-ins observe limits for specifying activation rules and using the JavaScript API. For more information, see [Limits for activation and JavaScript API for Outlook add-ins](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md).</span></span>

## <a name="it-administrators-control"></a><span data-ttu-id="56d1b-272">Controle de administradores de TI</span><span class="sxs-lookup"><span data-stu-id="56d1b-272">IT administrators' control</span></span>

<span data-ttu-id="56d1b-273">Em uma configuração corporativa, os administradores de TI têm autoridade final para habilitar ou desabilitar o acesso ao AppSource e a catálogos particulares.</span><span class="sxs-lookup"><span data-stu-id="56d1b-273">In a corporate setting, IT administrators have ultimate authority over enabling or disabling access to AppSource and any private catalogs.</span></span>

<span data-ttu-id="56d1b-274">O gerenciamento e a execução das configurações do Office são feitos com as configurações de política de grupo.</span><span class="sxs-lookup"><span data-stu-id="56d1b-274">The management and enforcement of Office settings is done with group policy settings.</span></span> <span data-ttu-id="56d1b-275">Eles são configuráveis através da [Ferramenta de Implantação do Office](/deployoffice/overview-of-the-office-2016-deployment-tool), em conjunto com a [Ferramenta de Personalização do Office](/deployoffice/overview-of-the-office-customization-tool-for-click-to-run).</span><span class="sxs-lookup"><span data-stu-id="56d1b-275">These are configurable through the [Office Deployment Tool](/deployoffice/overview-of-the-office-2016-deployment-tool), in conjunction with the [Office Customization Tool](/deployoffice/overview-of-the-office-customization-tool-for-click-to-run).</span></span>

| <span data-ttu-id="56d1b-276">Nome da configuração</span><span class="sxs-lookup"><span data-stu-id="56d1b-276">Setting name</span></span> | <span data-ttu-id="56d1b-277">Descrição</span><span class="sxs-lookup"><span data-stu-id="56d1b-277">Description</span></span> |
|--------------|-------------|
| <span data-ttu-id="56d1b-278">Permitir catálogos e suplementos da Web inseguros</span><span class="sxs-lookup"><span data-stu-id="56d1b-278">Allow Unsecure web add-ins and Catalogs</span></span> | <span data-ttu-id="56d1b-279">Permite com que os usuários executem suplementos não seguros, que são suplementos que contêm uma página da Web ou locais de catálogo não protegidos por SSL (https://) e não estão nas zonas de Internet dos usuários.</span><span class="sxs-lookup"><span data-stu-id="56d1b-279">Allows users to run non-secure add-ins, which are add-ins that have webpage or catalog locations that are not SSL-secured (https://) and are not in users' Internet zones.</span></span> |
| <span data-ttu-id="56d1b-280">Bloquear Suplementos da Web</span><span class="sxs-lookup"><span data-stu-id="56d1b-280">Block Web Add-ins</span></span> | <span data-ttu-id="56d1b-281">Permite com que você impeça usuários de utilizar suplementos da Web.</span><span class="sxs-lookup"><span data-stu-id="56d1b-281">Allows you to prevent users from using web add-ins.</span></span> |
| <span data-ttu-id="56d1b-282">Bloquear a Office Store</span><span class="sxs-lookup"><span data-stu-id="56d1b-282">Block the Office Store</span></span> |  <span data-ttu-id="56d1b-283">Permite com que você impeça usuários de utilizar ou inserir suplementos da Web que vierem da Office Store. </span><span class="sxs-lookup"><span data-stu-id="56d1b-283">Allows you to prevent users from using or inserting web add-ins that come from the Office Store.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="56d1b-284">Se os seus grupos de trabalho estiverem usando diversas edições do Office, os parâmetros da política de grupo devem ser configurados para cada edição.</span><span class="sxs-lookup"><span data-stu-id="56d1b-284">If your working groups are using multiple releases of Office, group policy settings must be configured for each release.</span></span> <span data-ttu-id="56d1b-285">Consulte o [Usando Política de Grupo para gerenciar como os usuários podem instalar e usar aplicativos do Office](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office) do artigo [Visão geral dos aplicativos do Office 2013](/previous-versions/office/office-2013-resource-kit/jj219429(v%3doffice.15)) para detalhes sobre as configuração da política de grupo do Office 2013.</span><span class="sxs-lookup"><span data-stu-id="56d1b-285">Please refer to the [Using Group Policy to manage how users can install and use apps for Office](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office) of the [Overview of apps for Office 2013](/previous-versions/office/office-2013-resource-kit/jj219429(v%3doffice.15)) article for details on group policy settings for Office 2013.</span></span>

## <a name="see-also"></a><span data-ttu-id="56d1b-286">Confira também</span><span class="sxs-lookup"><span data-stu-id="56d1b-286">See also</span></span>

- [<span data-ttu-id="56d1b-287">Solicitar permissões para uso da API em suplementos </span><span class="sxs-lookup"><span data-stu-id="56d1b-287">Requesting permissions for API use in add-ins</span></span>](../develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md)
- [<span data-ttu-id="56d1b-288">Privacidade, permissões e segurança de suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="56d1b-288">Privacy, permissions, and security for Outlook add-ins</span></span>](../outlook/privacy-and-security.md)
- [<span data-ttu-id="56d1b-289">Noções básicas sobre permissões de suplemento do Outlook</span><span class="sxs-lookup"><span data-stu-id="56d1b-289">Understanding Outlook add-in permissions</span></span>](../outlook/understanding-outlook-add-in-permissions.md)
- [<span data-ttu-id="56d1b-290">Limites de ativação e da API do JavaScript API para suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="56d1b-290">Limits for activation and JavaScript API for Outlook add-ins</span></span>](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
- [<span data-ttu-id="56d1b-291">Como lidar com limitações de política de mesma origem nos suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="56d1b-291">Addressing same-origin policy limitations in Office Add-ins</span></span>](../develop/addressing-same-origin-policy-limitations.md)
- [<span data-ttu-id="56d1b-292">Política de Mesma Origem</span><span class="sxs-lookup"><span data-stu-id="56d1b-292">Same Origin Policy</span></span>](https://www.w3.org/Security/wiki/Same_Origin_Policy)
- [<span data-ttu-id="56d1b-293">Política de Mesma Origem Parte 1: Sem Inspecionar</span><span class="sxs-lookup"><span data-stu-id="56d1b-293">Same Origin Policy Part 1: No Peeking</span></span>](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking)
- [<span data-ttu-id="56d1b-294">Política de mesma origem para JavaScript</span><span class="sxs-lookup"><span data-stu-id="56d1b-294">Same origin policy for JavaScript</span></span>](https://developer.mozilla.org/docs/Web/Security/Same-origin_policy)
- [<span data-ttu-id="56d1b-295">Modo Protegido do IE</span><span class="sxs-lookup"><span data-stu-id="56d1b-295">IE Protect Mode</span></span>](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer)
- [<span data-ttu-id="56d1b-296">Controles de privacidade para os aplicativos do Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="56d1b-296">Privacy controls for Microsoft 365 Apps</span></span>](/deployoffice/privacy/overview-privacy-controls)
