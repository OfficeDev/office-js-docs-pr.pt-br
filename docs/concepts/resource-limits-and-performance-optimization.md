---
title: Limites de recurso e otimização de desempenho para Suplementos do Office
description: Saiba mais sobre os limites de recursos da plataforma de Office de complemento, incluindo CPU e memória.
ms.date: 07/29/2020
localization_priority: Normal
ms.openlocfilehash: d19e171bb9dc84335631ed66d153541141ce3377
ms.sourcegitcommit: 883f71d395b19ccfc6874a0d5942a7016eb49e2c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/09/2021
ms.locfileid: "53349116"
---
# <a name="resource-limits-and-performance-optimization-for-office-add-ins"></a><span data-ttu-id="af357-103">Limites de recurso e otimização de desempenho para Suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="af357-103">Resource limits and performance optimization for Office Add-ins</span></span>

<span data-ttu-id="af357-p101">Para criar a melhor experiência para os usuários, verifique se o desempenho do Suplemento do Office está dentro dos limites específicos para uso de memória e núcleo de CPU, confiabilidade e, para suplementos do Outlook, tempo de resposta para avaliar expressões regulares. Esses limites de uso de recursos de tempo de execução aplicam-se aos suplementos em execução em clientes do Office para Windows e OS X, mas não a aplicativos móveis ou a um navegador.</span><span class="sxs-lookup"><span data-stu-id="af357-p101">To create the best experience for your users, ensure that your Office Add-in performs within specific limits for CPU core and memory usage, reliability, and, for Outlook add-ins, the response time for evaluating regular expressions. These run-time resource usage limits apply to add-ins running in Office clients on Windows and OS X, but not on mobile apps or in a browser.</span></span>

<span data-ttu-id="af357-106">Também é possível otimizar o desempenho dos suplementos em dispositivos móveis e para área de trabalho aprimorando o uso de recursos no design e na implementação de suplementos.</span><span class="sxs-lookup"><span data-stu-id="af357-106">You can also optimize the performance of your add-ins on desktop and mobile devices by optimizing the use of resources in your add-in design and implementation.</span></span>

## <a name="resource-usage-limits-for-add-ins"></a><span data-ttu-id="af357-107">Limites de uso de recursos para suplementos</span><span class="sxs-lookup"><span data-stu-id="af357-107">Resource usage limits for add-ins</span></span>

<span data-ttu-id="af357-108">Os limites de uso de recursos em tempo de executar se aplicam a todos os tipos de Office Desem. Esses limites ajudam a garantir o desempenho dos usuários e reduzir os ataques de negação de serviço.</span><span class="sxs-lookup"><span data-stu-id="af357-108">Run-time resource usage limits apply to all types of Office Add-ins. These limits help ensure performance for your users and mitigate denial-of-service attacks.</span></span> <span data-ttu-id="af357-109">Certifique-se de testar seu Office add-in em seu aplicativo de Office de destino usando um intervalo de dados possíveis e mede seu desempenho em relação aos seguintes limites de uso em tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="af357-109">Be sure to test your Office Add-in on your target Office application by using a range of possible data, and measure its performance against the following run-time usage limits.</span></span>

- <span data-ttu-id="af357-110">**Uso de núcleo de CPU**: um limite de uso de núcleo de CPU único de 90%, observado três vezes em intervalos padrão de cinco segundos.</span><span class="sxs-lookup"><span data-stu-id="af357-110">**CPU core usage** - A single CPU core usage threshold of 90%, observed three times in default 5-second intervals.</span></span>

   <span data-ttu-id="af357-111">O intervalo padrão para um cliente Office verificar o uso principal da CPU é a cada 5 segundos.</span><span class="sxs-lookup"><span data-stu-id="af357-111">The default interval for an Office client to check CPU core usage is every 5 seconds.</span></span> <span data-ttu-id="af357-112">Se o cliente Office detectar o uso principal da CPU de um complemento acima do valor limite, ele exibirá uma mensagem perguntando se o usuário deseja continuar executando o complemento.</span><span class="sxs-lookup"><span data-stu-id="af357-112">If the Office client detects the CPU core usage of an add-in is above the threshold value, it displays a message asking if the user wants to continue running the add-in.</span></span> <span data-ttu-id="af357-113">Se o usuário optar por continuar, o cliente Office não perguntará ao usuário novamente durante a sessão de edição.</span><span class="sxs-lookup"><span data-stu-id="af357-113">If the user chooses to continue, the Office client does not ask the user again during that edit session.</span></span> <span data-ttu-id="af357-114">Os administradores podem querer usar a chave de registro **AlertInterval** para elevar o limite caso os usuários executem suplementos que consomem muita CPU, a fim de reduzir a exibição desta mensagem de aviso.</span><span class="sxs-lookup"><span data-stu-id="af357-114">Administrators might want to use the **AlertInterval** registry key to raise the threshold to reduce the display of this warning message if users run CPU-intensive add-ins.</span></span>

- <span data-ttu-id="af357-115">**Uso de memória**: um limite de uso de memória padrão que é determinado dinamicamente com base na memória física disponível do dispositivo.</span><span class="sxs-lookup"><span data-stu-id="af357-115">**Memory usage** - A default memory usage threshold that is dynamically determined based on the available physical memory of the device.</span></span>

   <span data-ttu-id="af357-116">Por padrão, quando um cliente Office detecta que o uso de memória física em um dispositivo excede 80% da memória disponível, o cliente começa a monitorar o uso de memória do complemento, em um nível de documento para conteúdo e complementos do painel de tarefas e em um nível de caixa de correio para Outlook de complementos. Em um intervalo padrão de 5 segundos, o cliente avisa o usuário se o uso de memória física para um conjunto de complementos no nível de documento ou caixa de correio exceder 50%.</span><span class="sxs-lookup"><span data-stu-id="af357-116">By default, when a Office client detects that physical memory usage on a device exceeds 80% of the available memory, the client starts monitoring the add-in's memory usage, at a document level for content and task pane add-ins, and at a mailbox level for Outlook add-ins. At a default interval of 5 seconds, the client warns the user if physical memory usage for a set of add-ins at the document or mailbox level exceeds 50%.</span></span> <span data-ttu-id="af357-117">Esse limite de uso de memória usa memória física e não virtual para garantir o desempenho em dispositivos com RAM limitada, como tablets.</span><span class="sxs-lookup"><span data-stu-id="af357-117">This memory usage limit uses physical rather than virtual memory to ensure performance on devices with limited RAM, such as tablets.</span></span> <span data-ttu-id="af357-118">Os administradores podem substituir essa configuração dinâmica por um limite explícito usando a chave de registro **MemoryAlertThreshold** Windows como uma configuração global, ir ajustar o intervalo de alerta usando a chave **AlertInterval** como uma configuração global.</span><span class="sxs-lookup"><span data-stu-id="af357-118">Administrators can override this dynamic setting with an explicit limit by using the **MemoryAlertThreshold** Windows registry key as a global setting, ir adjust the alert interval by using the **AlertInterval** key as a global setting.</span></span>

- <span data-ttu-id="af357-119">**Tolerância a falhas**: um limite padrão de quatro falhas para um suplemento.</span><span class="sxs-lookup"><span data-stu-id="af357-119">**Crash tolerance** - A default limit of four crashes for an add-in.</span></span>

   <span data-ttu-id="af357-120">Os administradores podem ajustar o limite para casos de falha usando a chave de registro **RestartManagerRetryLimit**.</span><span class="sxs-lookup"><span data-stu-id="af357-120">Administrators can adjust the threshold for crashes by using the **RestartManagerRetryLimit** registry key.</span></span>

- <span data-ttu-id="af357-121">**Bloqueio de aplicativo**: um limite prolongado de falta de resposta de cinco segundos para um suplemento.</span><span class="sxs-lookup"><span data-stu-id="af357-121">**Application blocking** - Prolonged unresponsiveness threshold of 5 seconds for an add-in.</span></span>

   <span data-ttu-id="af357-122">Isso afeta as experiências do usuário do aplicativo de Office.</span><span class="sxs-lookup"><span data-stu-id="af357-122">This affects the user's experiences of the add-in and the Office application.</span></span> <span data-ttu-id="af357-123">Quando isso ocorre, o aplicativo Office reinicia automaticamente todos os complementos ativos para um documento ou caixa de correio (quando aplicável) e avisa o usuário sobre qual add-in se tornou não responsivo.</span><span class="sxs-lookup"><span data-stu-id="af357-123">When this occurs, the Office application automatically restarts all the active add-ins for a document or mailbox (where applicable), and warns the user as to which add-in became unresponsive.</span></span> <span data-ttu-id="af357-124">Suplementos podem atingir esse limite quando não têm rendimento do processamento regularmente ao realizar tarefas de execução demorada.</span><span class="sxs-lookup"><span data-stu-id="af357-124">Add-ins can reach this threshold when they do not regularly yield processing while performing long-running tasks.</span></span> <span data-ttu-id="af357-125">Há técnicas para garantir que não ocorra bloqueio.</span><span class="sxs-lookup"><span data-stu-id="af357-125">There are techniques to ensure that blocking does not occur.</span></span> <span data-ttu-id="af357-126">Os administradores não podem substituir esse limite.</span><span class="sxs-lookup"><span data-stu-id="af357-126">Administrators cannot override this threshold.</span></span>

### <a name="outlook-add-ins"></a><span data-ttu-id="af357-127">Suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="af357-127">Outlook add-ins</span></span>

<span data-ttu-id="af357-p106">Se qualquer suplemento do Outlook exceder os limites anteriores para núcleo da CPU, uso de memória ou limite de tolerância a falhas, o Outlook desativa o suplemento. O Centro de Administração do Exchange exibe o status de desativação do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="af357-p106">If any Outlook add-in exceeds the preceding thresholds for CPU core or memory usage, or tolerance limit for crashes, Outlook disables the add-in. The Exchange Admin Center displays the disabled status of the app.</span></span>

> [!NOTE]
> <span data-ttu-id="af357-130">Mesmo que apenas clientes avançados do Outlook, e não o Outlook Online ou dispositivos móveis, monitorarem o uso de recursos, se um cliente avançado desativar um suplemento do Outlook, o suplemento também é desativado para uso no Outlook Online e dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="af357-130">Even though only the Outlook rich clients and not Outlook on the web or mobile devices monitor resource usage, if a rich client disables an Outlook add-in, that add-in is also disabled for use in Outlook on the web and mobile devices.</span></span>

<span data-ttu-id="af357-131">Além das regras de núcleo da CPU, memória e confiabilidade, os Outlook deverão observar as seguintes regras na ativação.</span><span class="sxs-lookup"><span data-stu-id="af357-131">In addition to the CPU core, memory, and reliability rules, Outlook add-ins should observe the following rules on activation.</span></span>

- <span data-ttu-id="af357-p107">**Tempo de resposta de expressões regulares**: um limite padrão de 1.000 milissegundos para que o Outlook avalie todas as expressões regulares no manifesto de um suplemento do Outlook. Exceder o limite faz com que o Outlook repita a avaliação posteriormente.</span><span class="sxs-lookup"><span data-stu-id="af357-p107">**Regular expressions response time** - A default threshold of 1,000 milliseconds for Outlook to evaluate all regular expressions in the manifest of an Outlook add-in. Exceeding the threshold causes Outlook to retry evaluation at a later time.</span></span>

    <span data-ttu-id="af357-134">Usando uma política de grupo ou configuração específica de aplicativo no registro Windows, os administradores podem ajustar esse valor limite padrão de 1.000 milissegundos na configuração **OutlookActivationAlertThreshold.**</span><span class="sxs-lookup"><span data-stu-id="af357-134">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this default threshold value of 1,000 milliseconds in the **OutlookActivationAlertThreshold** setting.</span></span>

- <span data-ttu-id="af357-135">**Reavaliação de expressões regulares**: um limite padrão de três vezes para que o Outlook reavalie todas as expressões regulares em um manifesto.</span><span class="sxs-lookup"><span data-stu-id="af357-135">**Regular expressions re-evaluation** - A default limit of three times for Outlook to reevaluate all the regular expressions in a manifest.</span></span> <span data-ttu-id="af357-136">Se a avaliação falhar todas as três vezes excedendo o limite aplicável (que é o padrão de 1.000 milissegundos ou um valor especificado pelo **OutlookActivationAlertThreshold**, se essa configuração existir no registro Windows), o Outlook desabilitará o Outlook add-in.</span><span class="sxs-lookup"><span data-stu-id="af357-136">If evaluation fails all three times by exceeding the applicable threshold (which is either the default of 1,000 milliseconds or a value specified by **OutlookActivationAlertThreshold**, if that setting exists in the Windows registry), Outlook disables the Outlook add-in.</span></span> <span data-ttu-id="af357-137">O Exchange Admin Center exibe o status desabilitado, e o complemento está desabilitado para uso nos clientes Outlook clientes Outlook na Web e dispositivos móveis.</span><span class="sxs-lookup"><span data-stu-id="af357-137">The Exchange Admin Center displays the disabled status, and the add-in is disabled for use in the Outlook rich clients, and Outlook on the web and mobile devices.</span></span>

    <span data-ttu-id="af357-138">Usando uma política de grupo ou configuração específica do aplicativo no registro Windows, os administradores podem ajustar esse número de vezes para repetir a avaliação na **configuração OutlookActivationManagerRetryLimit.**</span><span class="sxs-lookup"><span data-stu-id="af357-138">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this number of times to retry evaluation in the **OutlookActivationManagerRetryLimit** setting.</span></span>

### <a name="excel-add-ins"></a><span data-ttu-id="af357-139">Suplementos do Excel</span><span class="sxs-lookup"><span data-stu-id="af357-139">Excel add-ins</span></span>

<span data-ttu-id="af357-140">Se você estiver criando um Excel, esteja ciente das seguintes limitações de tamanho ao interagir com a workbook.</span><span class="sxs-lookup"><span data-stu-id="af357-140">If you're building an Excel add-in, be aware of the following size limitations when interacting with the workbook.</span></span>

- <span data-ttu-id="af357-141">O Excel na Web tem um limite de tamanho de conteúdo para solicitações e respostas de 5 MB.</span><span class="sxs-lookup"><span data-stu-id="af357-141">Excel on the web has a payload size limit for requests and responses of 5MB.</span></span> <span data-ttu-id="af357-142">`RichAPI.Error` será lançado se esse limite for excedido.</span><span class="sxs-lookup"><span data-stu-id="af357-142">`RichAPI.Error` will be thrown if that limit is exceeded.</span></span>
- <span data-ttu-id="af357-143">Um intervalo é limitado a cinco milhões de células para obter operações.</span><span class="sxs-lookup"><span data-stu-id="af357-143">A range is limited to five million cells for get operations.</span></span>

<span data-ttu-id="af357-144">Se você espera que a entrada do usuário exceda esses limites, verifique os dados antes de chamar `context.sync()` .</span><span class="sxs-lookup"><span data-stu-id="af357-144">If you expect user input to exceed these limits, be sure to check the data before calling `context.sync()`.</span></span> <span data-ttu-id="af357-145">Divida a operação em partes menores conforme necessário.</span><span class="sxs-lookup"><span data-stu-id="af357-145">Split the operation into smaller pieces as needed.</span></span> <span data-ttu-id="af357-146">Certifique-se de chamar cada sub-operação para evitar que essas operações `context.sync()` sejam reunidas em lote novamente.</span><span class="sxs-lookup"><span data-stu-id="af357-146">Be sure to call `context.sync()` for each sub-operation to avoid those operations getting batched together again.</span></span>

<span data-ttu-id="af357-147">Essas limitações geralmente são excedida por intervalos grandes.</span><span class="sxs-lookup"><span data-stu-id="af357-147">These limitations are typically exceeded by large ranges.</span></span> <span data-ttu-id="af357-148">Seu complemento pode ser capaz de usar [RangeAreas](/javascript/api/excel/excel.rangeareas) para atualizar estrategicamente células dentro de um intervalo maior.</span><span class="sxs-lookup"><span data-stu-id="af357-148">Your add-in might be able to use [RangeAreas](/javascript/api/excel/excel.rangeareas) to strategically update cells within a larger range.</span></span> <span data-ttu-id="af357-149">Consulte [Trabalhar com vários intervalos simultaneamente em Excel de complementos](../excel/excel-add-ins-multiple-ranges.md) para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="af357-149">See [Work with multiple ranges simultaneously in Excel add-ins](../excel/excel-add-ins-multiple-ranges.md) for more information.</span></span>

### <a name="task-pane-and-content-add-ins"></a><span data-ttu-id="af357-150">Suplementos do painel de tarefas e de conteúdo</span><span class="sxs-lookup"><span data-stu-id="af357-150">Task pane and content add-ins</span></span>

<span data-ttu-id="af357-151">Se qualquer conteúdo ou um complemento do painel de tarefas exceder os limites anteriores no uso do núcleo da CPU ou da memória ou no limite de tolerância para falhas, o aplicativo Office correspondente exibirá um aviso para o usuário.</span><span class="sxs-lookup"><span data-stu-id="af357-151">If any content or task pane add-in exceeds the preceding thresholds on CPU core or memory usage, or tolerance limit for crashes, the corresponding Office application displays a warning for the user.</span></span> <span data-ttu-id="af357-152">Nesse momento, o usuário poderá executar uma destas ações:</span><span class="sxs-lookup"><span data-stu-id="af357-152">At this point, the user can do one of the following:</span></span>

- <span data-ttu-id="af357-153">Reiniciar o suplemento.</span><span class="sxs-lookup"><span data-stu-id="af357-153">Restart the add-in.</span></span>
- <span data-ttu-id="af357-p113">Cancelar outros alertas sobre a ultrapassagem desse limite. O ideal é que o usuário exclua o suplemento do documento. Continuar a usar o suplemento poderia causar ainda mais problemas de desempenho e estabilidade.</span><span class="sxs-lookup"><span data-stu-id="af357-p113">Cancel further alerts about exceeding that threshold. Ideally, the user should then delete the add-in from the document; continuing the add-in would risk further performance and stability issues.</span></span>  

## <a name="verifying-resource-usage-issues-in-the-telemetry-log"></a><span data-ttu-id="af357-156">Verificar problemas de uso de recursos no Log de Telemetria</span><span class="sxs-lookup"><span data-stu-id="af357-156">Verifying resource usage issues in the Telemetry Log</span></span>

<span data-ttu-id="af357-p114">O Office fornece um Log de Telemetria que mantém um registro de determinados eventos (carregar, abrir, fechar e erros) de soluções do Office em execução no computador local, incluindo problemas de uso de recursos em um Suplemento do Office. Se tiver o Log de Telemetria configurado, é possível usar o Excel para abri-lo no seguinte local padrão na unidade local:</span><span class="sxs-lookup"><span data-stu-id="af357-p114">Office provides a Telemetry Log that maintains a record of certain events (loading, opening, closing, and errors) of Office solutions running on the local computer, including resource usage issues in an Office Add-in. If you have the Telemetry Log set up, you can use Excel to open the Telemetry Log in the following default location on your local drive:</span></span>

`%Users%\<Current user>\AppData\Local\Microsoft\Office\15.0\Telemetry`

<span data-ttu-id="af357-p115">Para cada evento que o Log de Telemetria acompanha para um suplemento, há a data/hora de ocorrência, a ID do evento, a severidade e o título descritivo curto do evento, o nome amigável e a ID exclusiva do suplemento, e o aplicativo que registrou em log o evento. Você pode atualizar o Log de Telemetria para ver os eventos atualmente acompanhados. A tabela a seguir mostra exemplos de suplementos do Outlook que foram acompanhados no log de Telemetria.</span><span class="sxs-lookup"><span data-stu-id="af357-p115">For each event that the Telemetry Log tracks for an add-in, there is a date/time of the occurrence, event ID, severity, and short descriptive title for the event, the friendly name and unique ID of the add-in, and the application that logged the event. You can refresh the Telemetry Log to see the current tracked events. The following table shows examples of Outlook add-ins that were tracked in the Telemetry log.</span></span>

|<span data-ttu-id="af357-162">**Data/Hora**</span><span class="sxs-lookup"><span data-stu-id="af357-162">**Date/Time**</span></span>|<span data-ttu-id="af357-163">**ID do Evento**</span><span class="sxs-lookup"><span data-stu-id="af357-163">**Event ID**</span></span>|<span data-ttu-id="af357-164">**Severidade**</span><span class="sxs-lookup"><span data-stu-id="af357-164">**Severity**</span></span>|<span data-ttu-id="af357-165">**Título**</span><span class="sxs-lookup"><span data-stu-id="af357-165">**Title**</span></span>|<span data-ttu-id="af357-166">**Arquivo**</span><span class="sxs-lookup"><span data-stu-id="af357-166">**File**</span></span>|<span data-ttu-id="af357-167">**ID**</span><span class="sxs-lookup"><span data-stu-id="af357-167">**ID**</span></span>|<span data-ttu-id="af357-168">**Aplicativo**</span><span class="sxs-lookup"><span data-stu-id="af357-168">**Application**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="af357-169">08/10/2012 17:57:10</span><span class="sxs-lookup"><span data-stu-id="af357-169">10/8/2012 5:57:10 PM</span></span>|<span data-ttu-id="af357-170">7 </span><span class="sxs-lookup"><span data-stu-id="af357-170">7</span></span>||<span data-ttu-id="af357-171">manifesto de suplemento baixado com êxito</span><span class="sxs-lookup"><span data-stu-id="af357-171">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="af357-172">Quem é quem</span><span class="sxs-lookup"><span data-stu-id="af357-172">Who's Who</span></span>|<span data-ttu-id="af357-173">69cc567c-6737-4c49-88dd-123334943a22</span><span class="sxs-lookup"><span data-stu-id="af357-173">69cc567c-6737-4c49-88dd-123334943a22</span></span>|<span data-ttu-id="af357-174">Outlook</span><span class="sxs-lookup"><span data-stu-id="af357-174">Outlook</span></span>|
|<span data-ttu-id="af357-175">8/10/2012 17:57:01</span><span class="sxs-lookup"><span data-stu-id="af357-175">10/8/2012 5:57:01 PM</span></span>|<span data-ttu-id="af357-176">7 </span><span class="sxs-lookup"><span data-stu-id="af357-176">7</span></span>||<span data-ttu-id="af357-177">manifesto de suplemento baixado com êxito</span><span class="sxs-lookup"><span data-stu-id="af357-177">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="af357-178">LinkedIn</span><span class="sxs-lookup"><span data-stu-id="af357-178">LinkedIn</span></span>|<span data-ttu-id="af357-179">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span><span class="sxs-lookup"><span data-stu-id="af357-179">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span></span>|<span data-ttu-id="af357-180">Outlook</span><span class="sxs-lookup"><span data-stu-id="af357-180">Outlook</span></span>|

<span data-ttu-id="af357-181">A tabela a seguir lista os eventos que o Log de Telemetria acompanha para os Suplementos do Office em geral.</span><span class="sxs-lookup"><span data-stu-id="af357-181">The following table lists the events that the Telemetry Log tracks for Office Add-ins in general.</span></span>

|<span data-ttu-id="af357-182">**ID do Evento**</span><span class="sxs-lookup"><span data-stu-id="af357-182">**Event ID**</span></span>|<span data-ttu-id="af357-183">**Título**</span><span class="sxs-lookup"><span data-stu-id="af357-183">**Title**</span></span>|<span data-ttu-id="af357-184">**Severidade**</span><span class="sxs-lookup"><span data-stu-id="af357-184">**Severity**</span></span>|<span data-ttu-id="af357-185">**Descrição**</span><span class="sxs-lookup"><span data-stu-id="af357-185">**Description**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="af357-186">7 </span><span class="sxs-lookup"><span data-stu-id="af357-186">7</span></span>|<span data-ttu-id="af357-187">Manifesto de suplemento baixado com êxito</span><span class="sxs-lookup"><span data-stu-id="af357-187">Add-in manifest downloaded successfully</span></span>||<span data-ttu-id="af357-188">O manifesto do Office de Office foi carregado e lido com êxito pelo aplicativo Office.</span><span class="sxs-lookup"><span data-stu-id="af357-188">The manifest of the Office Add-in was successfully loaded and read by the Office application.</span></span>|
|<span data-ttu-id="af357-189">8 </span><span class="sxs-lookup"><span data-stu-id="af357-189">8</span></span>|<span data-ttu-id="af357-190">Manifesto de suplemento não baixado</span><span class="sxs-lookup"><span data-stu-id="af357-190">Add-in manifest did not download</span></span>|<span data-ttu-id="af357-191">Crítico</span><span class="sxs-lookup"><span data-stu-id="af357-191">Critical</span></span>|<span data-ttu-id="af357-192">O Office aplicativo não pôde carregar o arquivo de manifesto do Office do SharePoint, catálogo corporativo ou AppSource.</span><span class="sxs-lookup"><span data-stu-id="af357-192">The Office application was unable to load the manifest file for the Office Add-in from the SharePoint catalog, corporate catalog, or AppSource.</span></span>|
|<span data-ttu-id="af357-193">9 </span><span class="sxs-lookup"><span data-stu-id="af357-193">9</span></span>|<span data-ttu-id="af357-194">Não foi possível analisar a marcação do suplemento</span><span class="sxs-lookup"><span data-stu-id="af357-194">Add-in markup could not be parsed</span></span>|<span data-ttu-id="af357-195">Crítico</span><span class="sxs-lookup"><span data-stu-id="af357-195">Critical</span></span>|<span data-ttu-id="af357-196">O Office o aplicativo carregou o manifesto de Office de complemento, mas não conseguiu ler a marcação HTML do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="af357-196">The Office application loaded the Office Add-in manifest, but could not read the HTML markup of the app.</span></span>|
|<span data-ttu-id="af357-197">10 </span><span class="sxs-lookup"><span data-stu-id="af357-197">10</span></span>|<span data-ttu-id="af357-198">O suplemento usou CPU em excesso</span><span class="sxs-lookup"><span data-stu-id="af357-198">Add-in used too much CPU</span></span>|<span data-ttu-id="af357-199">Crítico</span><span class="sxs-lookup"><span data-stu-id="af357-199">Critical</span></span>|<span data-ttu-id="af357-200">O suplemento do Office usou mais de 90% dos recursos da CPU em um período de tempo finito.</span><span class="sxs-lookup"><span data-stu-id="af357-200">The Office Add-in used more than 90% of the CPU resources over a finite period of time.</span></span>|
|<span data-ttu-id="af357-201">15</span><span class="sxs-lookup"><span data-stu-id="af357-201">15</span></span>|<span data-ttu-id="af357-202">Suplemento desabilitado porque esgotou o tempo limite na pesquisa de cadeia de caracteres</span><span class="sxs-lookup"><span data-stu-id="af357-202">Add-in disabled due to string search time-out</span></span>||<span data-ttu-id="af357-203">Os suplementos do Outlook pesquisam a linha de assunto e a mensagem de um e-mail para determinar se devem ser exibidas usando uma expressão regular.</span><span class="sxs-lookup"><span data-stu-id="af357-203">Outlook add-ins search the subject line and message of an e-mail to determine whether they should be displayed by using a regular expression.</span></span> <span data-ttu-id="af357-204">O Outlook de dados listado na  coluna Arquivo foi desabilitado por Outlook porque ele temporizou repetidamente ao tentar corresponder a uma expressão regular.</span><span class="sxs-lookup"><span data-stu-id="af357-204">The Outlook add-in listed in the **File** column was disabled by Outlook because it timed out repeatedly while trying to match a regular expression.</span></span>|
|<span data-ttu-id="af357-205">18 </span><span class="sxs-lookup"><span data-stu-id="af357-205">18</span></span>|<span data-ttu-id="af357-206">Suplemento fechado com êxito</span><span class="sxs-lookup"><span data-stu-id="af357-206">Add-in closed successfully</span></span>||<span data-ttu-id="af357-207">O Office aplicativo foi capaz de fechar o Office Add-in com êxito.</span><span class="sxs-lookup"><span data-stu-id="af357-207">The Office application was able to close the Office Add-in successfully.</span></span>|
|<span data-ttu-id="af357-208">19</span><span class="sxs-lookup"><span data-stu-id="af357-208">19</span></span>|<span data-ttu-id="af357-209">O suplemento encontrou um erro de tempo de execução</span><span class="sxs-lookup"><span data-stu-id="af357-209">Add-in encountered runtime error</span></span>|<span data-ttu-id="af357-210">Crítico</span><span class="sxs-lookup"><span data-stu-id="af357-210">Critical</span></span>|<span data-ttu-id="af357-211">O suplemento do Office teve um problema que causou sua falha.</span><span class="sxs-lookup"><span data-stu-id="af357-211">The Office Add-in had a problem that caused it to fail.</span></span> <span data-ttu-id="af357-212">Para obter mais detalhes, consulte o log **Microsoft Office Alertas** usando o visualizador de eventos Windows no computador que encontrou o erro.</span><span class="sxs-lookup"><span data-stu-id="af357-212">For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|
|<span data-ttu-id="af357-213">20</span><span class="sxs-lookup"><span data-stu-id="af357-213">20</span></span>|<span data-ttu-id="af357-214">Falha ao verificar a licença do suplemento</span><span class="sxs-lookup"><span data-stu-id="af357-214">Add-in failed to verify licensing</span></span>|<span data-ttu-id="af357-215">Crítico</span><span class="sxs-lookup"><span data-stu-id="af357-215">Critical</span></span>|<span data-ttu-id="af357-216">As informações de licenciamento do suplemento do Office não puderam ser verificadas e podem ter expirado.</span><span class="sxs-lookup"><span data-stu-id="af357-216">The licensing information for the Office Add-in could not be verified and may have expired.</span></span> <span data-ttu-id="af357-217">Para obter mais detalhes, consulte o log **Microsoft Office Alertas** usando o visualizador de eventos Windows no computador que encontrou o erro.</span><span class="sxs-lookup"><span data-stu-id="af357-217">For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|

<span data-ttu-id="af357-218">Saiba mais em [Implantar o Painel de Telemetria](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15)) e [Solução de problemas de arquivos do Office e soluções personalizadas com o log de telemetria](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log).</span><span class="sxs-lookup"><span data-stu-id="af357-218">For more information, see [Deploying Telemetry Dashboard](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15)) and [Troubleshooting Office files and custom solutions with the telemetry log](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log).</span></span>

## <a name="design-and-implementation-techniques"></a><span data-ttu-id="af357-219">Técnicas de design e implementação</span><span class="sxs-lookup"><span data-stu-id="af357-219">Design and implementation techniques</span></span>

<span data-ttu-id="af357-220">Embora os limites de recursos para o uso de CPU e memória, a tolerância a falhas e a capacidade de resposta da interface do usuário se apliquem a suplementos do Office executados somente em clientes avançados, otimizar o uso desses recursos e da bateria deve ter prioridade se você quer que o suplemento tenha desempenho satisfatório em todos os dispositivos e clientes compatíveis.</span><span class="sxs-lookup"><span data-stu-id="af357-220">While the resources limits on CPU and memory usage, crash tolerance, UI responsiveness apply to Office Add-ins running only on the rich clients, optimizing the usage of these resources and battery should be a priority if you want your add-in to perform satisfactorily on all supporting clients and devices.</span></span> <span data-ttu-id="af357-221">A otimização é particularmente importante se o suplemento efetua operações de longa duração ou lida com grandes conjuntos de dados.</span><span class="sxs-lookup"><span data-stu-id="af357-221">Optimization is particularly important if your add-in carries out long-running operations or handles large data sets.</span></span> <span data-ttu-id="af357-222">A lista a seguir sugere algumas técnicas para separar operações intensas de CPU ou de uso intenso de dados em partes menores para que o seu complemento possa evitar o consumo excessivo de recursos e o aplicativo Office pode permanecer responsivo.</span><span class="sxs-lookup"><span data-stu-id="af357-222">The following list suggests some techniques to break up CPU-intensive or data-intensive operations into smaller chunks so that your add-in can avoid excessive resource consumption and the Office application can remain responsive.</span></span>

- <span data-ttu-id="af357-223">Em um cenário em que o suplemento precisa ler um grande volume de dados de um conjunto de dados não associado, você pode aplicar a paginação ao ler os dados de uma tabela ou reduzir o tamanho dos dados em cada operação de leitura mais curta, em vez de tentar concluir a leitura em uma única operação.</span><span class="sxs-lookup"><span data-stu-id="af357-223">In a scenario where your add-in needs to read a large volume of data from an unbounded dataset, you can apply paging when reading the data from a table, or reduce the size of data in each shorter read operation, rather than attempting to complete the read in one single operation.</span></span> <span data-ttu-id="af357-224">Você pode fazer isso por meio do [método setTimeout](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) do objeto global para limitar a duração da entrada e da saída.</span><span class="sxs-lookup"><span data-stu-id="af357-224">You can do this through the [setTimeout](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) method of the global object to limit the duration of input and output.</span></span> <span data-ttu-id="af357-225">Também lida com os dados em blocos definidos, em vez dos dados não associados aleatoriamente.</span><span class="sxs-lookup"><span data-stu-id="af357-225">It also handles the data in defined chunks instead of randomly unbounded data.</span></span> <span data-ttu-id="af357-226">Outra opção é usar [o assíncrono](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function) para lidar com suas Promessas.</span><span class="sxs-lookup"><span data-stu-id="af357-226">Another option is to use [async](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function) to handle your Promises.</span></span>

- <span data-ttu-id="af357-p121">Se o suplemento usa um algoritmo com uso intensivo de CPU para processar um grande volume de dados, você pode usar os web workers para executar a tarefa demorada em segundo plano enquanto executa um script separado em primeiro plano, como exibir o progreso na interface do usuário. Os Web workers não bloqueiam atividades do usuário e permitem que a página HTML continue respondendo. Para obter um exemplo de Web workers, consulte [Noções básicas de Web workers](https://www.html5rocks.com/tutorials/workers/basics/). Confira [Web workers](https://developer.mozilla.org/docs/Web/API/Web_Workers_API) para saber mais sobre a API Web workers.</span><span class="sxs-lookup"><span data-stu-id="af357-p121">If your add-in uses a CPU-intensive algorithm to process a large volume of data, you can use web workers to perform the long-running task in the background while running a separate script in the foreground, such as displaying progress in the user interface. Web workers do not block user activities and allow the HTML page to remain responsive. For an example of web workers, see [The Basics of Web Workers](https://www.html5rocks.com/tutorials/workers/basics/). See [Web Workers](https://developer.mozilla.org/docs/Web/API/Web_Workers_API) for more information about the Web Workers API.</span></span>

- <span data-ttu-id="af357-231">Se o suplemento usa um algoritmo com uso intensivo de CPU, mas é possível dividir a entrada ou a saída de dados em conjuntos menores, considere criar um serviço Web passando os dados para o serviço Web para aliviar a carga da CPU e aguarde um retorno de chamada assíncrono.</span><span class="sxs-lookup"><span data-stu-id="af357-231">If your add-in uses a CPU-intensive algorithm but you can divide the data input or output into smaller sets, consider creating a web service, passing the data to the web service to off-load the CPU, and wait for an asynchronous callback.</span></span>

- <span data-ttu-id="af357-232">Teste o suplemento em relação ao maior volume de dados esperado e restrinja o suplemento a processar até esse limite.</span><span class="sxs-lookup"><span data-stu-id="af357-232">Test your add-in against the highest volume of data you expect, and restrict your add-in to process up to that limit.</span></span>

### <a name="performance-improvements-with-the-application-specific-apis"></a><span data-ttu-id="af357-233">Melhorias de desempenho com as APIs específicas do aplicativo</span><span class="sxs-lookup"><span data-stu-id="af357-233">Performance improvements with the application-specific APIs</span></span>

<span data-ttu-id="af357-234">As dicas de desempenho em Usar o modelo de [API](../develop/application-specific-api-model.md) específico do aplicativo fornecem orientações ao usar as APIs específicas do aplicativo para Excel, OneNote, Visio e Word.</span><span class="sxs-lookup"><span data-stu-id="af357-234">The performance tips in [Using the application-specific API model](../develop/application-specific-api-model.md) provide guidance when using the application-specific APIs for Excel, OneNote, Visio, and Word.</span></span> <span data-ttu-id="af357-235">Em resumo, você deve:</span><span class="sxs-lookup"><span data-stu-id="af357-235">In summary, you should:</span></span>

- <span data-ttu-id="af357-236">[Carregar somente as propriedades necessárias](../develop/application-specific-api-model.md#calling-load-without-parameters-not-recommended).</span><span class="sxs-lookup"><span data-stu-id="af357-236">[Only load necessary properties](../develop/application-specific-api-model.md#calling-load-without-parameters-not-recommended).</span></span>
- <span data-ttu-id="af357-237">[Minimize o número de chamadas sync()](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-sync-calls).</span><span class="sxs-lookup"><span data-stu-id="af357-237">[Minimize the number of sync() calls](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-sync-calls).</span></span> <span data-ttu-id="af357-238">Leia [Evite usar o método context.sync em loops](correlated-objects-pattern.md) para obter mais informações sobre como gerenciar chamadas em seu `sync` código.</span><span class="sxs-lookup"><span data-stu-id="af357-238">Read [Avoid using the context.sync method in loops](correlated-objects-pattern.md) for further information on how to manage `sync` calls in your code.</span></span>
- <span data-ttu-id="af357-239">[Minimize o número de objetos proxy criados](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-proxy-objects-created).</span><span class="sxs-lookup"><span data-stu-id="af357-239">[Minimize the number of proxy objects created](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-proxy-objects-created).</span></span> <span data-ttu-id="af357-240">Você também pode desconscrevir objetos proxy, conforme descrito na próxima seção.</span><span class="sxs-lookup"><span data-stu-id="af357-240">You can also untrack proxy objects, as described in the next section.</span></span>

#### <a name="untrack-unneeded-proxy-objects"></a><span data-ttu-id="af357-241">Objetos proxy não desanenhados</span><span class="sxs-lookup"><span data-stu-id="af357-241">Untrack unneeded proxy objects</span></span>

<span data-ttu-id="af357-242">[Os objetos proxy](../develop/application-specific-api-model.md#proxy-objects) persistem na memória até `RequestContext.sync()` que seja chamado.</span><span class="sxs-lookup"><span data-stu-id="af357-242">[Proxy objects](../develop/application-specific-api-model.md#proxy-objects) persist in memory until `RequestContext.sync()` is called.</span></span> <span data-ttu-id="af357-243">Grandes operações em lote podem gerar muitos objetos de proxy que são necessários apenas uma vez pelo suplemento e podem ser liberados da memória antes da execução do lote.</span><span class="sxs-lookup"><span data-stu-id="af357-243">Large batch operations may generate a lot of proxy objects that are only needed once by the add-in and can be released from memory before the batch executes.</span></span>

<span data-ttu-id="af357-244">O `untrack()` método libera o objeto da memória.</span><span class="sxs-lookup"><span data-stu-id="af357-244">The `untrack()` method releases the object from memory.</span></span> <span data-ttu-id="af357-245">Esse método é implementado em muitos objetos proxy de API específicos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="af357-245">This method is implemented on many application-specific API proxy objects.</span></span> <span data-ttu-id="af357-246">Chamar depois que o seu complemento for feito com o objeto deve gerar um benefício de desempenho perceptível ao usar um grande número de objetos `untrack()` proxy.</span><span class="sxs-lookup"><span data-stu-id="af357-246">Calling `untrack()` after your add-in is done with the object should yield a noticeable performance benefit when using large numbers of proxy objects.</span></span>

> [!NOTE]
> <span data-ttu-id="af357-247">`Range.untrack()` é um atalho para [ClientRequestContext.trackedObjects.remove(thisRange)](/javascript/api/office/officeextension.trackedobjects#remove-object-).</span><span class="sxs-lookup"><span data-stu-id="af357-247">`Range.untrack()` is a shortcut for [ClientRequestContext.trackedObjects.remove(thisRange)](/javascript/api/office/officeextension.trackedobjects#remove-object-).</span></span> <span data-ttu-id="af357-248">Qualquer objeto de proxy pode ser não-rastreado, removendo-o da lista de objetos rastreados no contexto.</span><span class="sxs-lookup"><span data-stu-id="af357-248">Any proxy object can be untracked by removing it from the tracked objects list in the context.</span></span>

<span data-ttu-id="af357-249">O exemplo Excel código a seguir preenche um intervalo selecionado com dados, uma célula por vez.</span><span class="sxs-lookup"><span data-stu-id="af357-249">The following Excel code sample fills a selected range with data, one cell at a time.</span></span> <span data-ttu-id="af357-250">Depois que o valor é adicionado à célula, o intervalo que representa a célula é não-rastreado.</span><span class="sxs-lookup"><span data-stu-id="af357-250">After the value is added to the cell, the range representing that cell is untracked.</span></span> <span data-ttu-id="af357-251">Execute esse código em um intervalo selecionado de 20.000 de 10.000 células, primeiro, com a linha `cell.untrack()` e, em seguida, sem ela.</span><span class="sxs-lookup"><span data-stu-id="af357-251">Run this code with a selected range of 10,000 to 20,000 cells, first with the `cell.untrack()` line, and then without it.</span></span> <span data-ttu-id="af357-252">Você deve observar que o código é executado mais rapidamente com a linha `cell.untrack()` do que sem ela.</span><span class="sxs-lookup"><span data-stu-id="af357-252">You should notice the code runs faster with the `cell.untrack()` line than without it.</span></span> <span data-ttu-id="af357-253">Você também poderá observar um tempo de resposta mais rápido posteriormente, porque a etapa de limpeza leva menos tempo.</span><span class="sxs-lookup"><span data-stu-id="af357-253">You may also notice a quicker response time afterwards, since the cleanup step takes less time.</span></span>

```js
Excel.run(async (context) => {
    var largeRange = context.workbook.getSelectedRange();
    largeRange.load(["rowCount", "columnCount"]);
    await context.sync();

    for (var i = 0; i < largeRange.rowCount; i++) {
        for (var j = 0; j < largeRange.columnCount; j++) {
            var cell = largeRange.getCell(i, j);
            cell.values = [[i *j]];

            // Call untrack() to release the range from memory.
            cell.untrack();
        }
    }

    await context.sync();
});
```

<span data-ttu-id="af357-254">Observe que a necessidade de desemanar objetos só se torna importante quando você está lidando com milhares deles.</span><span class="sxs-lookup"><span data-stu-id="af357-254">Note that needing to untrack objects only becomes important when you're dealing with thousands of them.</span></span> <span data-ttu-id="af357-255">A maioria dos complementos não precisará gerenciar o controle de objeto proxy.</span><span class="sxs-lookup"><span data-stu-id="af357-255">Most add-ins will not need to manage proxy object tracking.</span></span>

## <a name="see-also"></a><span data-ttu-id="af357-256">Confira também</span><span class="sxs-lookup"><span data-stu-id="af357-256">See also</span></span>

- [<span data-ttu-id="af357-257">Privacidade e segurança para Suplementos do Office</span><span class="sxs-lookup"><span data-stu-id="af357-257">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
- [<span data-ttu-id="af357-258">Limites de ativação e da API do JavaScript para Suplementos do Outlook</span><span class="sxs-lookup"><span data-stu-id="af357-258">Limits for activation and JavaScript API for Outlook add-ins</span></span>](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
- [<span data-ttu-id="af357-259">Otimização de desempenho usando a API do JavaScript para Excel</span><span class="sxs-lookup"><span data-stu-id="af357-259">Performance optimization using the Excel JavaScript API</span></span>](../excel/performance.md)
